/*! For license information please see deferred.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred"],{117:function(e,t,n){"use strict";var a=n(438);t.e=a.e},161:function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},168:function(e,t,n){"use strict";var a=n(86);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},175:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemTaskObserver",function(){return u}),n.d(t,"resourceKey",function(){return f});var a=n(1),i=n(54),r=n(161);n.d(t,"Task",function(){return r.e});var o=n(168),s=n(177),c=n(131);n.d(t,"Graft",function(){return c});var d=n(481),l=n(334),u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemsStore,r=void 0===i?a.resources.consume(s.e):i;return a._itemsStore=r,a._itemUpdatesByKey={},a}return Object(a.__extends)(t,e),t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,a=e;n<a.length;n++){var i=a[n];this._processTask(i)}},t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,r=n;i<r.length;i++){var s=r[i],d=t[s],l=new o.e(s),u=this._getStoreItem(s);if(u){u.UNSAFE_parent;var f=Object(a.__rest)(u,["UNSAFE_parent"]);Object(c.default)(l,f)}Object(c.default)(l,{revision:0});for(var p=0,m=d.item;p<m.length;p++){var _=m[p];Object(c.default)(l,_)}e[s]=l}for(var h=0,b=n;h<b.length;h++){var g=(l=e[s=b[h]]).parentKey;if(g){var v=e[g]||this._getStoreItem(g)||new o.e(g);e[g]=v,l.UNSAFE_parent=v}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var y=0,S=n;y<S.length;y++)s=S[y],delete(d=t[s]).item},t.prototype.reset=function(){this._itemUpdatesByKey={}},t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)},t.prototype.getChildren=function(e){var t,n,a,i=e.parentKey,r=e.startIndex,o=e.endIndex,s=[],c=this._itemUpdatesByKey[i];if(c){var d=c.set;if(d)if(d.childrenByIndex){r=void 0===(n=(t={startIndex:r,endIndex:o}).startIndex)?d.startIndex:n,o=void 0===(a=t.endIndex)?d.endIndex:a;for(var l=r;l<o;l++){var u=d.childrenByIndex[l],f=this._getStoreItem(u);s.push(f)}}else if(d.childrenBySibling)for(var p={},m="";m=d.childrenBySibling[m];){if(p[m])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[m]=!0,f=this._getStoreItem(m),s.push(f)}}return s},t.prototype._processTask=function(e){var t=e.key,n=e.output,a=n.item,i=n.set,r=this._itemUpdatesByKey,o=r[t];if(o||(o=r[t]={}),a&&(o.item||(o.item=[]),o.item.push(a)),i){var s=r[i.parent.key];s||(s=r[i.parent.key]={}),s.set||(s.set={});var c=s.set;if(void 0!==i.index){c.childrenByIndex||(c.childrenByIndex=[]),void 0===c.startIndex?c.startIndex=i.index:c.startIndex=Math.min(c.startIndex,i.index);var d=c.childrenByIndex.length;c.childrenByIndex[i.index]=t,void 0===c.endIndex?c.endIndex=i.index+1:c.endIndex>i.index+1?c.endIndex+=c.childrenByIndex.length-d:c.endIndex=Math.max(c.endIndex,i.index+1)}else i.after&&(c.childrenBySibling||(c.childrenBySibling={}),c.childrenBySibling[i.after.key]=t)}},t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)},t.prototype._pushItemsToStore=function(e){var t={};for(var n in e)(r=t[i=e[(c=e[n]).parentKey]&&c.parentKey||""]||(t[i]=[])).push(n);for(var a=[""];a.length;){var i,r;if(r=t[i=a.shift()]){for(var o=0,s=r;o<s.length;o++){var c;if(!(c=e[n=s[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(c,n)}a.push.apply(a,r)}}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemsStore:s.e}),t}(i.n),f=new d.t({name:"ItemTaskObserver",factory:new l.a(u)});t.default=u},177:function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(1),i=n(168),r=n(118),o=n(188),s=n(481),c=n(334),d=n(153),l=n(231),u=n(117),f=n(458),p=n(131),m=n(4),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)})},206:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)};function i(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((a=a.apply(e,t||[])).next())})}function s(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function c(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}},221:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return T});var a=n(1),i=n(298),r=n(114),o=n(742),s=n(334),c=n(299),d=n(385),l=n(428),u=n(178),f=n(850),p=n(85),m=n(0),_=n(353),h=n(582),b=n(711),g=n(481),v=new Map,y=new g.t({name:"".concat("PrefetchPromiseCache.key",".prefetchPromiseCache"),factory:new g.e(v)}),S=n(815),D=n(1573),I=n(259),x=n(712),C=m.e.isActivated("BDA7F62C-13F2-46C1-9EB2-67F34FE3D170","3/8/2021","Alaways get a Graph token for Graph endpoints"),O=!m.e.isActivated("45797257-AE53-4A65-85FB-AE408818E116","05/30/2023","Use the custom substrate urls from pageContext when provided (only for Gallatin)"),w=!m.e.isActivated("A168446A-6645-43C0-B614-B7CECD1506AC","05/30/2023","Use the custom substrate urls from pageContext when provided"),E=!m.e.isActivated("FD10ACC0-8949-4FE0-806A-4E5DC82C25C7","02/13/2023","Leverage prefetched token if available"),A=!m.e.isActivated("177AB2AC-1092-497F-BA13-525124F3F9A3","08/07/2023","Enable prefetch fixes"),L=!m.e.isActivated("9BCD369C-9F54-4160-BB2C-6B2919A1C2E4","09/15/2023","use search token name and resource type"),k="https://substrate.office.com",M=["https://agreement-int.esign.microsoft.com","https://agreement.esign.microsoft.com","api://29f0582a-cecf-4007-9b04-6e7e036a9835",d.e],P=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._isAddContextInfoPathToPassedInUrlKSActive=m.e.isActivated("54EA5CED-8E27-4CD3-8D01-0FD2EBFB08E4","02/17/2023","add contextInfo path to passed in url"),a._pageContext=n.pageContext,a._dataRequestor=new l.t({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:a._pageContext}),a._cache=n.identityCache,a._promiseCache=new Map,a._prefetchPromiseCache=n.prefetchPromiseCache,a._apiUrlHelper=new u.t({webAbsoluteUrl:a._pageContext.webAbsoluteUrl}),a._tokenFetcher=n.tokenFetcher,a}return Object(a.__extends)(t,e),t.prototype.getIdentity=function(){return t=(e={pageContext:this._pageContext}).pageContext,n=function(e){var t=e.pageContext,n=null==t?void 0:t.systemUserKey;return n&&n.substring(n.lastIndexOf("|")+1).replace("@live.com","")||""}(e),a=!0===t.isAnonymousGuestUser||!0===t.isEmailAuthenticationGuestUser?D.e.anonymous:D.e.aad,i=t.userLoginName,r=t.webPermMasks,{email:t.userEmail,id:n,loginName:i,type:a,sessionState:"",webPermMasks:r};var e,t,n,a,i,r},t.prototype.getSignInUrl=function(){throw new Error("Not Implemented")},t.prototype.getGraphToken=function(e){var t=e.resource,n=e.scopes,a=e.claimsChallenge;return t&&!this._isGraphEndpoint(t)?this.getSharePointToken(t):n&&(n.indexOf("InformationProtection.Read.All")>-1||n.indexOf("InformationProtectionPolicy.Read")>-1||n.indexOf("Calendars.Read")>-1)?o.n.resolve(this.resources.consumeAsync(f.e.bypass)).then(function(e){return e.fetchToken({resource:t,claims:null==a?void 0:a.claims})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("ms-graph",{resource:t&&new c.e(t).authority||"https://graph.microsoft.com",claimsChallenge:a})},t.prototype.getLokiToken=function(){return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com"})},t.prototype.getPushChannelToken=function(){return this._getTokenForResource("pushchannel",{resource:"https://pushchannel.1drv.ms",useSpHttpDataSource:!0})},t.prototype.getTeamsCMDToken=function(){return this._getTokenForResource("teams-cmd",{resource:"6bc3b958-689b-49f5-9006-36d165f30e00",useSpHttpDataSource:!0})},t.prototype.getMeetingCatchupToken=function(){return this._getTokenForResource("ms-mcu",{resource:"https://MeetingCatchup.substrate.office.com",useSpHttpDataSource:!0})},t.prototype.getOCPSToken=function(){return this._getTokenForResource("ocps",{resource:"https://clients.config.office.net",useSpHttpDataSource:!0})},t.prototype.getSPHomeToken=function(e){return this._getTokenForResource("SPHome",{resource:e.resource})},t.prototype.getOfficeToken=function(){return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com"})},t.prototype.getSubstrateToken=function(e){var t,n,a,i;void 0===e&&(e={tokenType:d.n.Default,resourceType:d.t.Default});var r,o=e.tokenType,s=e.skipCache,c=e.resourceType;if(o===d.n.STI)return this._getTokenForResource("ms-substrate-sti",{resource:k,tokenType:"STI",skipCache:s});var l=Object(I.r)(null===(t=this._pageContext)||void 0===t?void 0:t.env2);r=w?(null===(n=this._pageContext)||void 0===n?void 0:n.substrateEndpointUrl)||k:O&&l&&(null===(a=this._pageContext)||void 0===a?void 0:a.substrateEndpointUrl)||k;var u="ms-substrate";return L&&c===d.t.Search&&l&&(r="".concat((null===(i=this._pageContext)||void 0===i?void 0:i.substrateEndpointUrl)||"https://partner.outlook.cn","/search"),u="ms-substrate-search"),this._getTokenForResource(u,{resource:r,skipCache:s})},t.prototype.getSubstrateTenantFeedbackToken=function(){return this._getTokenForResource("ms-substrate-tenant-feedback",{resource:"https://substrate.office.com/tenantfeedback",useSpHttpDataSource:!0})},t.prototype.getMediaTAToken=function(e){return this._getTokenForResource("SharePoint-media",{resource:e})},t.prototype.getMediaTAGptToken=function(e,t){return o.n.resolve(this.resources.consumeAsync(f.e)).then(function(n){return n.fetchToken({resource:e,claims:null==t?void 0:t.claims})}).then(function(e){return{accessToken:e}})},t.prototype.getAugloopToken=function(e){return void 0===e&&(e="https://augloop.office.com/v2"),this._getTokenForResource("ms-augloop",{resource:e,useSpHttpDataSource:!0})},t.prototype.getSharePointToken=function(e,t,n){var a=/https:\/\/(.*).svc.ms/.test(e);if(!C&&this._isGraphEndpoint(e))return this._getTokenForResource("ms-graph",{resource:new c.e(e).authority,forceRefresh:t,claimsChallenge:n});if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||a){if(this._isGraphEndpoint(e)||a){var i=this._isGraphEndpoint(e)?"SharePoint-graph":a?"SharePoint-media":"SharePoint";return this._getTokenForResource(i,{resource:e,forceRefresh:t,claimsChallenge:n})}return o.n.resolve(this.resources.consumeAsync(f.e.bypass)).then(function(t){return t.fetchToken({resource:e,claims:null==n?void 0:n.claims})}).then(function(e){return{accessToken:e}})}return this._getTokenForResource("SharePoint_SelfIssued",{resource:e,forceRefresh:t,tokenType:"SPO",claimsChallenge:n})},t.prototype.getPowerBIToken=function(e){return this._getTokenForResource("power-bi",{resource:e})},t.prototype.getPowerPlatformToken=function(e){return this._getTokenForResource("power-platform",{resource:e,useSpHttpDataSource:!0})},t.prototype.getPhoneLinkToken=function(e){return o.n.resolve(this.resources.consumeAsync(f.e.bypass)).then(function(t){return t.fetchToken({resource:e,tokenName:"PhoneLink"})}).then(function(e){return{accessToken:e}})},t.prototype.getYammerToken=function(e){return this._getTokenForResource("yammer",{resource:e})},t.prototype.getAzNBToken=function(){return o.n.resolve(this.resources.consumeAsync(f.e.bypass)).then(function(e){return e.fetchToken({resource:"api://63c9fecc-99c2-4c4c-878f-84685641aa94"})}).then(function(e){return{accessToken:e}})},t.prototype.getOfficeHomeToken=function(e){return o.n.resolve(this.resources.consumeAsync(f.e.bypass)).then(function(t){return t.fetchToken({resource:e,tokenName:"OfficeHome"})}).then(function(e){return{accessToken:e}})},t.prototype.getOAuthSessionToken=function(e,t){var n=M.indexOf(e)>=0;return this._getTokenForResource("oAuth",{resource:e,claimsChallenge:t,useSpHttpDataSource:n})},t.prototype.getFormDigest=function(e){var t;return t=e?this._isAddContextInfoPathToPassedInUrlKSActive?e:e.split("/_api")[0]+"/_api/contextInfo":this._getContextInfoUrl(),this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},t.prototype._getTokenForResource=function(e,t){var n,i;return Object(a.__awaiter)(this,void 0,o.n,function(){var r,s,c,d,l,u,m,h,g,v,y,S,D,I,x,C,O=this;return Object(a.__generator)(this,function(w){switch(w.label){case 0:return r=t.resource,s=t.tokenType,c=t.claimsChallenge,d=t.forceRefresh,l=Object(b.e)({tokenName:e,resource:r,tokenType:s}),u=this._promiseCache.get(l),m=E?null===(n=this._prefetchPromiseCache)||void 0===n?void 0:n.get(l):void 0,h=function(e){var n=e.access_token,a=e.expires_on,i=e.correlationId,r=1e3*(Number(a||Object(_.a)(n).exp)-300);return t.skipCache||O._cache.setValue(l,{value:n,expiration:r,correlationId:i}),{accessToken:n,tokenExpiry:r,correlationId:i}},c||d?[4,Promise.all(Object(a.__spreadArray)(Object(a.__spreadArray)([],u?[u.catch(function(e){})]:[],!0),m?[m.catch(function(e){})]:[],!0))]:[3,2];case 1:return w.sent(),this._cache.setValue(l,void 0),[3,8];case 2:return(g=this._cache.getValue(l,Date.now()))?[2,{accessToken:g.value,tokenExpiry:g.expiration,correlationId:g.correlationId}]:u?A?[4,u]:[3,4]:[3,6];case 3:return(v=w.sent())?[2,v]:[3,6];case 4:return[4,u];case 5:return[2,w.sent()];case 6:return m?(A&&(null===(i=this._prefetchPromiseCache)||void 0===i||i.delete(l)),y=function(){return Object(a.__awaiter)(O,void 0,o.n,function(){var e,t,n,i,r;return Object(a.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,m];case 1:return e=o.sent(),new p.e(e.qos.start).end(Object(a.__assign)(Object(a.__assign)({},e.qos.end),{resultType:e.qos.success?p.t.Success:p.t.Failure})),t=void 0,e.response?A&&!e.response.ok?[2,void 0]:[4,e.response.json()]:[3,3];case 2:n=o.sent(),t=h(Object(a.__assign)(Object(a.__assign)({},n),{correlationId:e.response.headers.get("SPRequestGuid")||""})),o.label=3;case 3:return A||null===(i=this._prefetchPromiseCache)||void 0===i||i.delete(l),[2,t];case 4:return o.sent(),A||null===(r=this._prefetchPromiseCache)||void 0===r||r.delete(l),[2,void 0];case 5:return[2]}})})},S=y(),A&&this._promiseCache.set(l,S),[4,S]):[3,8];case 7:if(D=w.sent(),A&&this._promiseCache.delete(l),D)return[2,D];w.label=8;case 8:return I=function(){return Object(a.__awaiter)(O,void 0,o.n,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,this.resources.consumeAsync(f.e.bypass)];case 1:return[4,e.sent().fetchToken({resource:r,claims:null==c?void 0:c.claims})];case 2:return[2,{access_token:e.sent()}]}})})},x=function(){return Object(a.__awaiter)(O,void 0,o.n,function(){return Object(a.__generator)(this,function(n){switch(n.label){case 0:return t.useSpHttpDataSource?[4,I()]:[3,2];case 1:case 3:return[2,n.sent()];case 2:return[4,this._tokenFetcher.getToken({name:e,resource:r,tokenType:s,claimsChallenge:c})]}})})},C=x().then(function(e){var t=h(e);return O._promiseCache.delete(l),t},function(e){return O._promiseCache.delete(l),o.n.reject(e)}),this._promiseCache.set(l,C),[4,C];case 9:return[2,w.sent()]}})})},t.prototype._getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()},t.prototype._isGraphEndpoint=function(e){var t="".concat(this._pageContext.msGraphEndpointUrl,"/");return"".concat(e,"/").slice(0,t.length)===t},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{pageContext:r.e,identityDataStoreCachingType:h.e.optional,tokenFetcher:S.e,prefetchPromiseCache:y.optional,identityCache:x.e}),t}(i.e),T=(t.default=P,Object(s.r)("IdentityDataSource",P))},385:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r});var a,i,r,o="https://portal.office.com/";!function(e){e.Msa="msa_auth:",e.Graph="graph_auth:",e.MsaStrongAuth="msa_strong_auth:",e.PhoneLink="phone_link:",e.Substrate="substrate_auth:"}(a||(a={})),function(e){e[e.STI=1]="STI",e[e.Default=2]="Default"}(i||(i={})),function(e){e[e.Default=1]="Default",e[e.Search=2]="Search"}(r||(r={}))},409:function(e,t,n){"use strict";n.d(t,"o",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"i",function(){return u});var a=n(481),i=n(464);n.d(t,"r",function(){return i.e}),new a.t("provider.suiteNav"),new a.t("provider.peopleCard"),new a.t("provider.shareByLink"),new a.t("provider.groupsLeftNav"),new a.t("provider.publishingSiteProvider"),new a.t("provider.userInfo");var r=new a.t("provider.tag"),o=new a.t("provider.photo"),s=(new a.t("provider.notification"),new a.t("provider.notificationManager"),new a.t("provider.instrumentation")),c=new a.t("provider.teachingBubble"),d=new a.t("provider.embed"),l=(new a.t("provider.storageInfo"),new a.t("provider.storageOptions"),new a.t("provider.subscriptions"),new a.t("provider.customAction"),new a.t("provider.taxonomy"),new a.t("provider.thumbnail"),new a.t("provider.appsItem"),new a.t("provider.externallySharedItem"),new a.t("provider.popularItem"),new a.t("provider.mostViewsItem"),new a.t("provider.mostViewersItem"),new a.t("provider.subsiteItem"),new a.t("provider.itemHistory"),new a.t("provider.spotlight"),new a.t("provider.error"),new a.t("provider.publish"),new a.t("provider.bundleLoader")),u=(new a.t("provider.upsell"),new a.t("provider.profile"),new a.t("provider.processFilters"),new a.t("provider.userState"));new a.t("provider.ransomwareDetection"),new a.t("provider.promotedPhotos"),new a.t("provider.site"),new a.t("provider.graphToken"),new a.t("provider.dragAndDropRobot"),new a.t("provider.recycleBin"),new a.t("provider.premiumState"),new a.t("provider.mruRecent"),new a.t("provider.userExpiration"),new a.t("provider.requestReview")},428:function(e,t,n){"use strict";n.d(t,"n",function(){return c});var a=n(181);n.d(t,"e",function(){return a.t});var i=n(114),r=n(331),o=n(445),s=n(334),c=Object(s.o)("DataRequestor",a.t,{pageContext:i.e,offlineDetection:r.e,noRedirect:o.e});t.t=a.t},435:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(1),i=n(252),r=n(249),o=n(481),s=n(334),c=n(913),d=n(483),l="Engagement",u=new o.t({name:"".concat(l,".useEngagementSystem"),factory:new o.e(!0)}),f={engagementHandlers:d.e.optional},p=new o.t({name:"".concat(l,".engagementHelper"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee(1,4047)];case 1:return e=t.sent().EngagementHelper,[2,{dependencies:f,create:function(t){var n=t.engagementHandlers;return{instance:new e({},{handlers:n})}}}]}})})}}}),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._isEnabled=n.isEnabled,a._getEngagementHelper=n.getEngagementHelper,a._getEngagementHandlers=n.getEngagementHandlers,a._isEnabled&&a._getEngagementHelper().catch(function(){}),a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){var t=this;void 0===e&&(e={}),this._isEnabled?this._getEngagementHelper().then(function(n){n.fromSource({contexts:t.contexts}).logData(e)}).catch(function(){}):e.name&&r.e.logData(e)},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},isEnabled:this._isEnabled,getEngagementHelper:this._getEngagementHelper,getEngagementHandlers:this._getEngagementHandlers})},t.dependencies={engagementSource:c.n,isEnabled:u,getEngagementHelper:p.async.lazy,getEngagementHandlers:d.e.optional.async.lazy},t}(i.t),_=Object(s.r)(l,m)},438:function(e,t,n){"use strict";var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),t.e=a},445:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)({name:"".concat("dataRequestNoRedirect.key",".dataRequestNoRedirect"),factory:{dependencies:{},create:function(){return{instance:void 0}}}})},458:function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},464:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("provider.suiteNavBasic")},534:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("".concat("MicroServiceDataSource.key",".microServiceDataSource"))},539:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(64),i=n(334),r=function(){function e(){}return e.prototype.getUrlParts=function(e){return new o(e)},e.dependencies={},e}(),o=function(){function e(e){this._url=e}return Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!1,configurable:!0}),e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}return this._getDriveId=function(){return e},e},e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}return this._getItemId=function(){return e},e},e.prototype._getPathSegments=function(){var e,t=this._url;return e=t?new a.t(t).getPathSegments():[],this._getPathSegments=function(){return e},e},e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");return this._getIndexOfDrivesSegment=function(){return e},e},e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");return this._getIndexOfItemsSegment=function(){return e},e},e}(),s=Object(i.r)("VroomUrlHelper",r)},560:function(e,t,n){"use strict";var a=n(534);n.d(t,"e",function(){return a.e})},571:function(e,t,n){"use strict";var a=n(428);n.d(t,"e",function(){return a.n})},582:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(481),i=n(129).e.local,r=new a.t({name:"".concat("CachingType.key",".cachingType"),factory:new a.e(i)})},619:function(e,t,n){"use strict";var a=n(1),i=n(45),r=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(i.q)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}());t.e=r},705:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("searchBoxConfig")},711:function(e,t,n){"use strict";function a(e){var t=e.tokenName,n=e.resource,a=e.tokenType;return"".concat(t,"|").concat(n,"|").concat(a||"")}n.d(t,"e",function(){return a})},712:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(481),i=n(851),r=n(582),o=n(114),s=new a.t({name:"IdentityCache.key",factory:{dependencies:{pageContext:o.e,identityDataStoreCachingType:r.e},create:function(e){var t=e.pageContext,n=e.identityDataStoreCachingType;return{instance:new i.e({userId:t.systemUserKey,cachingType:n})}}}})},775:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("CookieRefresher")},779:function(e,t,n){"use strict";var a=n(1574);t.e=a.e},804:function(e,t,n){"use strict";n.r(t),n.d(t,"getProperties",function(){return r}),n.d(t,"createSearchRoot",function(){return o}),n.d(t,"getItemStatistics",function(){return s}),n.d(t,"getUserFromOwsString",function(){return c});var a=n(168),i=n(117);function r(e){for(var t={},n=0,a=e.results;n<a.length;n++){var i=a[n],r=i.Key,o=i.Value;switch(i.ValueType){case"Edm.Boolean":t[r]={false:!1,true:!0}[o];break;case"Edm.Double":t[r]=parseFloat(o);break;case"Edm.Byte":case"Edm.Int32":case"Edm.Int64":t[r]=parseInt(o,10);break;case"Null":t[r]=null;break;case"Edm.String":if("Edges"===r){for(var s=JSON.parse(o),c=0,d=s;c<d.length;c++){var l=d[c];l.Properties.BlobContent&&(l.Properties.BlobContent=JSON.parse(l.Properties.BlobContent.toString()))}t[r]=s}else t[r]=o;break;default:t[r]=o}}return t}function o(e){var t=new a.e(e.key);return t.type=i.e.Folder,t.queryType=t.displayType=e.queryType,t.name=t.displayName=e.name,t.isRootFolder=!0,e.isPlaceholder||(t.isPlaceholder=!1),"number"==typeof e.childCount&&(t.folder={childCount:e.childCount}),t}function s(e){return{views:e.ViewsLifeTime||0,viewsUnique:e.ViewsLifeTimeUniqueUsers||0,viewsLast2Weeks:e.ViewsRecent||0,viewsLast2WeeksUnique:e.ViewsRecentUniqueUsers||0,viewsLastMonth:e.ViewsLastMonths1||0,viewsLastMonthUnique:e.ViewsLastMonths1Unique||0,viewsLastWeek:(e.ViewsLast7Days||0)+(e.ViewsLast6Days||0)+(e.ViewsLast5Days||0)+(e.ViewsLast4Days||0)+(e.ViewsLast3Days||0)+(e.ViewsLast2Days||0)+(e.ViewsLast1Days||0),viewsLastWeekUnique:(e.ViewsLast7DaysUniqueUsers||0)+(e.ViewsLast6DaysUniqueUsers||0)+(e.ViewsLast5DaysUniqueUsers||0)+(e.ViewsLast4DaysUniqueUsers||0)+(e.ViewsLast3DaysUniqueUsers||0)+(e.ViewsLast2DaysUniqueUsers||0)+(e.ViewsLast1DaysUniqueUsers||0)}}function c(e){var t={title:"",email:"",id:"",sip:""};if(e){var n=e.indexOf("|");t.sip=e.slice(0,n).trim();var a=e.indexOf("|",n+1);t.title=e.slice(n+1,a).trim()}return t}},815:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(481),i=n(334),r=n(1),o=n(178),s=n(181),c=n(103),d=n(127),l=n(60),u=n(0),f=function(){function e(e,t){var n=this,a=t.cookieRefresher,i=t.pageContext,c=t.noRedirect,d=void 0===c?!u.e.isActivated("22A14184-8C68-4EA3-8CA6-09C8A9009A71")||void 0:c;this._pageContext=i;var l=a?{getFormDigest:function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a.refreshCookies({resource:e.url,expiration:e.expiration,claimsChallenge:e.claimsChallenge})];case 1:return t.sent(),[2,void 0]}})})}}:void 0;this._dataRequestor=new s.e({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:i,tokenProvider:l,noRedirect:d}),this._apiUrlHelper=new o.t({webAbsoluteUrl:i.webAbsoluteUrl})}return e.prototype.getToken=function(e){var t=e.name,n=e.resource,a=e.tokenType,i={resource:n,tokenType:a};if(!u.e.isActivated("3985CFAD-51BE-4D3E-A7F9-F1C2ADFD85E4","09/18/2023","Validate that self-signed resource is in tenant")){var o=new d.t({context:this._pageContext}).getUrlParts({webUrl:n});if("SPO"===a&&o.geoRelation===d.e.unknown)throw new l.e({code:"InvalidTenantForSelfSignedToken"})}var s=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return this._dataRequestor.getData({url:s,method:"POST",qosName:"AcquireToken."+t,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},allowOAuth:!1,parseResponse:function(e,t){var n=JSON.parse(e),a=t.getCorrelationId();return Object(r.__assign)(Object(r.__assign)({},n),{correlationId:a})},additionalPostData:JSON.stringify(i),telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var a=t.code;if(a&&(a.indexOf("0x80070005")>-1||a.indexOf("10012")>-1))return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:c.e.ExpectedFailure})}}return{eventData:n}}})},e}(),p=n(114),m=n(775),_=n(445),h=Object(i.r)("".concat("AcquireTokenFetcher.key",".tokenFetcher"),f,{pageContext:p.e,cookieRefresher:m.e.optional,noRedirect:_.e}),b=new a.t({name:"TokenFetcher.key",factory:new i.e(h)})},850:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(481),i=n(334),r="SpHttpDataSource.async.key",o=(n(0).e.isActivated("723526D9-B1A5-4ADC-81B1-B7D1B4934EBB","9/23/2020","Workaround for loading sp-http in AMD builds"),new a.t({name:r,loader:new i.t(function(){return n.ee(29,879).then(function(e){return e.resourceKey})})}));new a.t({name:r,loader:new i.t(function(){return n.ee(29,879).then(function(e){return e.typeResourceKey})})})},851:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(118),i=function(){function e(){this._state={}}return e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]},e.prototype.setValue=function(e,t){t?this._state[e]=t:delete this._state[e]},e}(),r=function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new a.e("Identity.OAuth.".concat(t),n)}return e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)},e.prototype.setValue=function(e,t){t?this._store.setValue(e,t):this._store.remove(e)},e}()},868:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("suiteNavV2")},913:function(e,t,n){"use strict";n.d(t,"n",function(){return r});var a=n(252);n.d(t,"e",function(){return a.n});var i=n(481);n.d(t,"t",function(){return a.a});var r=new i.t({name:"".concat("Engagement",".engagementSource"),factory:new i.e(a.e)})},919:function(e,t,n){"use strict";var a=n(705);n.d(t,"e",function(){return a.e})},939:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("prefetchCache")},957:function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(481),i=n(691),r=new(n(174).e)("photosExperimentHelperKeyFacet",{}).serialize({}),o=new(n(66).e)("photosExperimentHelper"),s=n(4);n(73),n(99);var c=n(9),d=n(135),l=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:!c.xo||Object(c.yo)(c.Vr)||Object(c.yo)(c.Kr)}}}}),u=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:!c.xo||Object(c.yo)(c.Vr)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!c.xo&&Object(c.yo)(c.Kr)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:d.e},create:function(e){return{instance:Object(c.yo)(c.Ur)&&(!e.platformDetection.isIE||Object(c.yo)(c.Fr))&&(!e.platformDetection.isSafari||Object(c.yo)(c.Nr))&&(!e.platformDetection.isMobile||Object(c.yo)(c.Rr))}}}})),f=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.yo)(c.zr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.yo)(c.Gr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:e.isItemsScopeEnabledInAllPhotosPivot}}}}));new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.yo)(c.Hr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.yo)(c.Br)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:function(e){var t=e(Object(i.e)(function(e){return e.demandItemFacet(o,r)}));return Object(s.isFeatureEnabled)(s.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:f},create:function(e){return{instance:e.isItemsScopeEnabledInSinglePlaceView}}}})},1096:function(e,t,n){"use strict";n.r(t),n.d(t,"previewImageUrl",function(){return i}),n.d(t,"previewImageUrlFromProps",function(){return r}),n.d(t,"previewImageUrlFromUrl",function(){return o});var a=n(2124);function i(e,t,n,a){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,s=e.WebId||e.webId||n.webId,c=e.UniqueId||e.UniqueID||e.uniqueId,d=e.Url||e.url||e.Path;return c&&i&&s&&!a?r(i,s,c,t,n):o(d,t,n)}}function r(e,t,n,a,i){var r;if(i.isSPO)return n&&(r=s(function(r){var o=r?"":"&resolution=Width1024";return a+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o})),r}function o(e,t,n){var a;if(n.isSPO)return e&&(a=s(function(a){var i=a?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i})),a}function s(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===a.e.name),width:0,height:0}}}}},1194:function(e,t,n){"use strict";n.d(t,"t",function(){return v}),n.d(t,"n",function(){return y});var a,i,r,o,s,c=n(853),d=(n(619),n(942)),l=n(545);n.d(t,"e",function(){return l.e});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project";(a={})[u]=d.f,a[f]=d.i,a[p]=d.o,a[m]=d.t,a[_]=d.l,(i={})[u]=d.u,i[f]=d.a,i[p]=d.r,i[m]=d.e,i[_]=d.d,i[h]=d.c,i[b]=d.s,i["ms-infopath"]=d.n;var g=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function v(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":g[e.appMap]||"Word"}function y(e){var t=c.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page",(s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s.Stream="svg/stream_16x1.svg"},1195:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"i",function(){return u});var a=n(471),i=n(1425),r=n(90),o=n(1296);function s(e){return e?r.format(a.A,e):""}function c(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function d(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.e)({userLoginName:t.email})}}function l(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function u(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}n.d(t,"r",function(){return o.e})},1249:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1),i=n(263),r=n(124);function o(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.consumeAsync(i.e.optional)];case 1:return a.sent(),o=e.consume(r.e),s=t(o),c=new(e.injected(s))(n||{}),d=function(){c.dispose()},[4,c.execute(null).done(d,d)];case 2:return a.sent(),[2]}})})}},1355:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(481).t)("searchBoxDataSource")},1360:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(481),i=new a.t("app.admin"),r=new a.t("app.spourl");new a.t("app.suitenavrendered")},1446:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return T});var a=n(1),i=n(54),r=n(571),o=n(804),s=n(168),c=n(117),d=n(177),l=n(215),u=n(742),f=n(145),p=n(64),m=n(69),_=n(58),h=n(344),b=n(72),g=n(334),v=n(2548),y=n(471),S=n(56),D=n(299),I=n(178),x=n(136),C=n(221),O=n(130),w=n(162),E=n(62),A=n(9),L="CurrentWebDataSource_CurrentWeb",k="CurrentWebDataSource_SubWebs",M=["Title","Path","Filename","Created","LastModifiedTime","LinkingUrl","ParentLink","SiteID","WebId","UniqueID","ViewsLifeTime","ViewsLifeTimeUniqueUsers","ViewsRecent","ViewsRecentUniqueUsers","ViewsLastMonths1","ViewsLastMonths1Unique","ViewsLast7Days","ViewsLast6Days","ViewsLast5Days","ViewsLast4Days","ViewsLast3Days","ViewsLast2Days","ViewsLast1Days","ViewsLast7DaysUniqueUsers","ViewsLast6DaysUniqueUsers","ViewsLast5DaysUniqueUsers","ViewsLast4DaysUniqueUsers","ViewsLast3DaysUniqueUsers","ViewsLast2DaysUniqueUsers","ViewsLast1DaysUniqueUsers"],P=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._itemsStore=n.itemsStore,a._urlDataSourceLite=n.urlDataSourceLite,a._identityDataSource=n.identityDataSource,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"CurrentWebDataSource"}),a}return Object(a.__extends)(t,e),t.prototype.getCurrentWeb=function(){var e=this,t=this._itemsStore.getValue(L);if(t)return u.n.wrap(t);var n=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'SiteId:"'.concat(b.e.normalizeLower(this._pageContext.siteId,!1),'" ')+'AND WebId:"'.concat(b.e.normalizeLower(this._pageContext.webId,!1),'" ')+"AND (contentclass:STS_Site OR contentclass:STS_Web)",rowlimit:1,bypassresulttypes:!1,selectproperties:M.join(","),SourceId:"8413cd39-2156-4e00-b54d-11efd9abdb89"});return this._pageContext.groupType===v.e.private&&(n=n.parameter("Properties","EnableDynamicGroups:true")),this._dataRequestor.getData({url:n.toString(),qosName:"GetCurrentWeb",method:"POST"}).then(function(t){if(t&&t.d){var n=e._processData(t);for(var a in n)return e._itemsStore.setValue(L,n[a]),n[a]}return null})},t.prototype.getSubWebs=function(){var e=this,t=this._itemsStore.getValue(k);if(t)return u.n.wrap(t);var n=this._pageContext.webAbsoluteUrl,a=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'ParentLink:"'.concat(n,'" AND contentclass:STS_Web'),rowlimit:100,bypassresulttypes:!1,selectproperties:M.join(",")});return this._dataRequestor.getData({url:a.toString(),qosName:"GetSubWebs",method:"GET"}).then(function(t){if(t&&t.d){var n=e._processData(t);return e._itemsStore.setValue(k,n),n}return null})},t.prototype.getMyOneDriveUrl=function(){var e;if(Number(this._pageContext.webTemplate)===w.t.mySite&&(Object(A.yo)(A.Na)?this._pageContext.isMySiteOwner:this._pageContext.isSiteOwner))e=u.n.resolve(this._pageContext.webAbsoluteUrl);else{if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return u.n.resolve(void 0);var t=this._apiUrlHelper.build().segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");e=this._dataRequestor.getData({url:t.toString(),qosName:"GetMyOneDriveUrl",noRedirect:!0,method:"POST"}).then(function(e){if(e&&e.d){var t=e.d.mySite;return t&&t.replace(/\/$/,"")}})}return this.getMyOneDriveUrl=function(){return e},e},t.prototype.getDefaultOneDriveLibrary=function(e){var t=this._apiUrlHelper.build().method("SP.Web.DefaultDocumentLibraryUrl",e);return this._dataRequestor.getData({url:t.toString(),qosName:"GetDefaultDocumentLibrary"}).then(function(t){var n=t&&t.d&&t.d.DefaultDocumentLibraryUrl;if(n){var a=[],i=new p.t(e),r={title:y.c,target:n.ServerRelativeUrl,customSettingsUrl:i.getScheme()+"://"+i.getHost()+n.ServerRelativeUrl,remote:n.FromCrossFarm};return a.push(r),a}return null})},t.prototype.getLists=function(e,t){var n=this,a=new D.e(e);return this._getTokenIfNecessary(e).then(function(t){var a;return a=t?new I.t({webAbsoluteUrl:e}).build().segment("Web").segment("AppTiles"):n._apiUrlHelper.build().method("SP.RemoteWeb",e).segment("Web").segment("AppTiles"),n._dataRequestor.getData({url:a.toString(),qosName:"GetLists",noRedirect:!0,authToken:t})}).then(function(e){return e&&e.d?e.d.results.filter(function(e){return t?(1===e.AppType||5===e.AppType||0===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate,!0):(1===e.AppType||5===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate)}).map(function(e){return{title:e.Title,thumbnail:e.Thumbnail,lastModified:e.LastModified,appType:e.AppType,appStatus:e.AppStatus,target:a.authority+e.Target,childCount:e.ChildCount,appId:e.AppId,appSource:e.AppSource,assetId:e.AssetId,productId:e.ProductId,contentMarket:e.ContentMarket,customSettingsUrl:e.CustomSettingsUrl,baseTemplate:e.BaseTemplate,appPrincipalId:e.AppPrincipalId}}):null})},t.prototype.getDocumentLibraries=function(e,t){var n=this;void 0===t&&(t={});var a=t.includeMediaLibraries,i=void 0!==a&&a,r=t.includePageLibraries,o=void 0!==r&&r,s=i?"GetDocumentAndMediaLibraries":"GetDocumentLibraries",c=this._apiUrlHelper.build().segment("SP.Web.".concat(s)).parameter("webFullUrl",e);return i&&(c=c.parameter("includePageLibraries",o.toString())),this._dataRequestor.getData({url:c.toString(),qosName:"GetDocumentLibraries",noRedirect:!0}).then(function(e){return e&&e.d?n._processDocLibData(e,s):null})},t.prototype.doesListWithTitleExist=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("lists").method("GetByTitle",e):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("lists").method("GetByTitle",e),a._dataRequestor.getData({url:r.toString(),qosName:"GetListByTitle",noRedirect:!0,additionalHeaders:t,authToken:n}).then(function(){return!0},function(){return!1})})},t.prototype.deleteList=function(e,t,n){var i=this,r=Object(a.__assign)({"X-HTTP-Method":"DELETE","If-Match":"*"},n),o=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(o).then(function(t){var n;return n=t?new I.t({webAbsoluteUrl:o}).build().segment("web").segment("lists").method("GetByTitle",e):i._apiUrlHelper.build().method("SP.RemoteWeb",o).segment("web").segment("lists").method("GetByTitle",e),i._dataRequestor.getData({url:n.toString(),qosName:"DeleteListByTitle",noRedirect:!0,additionalHeaders:r,authToken:t})})},t.prototype.recycleListById=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").method("lists",e).segment("recycle"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").method("lists",e).segment("recycle"),a._dataRequestor.getData({url:r.toString(),qosName:"RecycleListById",noRedirect:!0,additionalHeaders:t,authToken:n,method:"POST"})})},t.prototype.checkEffectivePermissions=function(e,t,n){var a=this._apiUrlHelper.build().segment("web").method("GetList",e).segment("EffectiveBasePermissions");return this._dataRequestor.getData({url:a.toString(),qosName:"checkEffectivePermissions",noRedirect:!0,additionalHeaders:n}).then(function(e){return O.e.hasItemPermission({permissions:e.d.EffectiveBasePermissions},t)})},t.prototype.checkWebEffectivePermissions=function(e,t,n){var a=this,i=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(t){var r;return r=t?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("EffectiveBasePermissions"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("EffectiveBasePermissions"),a._dataRequestor.getData({url:r.toString(),qosName:"checkWebEffectivePermissions",noRedirect:!0,additionalHeaders:n,authToken:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})}).catch(function(){return!1})},t.prototype.ensureSiteAssetsAndPermissions=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").segment("EnsureSiteAssetsLibrary").rawParameter("$expand=EffectiveBasePermissions");return this._dataRequestor.getData({url:n.toString(),qosName:"EnsureSiteAssetsAndPermissions",noRedirect:!0,additionalHeaders:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})},t.prototype.getListDefaultViewUrlByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e).segment("DefaultView");return this._dataRequestor.getData({url:n.toString(),qosName:"GetListDefaultViewUrlByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.ServerRelativeUrl})},t.prototype.getListIdByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e);return this._dataRequestor.getData({url:n.toString(),qosName:"GetListIdByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.Id})},t.prototype.makeHomePage=function(e){var t={__metadata:{type:"SP.Folder"},WelcomePage:e},n=this._apiUrlHelper.build().segments("web","RootFolder");return this._dataRequestor.getData({url:n.toString(),qosName:"MakeHomepage",additionalPostData:JSON.stringify(t),method:"POST",additionalHeaders:{"x-http-method":"MERGE"}})},t.prototype.setSchedulingFeature=function(e){var t=e?"add":"remove",n=this._apiUrlHelper.build().segments("web","Features","".concat(t,"(guid'E87CA965-5E07-4A23-B007-DDD4B5AFB9C7')"));return this._dataRequestor.getData({url:n.toString(),qosName:"SchedulingFeature",noRedirect:!0}).then(function(t){return{isFeatureActivated:e}})},t.prototype.listPowerPlatformUserDetails=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ListPowerPlatformUserDetails");return this._dataRequestor.getData({url:t.toString(),qosName:"ListPowerPlatformUserDetails",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype.consentToPowerPlatform=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ConsentToPowerPlatform");return this._dataRequestor.getData({url:t.toString(),qosName:"ConsentToPowerPlatform",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype._processDocLibData=function(e,t){var n=e.d[t],a=[];return n&&n.results&&(a=n.results.map(function(e){return{title:e.Title,target:e.ServerRelativeUrl,customSettingsUrl:e.AbsoluteUrl,remote:e.FromCrossFarm,id:e.Id,lastModified:e.Modified}})),a},t.prototype._processData=function(e){for(var t,n={},a=0,i=e.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results;a<i.length;a++){var r=i[a],d=o.getProperties(r.Cells),u=new p.t(d.Path),m=this._urlDataSourceLite.getKey(((t={})[f.n.idParamKey]=u.getPath(),t[f.n.uniqueParamKey]="search".concat(d.UniqueID||""),t)),_=new s.e(m);_.id=b.e.normalizeUpper(d.WebId,!1),_.name=d.Filename,_.parentLink=d.ParentLink,_.displayName=d.Title,_.isPlaceholder=!1,_.type=c.e.Unknown,_.dateModified=Object(l.t)(new Date(d.LastModifiedTime)),_.openUrl=d.LinkingUrl||d.Path,_.statistics=o.getItemStatistics(d),_.itemFromServer=d,n[_.id]=_}return n},t.prototype._processPowerPlatformSyncResult=function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;try{var n=JSON.parse(e);t.synchronizationDataObject=n.d.SynchronizationData,t.synchronizationStatus=n.d.SynchronizationStatus}catch(e){E.e.logError(e,{eventName:"PowerPlatformResponseParsingFailure",feature:"BizAppsForListTemplates"})}return t},t.prototype._isSupportedBaseTemplate=function(e,t){var n=e===S.t.genericList||e===S.t.survey||e===S.t.links||e===S.t.announcements||e===S.t.contacts||e===S.t.tasks||e===S.t.customGrid||e===S.t.issueTracking;return t?n||e===S.t.documentLibrary:n},t.prototype._getTokenIfNecessary=function(e){return this._itemUrlHelper.getUrlParts({webUrl:e,path:e}).isCrossDomain?this._identityDataSource.getSharePointToken(new D.e(e).authority).then(function(e){return e.accessToken}):u.n.resolve("")},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageContext:_.r,itemsStore:d.e,apiUrlHelper:h.e,itemUrlHelper:x.o,dataRequestorType:r.e,urlDataSourceLite:m.y,identityDataSource:C.resourceKey}),t}(i.n);t.default=P;var T=Object(g.r)("WebDataSource",P)},1626:function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},1627:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function r(e){return!!e&&i[e.toLowerCase()]}function o(e){return a.indexOf(e)>=0}},1628:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(249),i=n(145),r=n(86),o=n(69),s=n(161),c=n(458),d=n(58),l=n(20),u=n(117),f=n(422),p=n(56),m=n(131),_=n(136),h=n(539),b=n(185),g=n(153),v=n(481),y=n(334),S=n(386),D=n(0),I=n(1887),x=D.e.isActivated("1E9F2B0E-270E-4F40-9918-01DD9B46C5F0","7/2/2021","Use the page context from the list response for Web data"),C=D.e.isActivated("1d0ede26-6eb5-4fcb-be71-789d486af357","11/10/2022","Use the page context from the list response for Web data"),O=!1,w=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._pageContext=t.pageContext,this._itemUrlHelper=t.itemUrlHelper,this._vroomUrlHelper=t.vroomUrlHelper}return e.prototype.processResponse=function(e){var t=e.response,n=e.response,a=n.WebUrl,i=n.HttpRoot,r=n.ListData,o=n.rootFolder,s=n.ListSchema,d=(void 0===s?{}:s).Collapse,l=void 0===d?"FALSE":d,u=e.pageContext,p=e.requestKey,m=e.observer,_=this._urlDataSource.getKeyParams(p),h="TRUE"===l,b=this._itemUrlHelper.getItemUrlParts(p),g=this._itemUrlHelper.getUrlParts({path:b.serverRelativeListUrl,listUrl:b.fullListUrl});(a||i)&&this._processWeb({list:t,pageContext:u,requestKeyParts:_,observer:m});var v=this._processList({list:t,pageContext:u,listUrlParts:g,requestKeyParts:_,observer:m}).listRootItemKey,y=[];if(o){var S=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:_,observer:m});y.push.apply(y,S.parentItemUrls)}r&&!h&&(S=this._processListData({listData:r,listUrlParts:g,parentKey:p,requestKeyParts:_,observer:m}),y.push.apply(y,S.parentItemUrls));var D={};if(t.ParentInfo)for(var I=0,x=t.ParentInfo.ParentFolderInfo;I<x.length;I++){var C=x[I];D[C.ServerRelativeUrl]=f.t.fromHexString(C.Permissions)}for(var O=0,w=Object(c.e)(y);O<w.length;O++){var E=w[O];this._processParentItem({itemUrl:E,listUrlParts:g,parentInfo:D,requestKeyParts:_,observer:m})}return{listRootItemKey:v}},e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,a=e.requestKeyParts,i=e.listUrlParts,r=e.observer,o=[],c="",d=0,l=t;d<l.length;d++){var u=l[d],f=u.FileRef,p=this._processRow({row:u,observer:r,requestKeyParts:a,listUrlParts:i}).key;o.push.apply(o,this._getParentItemUrls({listUrlParts:i,itemUrl:f})),r.update([new s.e(p).succeed({set:{parent:{key:n},after:{key:c}}})]),c=p}return{parentItemUrls:o}},e.prototype._processRow=function(e){var t,n,a,o=e.row,c=e.row.FileRef,d=e.listUrlParts,u=e.requestKeyParts,f=e.observer,p=this._itemUrlHelper.getUrlParts({path:c,listUrl:d.fullListUrl});if((t={})[i.n.idParamKey]=p.serverRelativeItemUrl,t[i.n.listUrlKey]=p.normalizedListUrl,a=t,this._isFolder(o)){var m={},_=this._urlDataSource.getQueryType(u),h=u[i.n.typeFiltersKey];_!==r.e.Search&&(m[i.n.queryTypeParamKey]=u[i.n.queryTypeParamKey]),h&&(m[i.n.typeFiltersKey]=h),l.e(a,m),u[i.n.metadataSearchIdKey]&&l.e(a,((n={})[i.n.metadataSearchIdKey]=u[i.n.metadataSearchIdKey],n))}var b=this._urlDataSource.getKey(a),g=this._getParentKeyForListItem({listUrlParts:d,itemUrl:c,requestKeyParts:u}),v={key:b};return g&&(v.parentKey=g),f.update([new s.e(b).succeed({item:v})]),{key:b}},e.prototype._processRootFolder=function(e){var t,n,a,r=e.list,o=e.listUrlParts,c=e.requestKeyParts,d=e.observer,l=r.rootFolder,f=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.serverRelativeItemUrl,t[i.n.listUrlKey]=f.normalizedListUrl,t[i.n.queryTypeParamKey]=c[i.n.queryTypeParamKey],t[i.n.queryParamKey]=c[i.n.queryParamKey],t[i.n.typeFiltersKey]=c[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=c[i.n.metadataSearchIdKey],t)),_=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:c}),h={key:p,type:u.e.Folder,newWOPIDocumentEnabled:m.optional(r.NewWOPIDocumentEnabled)};if(_&&(h.parentKey=_),r.ListData){if(n=r.ListData.FolderId,"Sharepoint.DocumentSet"===r.ListData.CurrentFolderProgId){h.isDocSet=!0;var b=r.FolderContentTypeId,g=void 0,v=void 0;if(r.AvailableContentTypes)for(var y=0,S=r.AvailableContentTypes;y<S.length;y++){var D=S[y],I=D.contentTypeId;if(I&&0===I.indexOf("0x0120D520")){if(C){h.contentTypeId=I,a=D.displayName;break}if(b===I){h.contentTypeId=I,a=D.displayName;break}I&&0===I.indexOf("0x0120D520")&&(g||(g=I,v=D.displayName))}C||h.contentTypeId||(h.contentTypeId=g,a=v)}}if(r.ListData.CurrentFolderSpItemUrl){var x=this._vroomUrlHelper.getUrlParts(r.ListData.CurrentFolderSpItemUrl);h.itemId=m.optional(x.itemId),h.graph={itemId:m.optional(x.itemId),driveId:m.optional(x.driveId)}}}if(a&&h.contentTypeId?h.properties={ID:m.optional(n),ContentType:a,ContentTypeId:h.contentTypeId}:h.properties={ID:m.optional(n)},!this._isListRoot({itemUrl:l,listUrlParts:o})){var O=l.split("/").slice(-1)[0];h.name=O,h.displayName=O}return d.update([new s.e(p).succeed({item:h})]),{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}},e.prototype._processWeb=function(e){var t,n=e.list,a=e.requestKeyParts,o=e.observer,c=n.HttpRoot,d=n.SiteTitle,l=n.WebUrl||c&&b.a(decodeURIComponent(c)),f=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.normalizedItemUrl,t[i.n.queryTypeParamKey]=r.e.DocumentLibraries,t[i.n.typeFiltersKey]=a[i.n.typeFiltersKey],t)),m={serverRelativeUrl:l},_={key:p,type:u.e.Folder,subsite:m},h=!x&&e.pageContext||this._pageContext.webAbsoluteUrl===l&&this._pageContext;h&&(_.name=d,_.displayName=d,m.webTemplateId=Number(h.webTemplate),m.serverRelativeUrl=h.webAbsoluteUrl,m.id=h.webId,m.siteCollectionId=h.siteId,m.title=h.webTitle,m.icon=h.webLogoUrl),o.update([new s.e(p).succeed({item:_})])},e.prototype._processList=function(e){var t,n,o,c,d,l,f=e.list,_=e.listUrlParts,h=e.requestKeyParts,v=e.observer,y=f.ListTitle,D=f.HttpRoot,I=f.ListUrl,C=f.listUrlDir,w=I||C&&decodeURIComponent(C),E=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=_.serverRelativeItemUrl,t[i.n.listUrlKey]=_.normalizedListUrl,t[i.n.queryTypeParamKey]=h[i.n.queryTypeParamKey],t[i.n.queryParamKey]=h[i.n.queryParamKey],t[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=h[i.n.metadataSearchIdKey],t)),A=f.AllowCreateFolder,L=f.EnableMinorVersions,k=f.verEnabled,M=f.AllowGridMode,P=f.DisableGridEditing,T=f.ListTemplateType,U=f.BasePermissions,F=void 0===U?{}:U,H=F.ManageLists,R=void 0===H?void 0:H,N=F.ManagePersonalViews,B=void 0===N?void 0:N,j=F.OpenItems,V=void 0===j?void 0:j,z=F.UseClientIntegration,G=void 0===z?void 0:z,K=f.ListSchema,W=void 0===K?{}:K,q=W.DefaultItemOpen,Q=void 0===q?void 0:q,Y=W[".driveAccessTokenV21"],J=void 0===Y?void 0:Y,X=W[".driveAccessToken"],Z=void 0===X?void 0:X,$=W[".driveUrl"],ee=void 0===$?void 0:$,te=W[".driveUrlV21"],ne=void 0===te?void 0:te,ae=f.ExcludeFromOfflineClient,ie=f.WebExcludeFromOfflineClient,re=f.listBaseType,oe=Z,se=J,ce=ee,de=ne,le=!x&&e.pageContext||w===this._pageContext.listUrl&&this._pageContext,ue=null==le?void 0:le.driveInfo;f.isFromServiceWorkerCache&&ue&&(ue[".driveAccessToken"]&&(oe=ue[".driveAccessToken"]),ue[".driveAccessTokenV21"]&&(se=ue[".driveAccessTokenV21"]),ue[".driveUrl"]&&(ce=ue[".driveUrl"]),ue[".driveUrlV21"]&&(de=ue[".driveUrlV21"])),oe&&(o={accessToken:(d=Object(g.e)(oe)).access_token,proofToken:d.prooftoken,tokenUrl:ce}),se&&(c={accessToken:(d=Object(g.e)(se)).access_token,proofToken:d.prooftoken,tokenUrl:de});var fe=f.WebUrl||D&&b.a(decodeURIComponent(D));if(fe){var pe=this._itemUrlHelper.getUrlParts({path:fe,webUrl:fe});l=this._urlDataSource.getKey(((n={})[i.n.idParamKey]=pe.normalizedItemUrl,n[i.n.queryTypeParamKey]=r.e.DocumentLibraries,n[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],n))}var me="string"==typeof Q?"0"===Q:void 0;me&&(O||(a.e.logData({name:"List.openInClient"}),O=!0));var _e=ce&&this._vroomUrlHelper.getUrlParts(ce)||void 0;o&&Object(S.e)({authToken:o.accessToken,proofToken:o.proofToken})&&(o=void 0),c&&Object(S.e)({authToken:c.accessToken,proofToken:c.proofToken})&&(c=void 0);var he="number"==typeof re?Object(p.a)(String(re)):void 0;return v.update([new s.e(E).succeed({item:{key:E,parentKey:m.optional(l),itemId:m.backup("root"),graph:{itemId:m.backup("root"),driveId:m.optional((null==_e?void 0:_e.driveId)||void 0),sessionToken:m.optional(o),sessionTokenV21:m.optional(c)},type:u.e.Folder,name:m.optional(y),displayName:m.optional(y),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:m.optional(f.rootFolder?void 0:f.NewWOPIDocumentEnabled),list:{id:m.optional(f.listName),allowGridMode:"boolean"==typeof M?M:m.backup(!0),allowCreateFolder:m.optional(A),disableCommenting:"boolean"==typeof f.DisableCommenting&&f.DisableCommenting,disableGridEditing:"boolean"==typeof P?P:m.backup(!1),enableMinorVersions:m.optional(L),enableVersions:m.optional(k),templateType:m.optional("string"==typeof T?Number(T):void 0),isDocumentLibrary:m.optional(he),isPromotedLinks:m.optional("string"==typeof T?Object(p.s)(T):void 0),isForceCheckout:m.optional(f.isForceCheckout),isModerated:m.optional(f.isModerated),newWOPIDocumentEnabled:m.optional(f.NewWOPIDocumentEnabled),newWOPIDocumentTypes:m.optional(f.NewWOPIDocumentTypes),permissions:{manageLists:m.optional(R),managePersonalViews:m.optional(B),openItems:m.optional(V),useClientIntegration:m.optional(G)},openInClient:m.optional(me),excludeFromOfflineClient:m.optional("boolean"==typeof ae||"boolean"==typeof ie?ae||ie:void 0),contentTypesEnabled:m.optional(f.ContentTypesEnabled),metadataNavFeatureEnabled:m.optional(f.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:m.optional(f.canUserCreateMicrosoftForm),itemCount:m.optional(f.ListSchema&&f.ListSchema.ItemCount),rowLimit:m.optional(f.ListData.RowLimit),listUrlDir:w,createdFromExcel:m.optional(f.CreatedFromExcel),createdFromExisting:m.optional(f.CreatedFromExisting)},properties:{commandsSupported:m.optional(f.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]),{listRootItemKey:E}},e.prototype._processParentItem=function(e){var t,n=e.itemUrl,a=e.listUrlParts,r=e.parentInfo,o=e.requestKeyParts,c=e.observer,d=this._itemUrlHelper.getUrlParts({path:n,listUrl:a.fullListUrl}),l=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=d.serverRelativeItemUrl,t[i.n.listUrlKey]=d.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t)),f={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:a,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:a}))f.list={};else{var p=b.n(n);f.name=p,f.displayName=p,f.type=u.e.Folder,f.isDropEnabled=!0,f.folder={},r&&r[n]&&(f.permissions=r[n])}c.update([new s.e(l).succeed({item:f})])},e.prototype._getParentKeyForListItem=function(e){var t,n,a=e.listUrlParts,r=e.itemUrl,o=e.requestKeyParts;if(a.serverRelativeListUrl!==r){if(!D.e.isActivated("556c889b-eaaf-4e07-a746-6f7c7eee8553","8/18/2021","Show a more user-friendly error when the item does not have a FileRef field")&&!r)throw new Error(I.e);var s=r.split("/").slice(0,-1).join("/"),c=this._itemUrlHelper.getUrlParts({path:s,listUrl:a.fullListUrl});n=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=c.serverRelativeItemUrl,t[i.n.listUrlKey]=c.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t))}return n},e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,a=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var r="",o=0,s=n.substring(i.length).split("/").slice(1,-1);o<s.length;o++){var c=s[o];r+="/".concat(c);var d="".concat(i).concat(r);a.push(d)}return a},e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t},e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||a&&-1!==a.indexOf("onenote"))}else t=!1;return t},e.dependencies={urlDataSource:o.v,pageContext:d.r,itemUrlHelper:_.o,vroomUrlHelper:h.e,resources:v.r},e}(),E=Object(y.r)("ListItemResultProcessor",w)},1885:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(481),i=n(334),r=new a.t({name:"ShortcutLinkDataSource.key",loader:new i.t(function(){return n.ee(1,1974).then(function(e){return e.resourceKey})})})},1959:function(e,t,n){"use strict";n.d(t,"e",function(){return ne});var a=n(1),i=n(54),r=n(145),o=n(184),s=n(1096),c=n(86),d=n(64),l=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],u=n(208),f=n(185),p=n(779),m=n(1626),_=n(265).a,h=n(481),b=n(334),g=new h.t({name:"ListItemTrendingStatusProcessor.key",loader:new b.t(function(){return n.ee([465],4077).then(function(e){return e.resourceKey})})}),v=n(183),y=n(117),S=n(215),D=n(1858),I=n(1885),x=n(642),C=n(422),O=n(4),w=n(1194),E=n(1195),A=n(121),L=n(72),k=n(56),M=n(69),P=n(1627),T=n(58),U=new h.t("vroom.dataContext"),F=n(99),H=n(161),R=n(131),N=n(136),B=n(539),j=n(560),V=n(20),z=n(1851),G=n(1024),K=n(62),W=n(446),q=n(854),Q=n(130),Y=n(638),J=n(0),X=n(172),Z=n(1025),$=J.e.isActivated("D6DFF276-FF92-454E-AC05-F916D87BD82F","03/08/2022","Update the openUrl for items in a links list with the correct URL from server"),ee=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._urlDataSource=n.urlDataSource,a._listContext=n.listContext,a._navigation=n.navigation,a._microServiceDataSource=n.microServiceDataSource,a._vroomUrlHelper=n.vroomUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._vroomDataContext=n.vroomDataContext,a._shortcutLinkDataSource=n.shortcutLinkDataSource,a._allowWrsVisio=!1,a._htmlDecodeDiv=document.createElement("textarea"),a}return Object(a.__extends)(t,e),t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){throw K.e.log(e,"ListItemBuilder.getItemResult"),e}},t.prototype._getItemResult=function(e){var t,n,i,l,h,b=e.itemFromServer;if(!b)return null;var I,M=e.microServiceDataSource||this._microServiceDataSource,T=this._urlDataSource,U=e.requestKey,F=e.parentItemKey,N=e.queryType,B=void 0===N?T.getQueryType():N,j=e.groupBy,K=e.itemGroups,W=e.contentTypes,Y=e.supportsNestedGroups,Z=e.isItemDataOnly,ee=e.listTemplateType,ne=void 0===ee?this._listContext.listTemplateType:ee,ae=e.observer,ie=e.isMetaDataSearch,re=T.getKeyParams(U),oe=X.e.language,se=this._itemUrlHelper.getUrlParts({path:b.id||b.FileRef||b.ServerRelativeUrl,listUrl:re[r.n.listUrlKey]});(t={})[r.n.idParamKey]=se.serverRelativeItemUrl,t[r.n.listUrlKey]=se.normalizedListUrl,I=t;var ce=b.File_x0020_Type,de=ce?"."+ce:"",le=this._parseMediaServiceMetadata(b.MediaServiceFastMetadata),ue=this._parseMediaServiceMetadata(b.MediaServiceMetadata),fe=this._getItemType({itemFromServer:b,listTemplateType:ne,microServiceDataSource:M,mediaServiceFastMetadata:le});if(fe===y.e.Folder){var pe=re[r.n.idParamKey]===I[r.n.idParamKey],me=T.getItemTypeFilter(re),_e={};pe?((n={})[r.n.queryTypeParamKey]=re[r.n.queryTypeParamKey],n[r.n.queryParamKey]=re[r.n.queryParamKey],n[r.n.typeFiltersKey]=re[r.n.typeFiltersKey],_e=n):(B!==c.e.Search&&((i={})[r.n.queryTypeParamKey]=B,_e=i),me&&V.e(_e,T.saveItemTypeFilter(me))),V.e(I,_e),ie&&V.e(I,((l={})[r.n.metadataSearchIdKey]=re[r.n.metadataSearchIdKey],l))}var he=T.getKey(I),be={key:he,extension:de},ge=b.id||b.FileRef;be.id=ge;var ve,ye,Se=C.t.fromHexString(b.PermMask),De=Q.e.hasPermission(Se,Q.e.openItems),Ie=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!De,xe=b[".spItemUrl"];if(xe){var Ce=this._vroomUrlHelper.getUrlParts(xe);ve=Ce.itemId,ye=Ce.driveId}else ve=b["name.FileSystemItemId"]||(b.isRootFolder?"root":void 0);this._vroomDataContext&&ve&&this._vroomDataContext.setFileSystemIdMapping(ve,ge);var Oe=b[".etag"];Oe&&(be.eTag=Oe),be.itemId=R.optional(ve);var we=ne===k.t.mySiteDocumentLibrary;be.graph=R.optional(ve&&{itemId:ve,driveId:ye,driveType:ne?we?"business":"documentLibrary":void 0});var Ee=Number(b._ip_UnifiedCompliancePolicyUIAction)||_.none;"1"===this._navigation.viewParams[r.n.pseudoPolicyTipKey]&&(Ee=Number(b.ID)%6),be.policyTip=R.optional(Ee);var Ae=Object(P.t)(de);if((Ae||".ai"===de||".eps"===de||".psd"===de)&&M.getThumbnail({fileExtension:de,item:b,itemKey:he,mediaServiceMetadata:le})&&(fe=y.e.Media),q.t(de)?be.htmlConversion={}:q.e(de)&&(Le=M.getHtmlConversionUrl({fileExtension:de,item:b,mediaServiceMetadata:le}))&&(fe=y.e.Media,be.htmlConversion={url:"".concat(Le,"&inlineImages=true")}),Object(O.isFeatureEnabled)(O.EnableZipFilePreviewing)&&(".zip"===de||".rar"===de)){var Le=M.getZipMetaDataUrl({fileExtension:de,item:b,mediaServiceMetadata:le}),ke=M.getDownloadZipContentsUrl(b);Le&&ke&&(fe=y.e.Media,be.zip={zipMetaDataUrl:Le,downloadZipContentsUrl:ke})}var Me,Pe,Te,Ue,Fe,He,Re={},Ne=M.getDownloadAsZipUrl(b),Be=Object(O.isFeatureEnabled)(O.EnableOpenInImmersiveReader)&&M.getImmersiveReaderUrl({fileExtension:de,item:b});Ne&&(Re[o.t.downloadAsZip]=Ne),Be&&(Re[o.t.immersiveReaderUrl]=Be),xe&&(Re[o.t.itemUrl]=xe);var je=this._listContext,Ve=Number(b.File_x0020_Size)||Number(b.FileSizeDisplay)||void 0,ze=le&&le.video,Ge=".ts"===de&&Ve<1<<19&&!ze;Ge&&(fe=y.e.File);var Ke=le&&le.media,We=se.fullItemUrl,qe=We?f.e(We):void 0;if(fe===y.e.Folder)Me=b.ProgId&&"sharepoint.documentset"===b.ProgId.toLowerCase();else if(fe!==y.e.Media&&!le||Object(k.s)(ne))fe===y.e.File&&je&&void 0!==je.isDocLib&&!je.isDocLib&&(Pe={});else{var Qe=u.t(de),Ye=le&&le.photo||(Ae||"photo"===Qe?{}:void 0),Je=ze||("video"===Qe?{}:void 0),Xe=le&&le.audio||("audio"===Qe?{}:void 0);if(Ye&&(Te={originalUrl:R.optional("photo"===Qe?qe:void 0),width:Ye.width||0,height:Ye.height||0},Object(O.isFeatureEnabled)(O.Image360Viewer)&&ve&&(Ue=this._getImage360(b,le,Ye,ue))),Je){var Ze=J.e.isActivated("f0fc3265-1fce-4d4a-b67a-3b3dfa291a6f","09/27/2023","Get PremiumProcessingStatus from RLDAS for Premium Video in 1P 1.0")?void 0:Je.premiumProcessingStatus;Fe={fourCC:R.optional(Je.fourCC||(".mp4"===de.toLowerCase()?"H264":void 0)),bitrate:R.optional(Je.encodingBitrate),width:Je.frameWidth||0,height:Je.frameHeight||0,duration:te(Ke&&Ke.duration),audioFormat:R.optional(Xe&&Xe.format),manifestMetadata:Je.manifestMetadata,altManifestMetadata:Je.altManifestMetadata,premiumProcessingStatus:Ze}}Xe&&(He={duration:te(Ke&&Ke.duration)})}var $e=Ke&&Ke.title;be.caption=R.optional($e),be.photo=R.optional(Te),be.image360=R.optional(Ue),be.video=R.optional(Fe),be.audio=R.optional(He);var et=!J.e.isActivated("5ec031b1-e270-4bdd-8c72-638a99a62d60","10/23/2023","Get edits information from RLDAS infromation for Soft trim")&&b.Edits?JSON.parse(b.Edits):void 0;be.mediaEdits=et,be.listItem=R.optional(Pe),F&&(be.parentKey=F),be.isDocSet=R.optional(Me),se.serverRelativeItemUrl===se.serverRelativeListUrl&&(be.isRootFolder=!0);var tt,nt=z.e.getItemName(b,fe,je);be.name=R.optional(nt),be.displayName=R.optional(nt);var at,it=!0;if(b.Modified&&"21"===this._pageContext.webTemplate&&Object(O.isFeatureEnabled)(O.RequestDatesInUtc))try{var rt=new Date(b.Modified);be.dateModifiedTime=rt,be.dateModifiedValue=rt.getTime(),tt=Object(S.n)(rt),it=!1}catch(e){}if(it&&(be.dateModifiedValue=R.optional(b.Modified),tt=b["Modified.FriendlyDisplay"]?Object(D.e)(b["Modified.FriendlyDisplay"]):b.Modified?"".concat(b.Modified):""),be.dateModified=R.optional(tt||void 0),be.permissions=R.optional(Se),K&&j&&j.length>0)if(Y){K[0]||(K[0]=[]);var ot=K[0]&&K[0].length>0?K[0][K[0].length-1]:null,st=j[0],ct=j[1];if(st&&"1"===b[st+".newgroup"]){var dt=ot?ot.startIndex+ot.count:0,lt=Object(G.t)(je,b,st,0,!1,dt,void 0,oe),ut=this._convertToODNGroup(lt);K[0].push(ut),ot=ut}if(ct&&"1"===b[ct+".newgroup"]){var ft=ot&&ot.children&&ot.children.length>0?ot.children[ot.children.length-1]:null;dt=ft?ft.startIndex+ft.count:ot?ot.startIndex:0,Object(G.t)(je,b,ct,1,!1,dt,ot);var pt=ot.children.pop();ot.children.push(this._convertToODNGroup(pt))}}else for(var mt=0;mt<j.length;mt++){var _t=j[mt];if(_t){var ht=K[mt]&&K[mt].length>0?K[mt][K[mt].length-1]:null;"1"===b[_t+".newgroup"]&&(dt=ht?ht.startIndex+ht.count:0,ut=Object(G.t)(je,b,_t,mt,!1,dt),K[mt]||(K[mt]=[]),K[mt].push(this._convertToODNGroup(ut)))}}if(W&&W.length>0&&b.ContentTypeId)for(var bt=0,gt=W;bt<gt.length;bt++){var vt=gt[bt];if(b.ContentTypeId===vt.contentTypeId&&(at=!1,vt.requiredFields))for(var yt=0,St=vt.requiredFields.split(",");yt<St.length;yt++){var Dt=b[St[yt]];if(!Dt||Array.isArray(Dt)&&0===Dt.length){at=!0;break}}}be.hasMissingMetadata=R.optional(at),be.contentTypeId=R.optional(b.ContentTypeId);var It,xt,Ct,Ot,wt,Et=b.folder,At=[];if(Et){if(be.folder={},be.isDropEnabled=!0,It=[],Et.children){for(var Lt=0,kt=Et.children,Mt=kt.length,Pt=0,Tt=0;Tt<Mt;Tt++){var Ut=this.getItemResult({requestKey:U,queryType:B,itemFromServer:kt[Tt],groupBy:j,itemGroups:At,contentTypes:W,listTemplateType:ne,supportsNestedGroups:Y,isItemDataOnly:Z,observer:ae,isMetaDataSearch:ie,pageContext:e.pageContext});Ut&&(It[Tt]=Ut.item,Pt<10&&Ut.itemType===y.e.Media&&Lt++,Pt++)}Mt>0&&(Lt>=10||Lt>=Mt)&&(be.displayType=c.e.Photos)}}else{if(Ct=(Ct=b["serverurl.progid"])?Ct.substring(1):$||ne!==k.t.links?qe:b.URL,Re[o.t.original]=Ct,Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutItem({key:he,extension:de})&&(fe=y.e.Shortcut,b._ShortcutUrl?(be.shortcutInfo={shortcutLinkRewritten:!0},Re[o.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,b._ShortcutUrl,b._ShortcutSiteId,b._ShortcutWebId,b._ShortcutUniqueId),b._ShortcutUniqueId&&(xt=s.previewImageUrl({url:b._ShortcutUrl,siteId:b._ShortcutSiteId,webId:b._ShortcutWebId,uniqueId:b._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))):(be.shortcutInfo=R.backup({shortcutLinkRewritten:!1}),this._shortcutLinkDataSource.enqueueParseShortcut(he,e.itemFromServer.ID),Re[o.t.shortcutTarget]=d.t.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+A.e.encodeURIComponent(b.FileRef))),Re[o.t.open]=Ct,Ot=b["File_x0020_Type.mapapp"]||b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],se.isCrossDomain&&se.isCrossList){var Ft=b[".fileType"],Ht=w.n(Ft||"");Ot=void 0===Ht?Ft?void 0:Ot:Ht,"OneNote.Notebook"===b.HTML_x0020_File_x0020_Type&&(Ot="onenote|UsePlain"),"pdf"===b.File_x0020_Type&&(Ot=void 0)}be.size=R.optional(Ve),be.totalSize=R.optional(Number(b.SMTotalSize)||void 0),xt||(xt=this._getThumbnail({itemFromServer:b,listTemplateType:ne,extension:de,key:he,type:fe,mediaServiceFastMetadata:le,microServiceDataSource:M,pageContext:e.pageContext})),be.openUrl=Ct;var Rt=b["IconOverlay.mapoly"];Rt&&(be.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Rt),be.thumbnail=xt;var Nt=this._getPdfConversionFacet({extension:de,blockDownload:Ie,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:le});Nt&&(be.pdfConversion=Nt);var Bt=this._get3dFacet({extension:de,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:le});if(Bt&&(be.model3d=Bt),fe===y.e.Folder){var jt=Number(b.ItemChildCount)+Number(b.FolderChildCount);be.childCount=jt;var Vt=Number(b.SMTotalFileCount);be.folder={totalCount:Vt>0?Vt:jt,childCount:jt},be.isDropEnabled=!0}var zt=b.ServerRedirectedEmbedUrl;zt&&(this._itemUrlHelper.getUrlParts({path:zt}).isCrossDomain||(wt=zt))}be.previewIFrameUrl=wt,be.type=fe,be.appMap=R.optional(Ot),this._pageContext.blockDownloadsExperienceEnabled&&(be.type===y.e.Media||Ct&&Ot)?be.itemStatus=v.t.ConditionalAccessViewOnly:this._pageContext.blockDownloadsExperienceEnabled&&fe!==y.e.Folder?be.itemStatus=v.t.ConditionalAccessBlocked:this._pageContext.viewOnlyExperienceEnabled&&(be.itemStatus=v.t.ConditionalAccessViewOnly);var Gt={};for(var Kt in b)b.hasOwnProperty(Kt)&&(Gt[Kt]=b[Kt]);var Wt=L.e.normalizeLower(b.UniqueId)||void 0;Wt&&(Gt.uniqueId=Wt);var qt=b.RemoteItem;be.remoteItem=qt&&JSON.parse(qt),be.reputationProperties=this.getReputationProperties(b);var Qt,Yt=nt;de&&(Yt=nt.substring(0,nt.toLowerCase().lastIndexOf(de.toLowerCase()))),be.sharingRole=p.e.Owner,Qt=Number(b.PrincipalCount)>0?m.e.Shared:void 0===b.PrincipalCount?O.isOneDrive?void 0:m.e.Unknown:m.e.Private,be.sharingType=R.optional(Qt),Gt.FileName=Yt;var Jt=u.n({extension:de,isDocSet:Me,listItem:Pe,sharingType:Qt,type:fe,textEditorMimeType:Ge?"text/typescript":void 0,panorama:Ue,isMountPoint:!!qt});be.iconName=Jt;var Xt,Zt,$t="ms-powerpoint"===Ot,en="ms-visio"===Ot,tn="ms-word"===Ot;if(Ct&&(tn||"ms-excel"===Ot||$t||en)){var nn=this._getOfficeBundleFacet({isWord:tn,extension:de,itemUrlParts:se,isPowerPoint:$t,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:le});!nn||en&&!this._allowWrsVisio||(be.officeBundle=nn),nn&&(tn||$t)&&(Re[o.t.viewInBrowser]=M.getPdfConversionUrl({fileExtension:de,item:b,mediaServiceMetadata:le},!0)),be.wopiFrameUrl=Ct}be.defaultSubText=E.e(E.t(b.Editor)),be.isPlaceholder=!b.PermMask,be.queryType=B,be.displayType=R.backup(be.queryType),be.isDraggable=be.queryType===c.e.Files,b.folder||(Gt.modifiedByUser=E.a(b.Editor)),Gt.MediaServiceOCR=E.i(b.MediaServiceOCR),be.properties=Gt,be.lifeCycleStatus=R.optional(this._getItemLifeCycleStatus(b)),be.comments={settings:(Xt=b._CommentFlags,Zt={},Zt.isCommentDisabled=function(e){return void 0===e||null==e||(1&e)>0}(Xt),Zt)},be.urls=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Re),this._getVideoUrl({extension:de,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:le})),((h={})[o.t.mediaBaseUrl]=M.getMediaBaseUrl({fileExtension:de,item:b,mediaServiceMetadata:le}),h)),be.searchProperties={isMetadataSearch:ie},be.color=R.optional(b._ColorHex),null==ae||ae.update([new H.e(he).succeed({item:be})]),ae&&Object(O.isFeatureEnabled)(O.ItemAnalytics)&&Object(O.isFeatureEnabled)(O.EnableTrendingSignalInListView)&&he&&this.resources.consumeAsync(g).then(function(e){e.queueNewItem(he)});var an=this._getGroupings({itemFromServer:b,supportsNestedGroups:Y,groupBy:j,groups:At,language:oe}),rn=an.groupings,on=an.totalChildren;return{item:{key:he},itemPatch:be,itemType:fe,children:It,groupings:rn,totalChildren:on,nextRequestToken:b.nextRequestToken}},t.prototype._getItemLifeCycleStatus=function(e){var t={};return 1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0),t.isMalwareDetected=Object(Z.e)(e),t},t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,a=e.supportsNestedGroups,i=e.groupBy,r=e.groups,o=e.language,s=null,c=this._listContext.groupLevel,d=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])s=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==c)if(n.groups){var l=[],u=0;if(a){var f=Object(G.e)(n.groups,this._listContext,i,o),p=f.groups,m=f.totalCount;l=p.map(function(e){return t._convertToODNGroup(e)}),u=m}else for(var _=0,h=n.groups;_<h.length;_++){var b=h[_],g=i[c];if(b[g+".newgroup"]){var v=Object(G.t)(this._listContext,b,g,c,!0,u,void 0,o);l.push(this._convertToODNGroup(v)),u+=v.count}}l&&l.length>0&&(s=[{name:void 0,itemGroups:l,isAllCollapsed:this.createObservable(!0)}],d=u)}else r&&r.length>0&&r[c]&&r[c].length>0&&(s=[{name:void 0,itemGroups:r[c],isAllCollapsed:this.createObservable(!1)}]);return{groupings:s,totalChildren:d}},t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,a=[],i=n.folder.children,r=n.nextRequestToken?2:0,o=i.length+r,s=0;s<o;s++){var c=i[s];if(c&&this._getItemTypeOneNoteOrFolder(c)!==y.e.Folder){t=s;break}}return(void 0===t&&o>0||t>0)&&a.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})}),void 0!==t&&a.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})}),a.length?[{name:"FoldersDocumentsPhotos",itemGroups:a,isAllCollapsed:this.createObservable(!1)}]:void 0},t.prototype._getImage360=function(e,t,n,a){var i,r=t&&t.panorama,o=!1;if(r&&"equirectangular"===r.projectionType?(i={projectionType:r.projectionType},o=!0):e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0),o&&a){var s=a.panorama;if(s)i={projectionType:R.optional(r.projectionType||void 0),croppedAreaImageHeightPixels:R.optional(s.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:R.optional(s.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:R.optional(s.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:R.optional(s.croppedAreaTopPixels||void 0),fullPanoHeightPixels:R.optional(s.fullPanoHeightPixels||void 0),fullPanoWidthPixels:R.optional(s.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:R.optional(s.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:R.optional(s.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:R.optional(s.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:R.optional(s.initialViewPitchDegrees||void 0),initialViewRollDegrees:R.optional(s.initialViewRollDegrees||void 0),poseHeadingDegrees:R.optional(s.poseHeadingDegrees||void 0),posePitchDegrees:R.optional(s.posePitchDegrees||void 0),poseRollDegrees:R.optional(s.poseRollDegrees||void 0)};else{var c=a.photo;if(c&&c.cameraModel){var d=c.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(d)>=0&&(i={projectionType:"equirectangular"})}}}return i},t.prototype.getReputationProperties=function(e){for(var t={},n=0,a=l;n<a.length;n++){var i=a[n];t[i]=R.optional(e[i])}return t},t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&Y.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}},t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=W.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}},t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,a=e.itemUrlParts,i=e.isPowerPoint,r=e.itemFromServer,o=e.microServiceDataSource,s=e.mediaServiceFastMetadata,c=a.isCrossDomain;if(!c&&("21"===this._pageContext.webTemplate||Object(O.isFeatureEnabled)(O.EnableWrsPreviewOutsideODB))){var d,l,u,f=!c&&(t&&Object(O.isFeatureEnabled)(O.EnableWordWrsPreview)||i&&Object(O.isFeatureEnabled)(O.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:r,mediaServiceMetadata:s}):"",m=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:r,mediaServiceMetadata:s}),_=!1,h="",b=r[".ctag"],g=s&&s.officeBundle;return g&&(d=g.ctag,u=g.version,_=g.fatalError||!1,g.generationTime&&(l=new Date(g.generationTime)),h=g.errorInfo||""),{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:m,bundleCTag:d,bundleVersion:u,hasBundleGenerationFailed:_,bundleErrorInfo:h,generationTime:l,cTag:b,enableDefaultClick:f}}},t.prototype._getThumbnail=function(e){if(e.type!==y.e.Folder){var t=e.itemFromServer;if(Object(k.s)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===k.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(P.e)(e.extension)){if(this._listContext.remoteParentWeb){var a=new d.t(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(d.e.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(A.e.encodeURIComponent(a+i),this._pageContext.webAbsoluteUrl,this._pageContext)}var r=e.pageContext;return r&&r.webAbsoluteUrl&&r.siteId&&r.webId?s.previewImageUrlFromProps(r.siteId,r.webId,t.UniqueId,r.webAbsoluteUrl,r):s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}},t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};return t&&(n[o.t.video]=t),n},t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=e.microServiceDataSource,i=e.mediaServiceFastMetadata,r=this._getItemTypeOneNoteOrFolder(t);if(r===y.e.Unknown){var o=t.File_x0020_Type,s=o?".".concat(o):"";if(Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutFileType(o))return y.e.Shortcut;if(Object(O.isFeatureEnabled)(O.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:s,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:a})))return y.e.Media;if(this._get3dFacet({itemFromServer:t,extension:s,microServiceDataSource:a,mediaServiceFastMetadata:i}))return y.e.Media;if("audio"===u.t(s))return y.e.Media;if(i)return y.e.Media;if((r=u.a(s))===y.e.Unknown)return Object(k.o)(n)?y.e.File:Object(k.s)(n)?y.e.Media:r}return r||y.e.File},t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=y.e.Folder;else if("1"===e.FSObjType||e.RemoteItem){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],a=e["File_x0020_Type.mapapp"];t=a&&"onenote"===a.substring(0,7)||n&&-1!==n.indexOf("onenote")?y.e.OneNote:y.e.Folder}else t=y.e.Unknown;return t},t.prototype._convertToODNGroup=function(e){var t=this,n=e;return n.state=this.createObservable({isCollapsed:e.isCollapsed}),n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)})),n},t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;return"&"===e[1]&&(this._htmlDecodeDiv.innerHTML=e,t=this._htmlDecodeDiv.innerText),JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageContext:T.r,urlDataSource:M.v,listContext:T.a,navigation:F.e,microServiceDataSource:j.e,vroomUrlHelper:B.e,itemUrlHelper:N.o,vroomDataContext:U.optional,shortcutLinkDataSource:I.e}),t}(i.n);function te(e){return"number"==typeof e?e/1e4:e}var ne=Object(b.r)("ListItemBuilder",ee)},1974:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return A});var a=n(1),i=n(54),r=n(2057),o=n(72),s=n(178),c=n(62),d=n(742),l=n(802),u=n(64),f=n(121),p=n(50),m=n(1096),_=n(642),h=n(175),b=n(161),g=n(184),v=n(344),y=n(136),S=n(571),D=n(58),I=n(334),x=new(n(481).t)({name:"ShortcutUpdater.key",loader:new I.t(function(){return n.ee([7],3910).then(function(e){return e.resourceKey})})}),C=n(957),O=n(221),w=n(0),E=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._shortcutResolverQueue=new l.e,a._pageContext=n.pageContext,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._identityDataSource=n.identityDataSource,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"ShortcutLinkDataSource"}),a}return Object(a.__extends)(t,e),t.isSharePointUrl=function(e){var t=new u.t(e).getHost().toLowerCase();return t.indexOf("spoppe.com")>=0||t.indexOf("sharepoint.com")>=0||t.indexOf("sharepoint.cn")>=0},t.prototype.isInternal=function(e,t){if(t&&t!==o.e.Empty&&/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var n=new u.t(e).getHost().toLowerCase(),a=new u.t(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(n===a)return!0;var i=void 0,r=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(a);if(!r)return!1;if(void 0!==r[2])i=r[1]+r[3];else if(void 0!==r[3])i=r[1]+"-my"+r[3];else if(void 0!==r[4])return!1;return n===i},t.prototype.createShortcut=function(e,t,n){var a=this._itemUrlHelper.getItemUrlParts(e),i=this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetFolderByServerRelativePath",{decodedUrl:a.serverRelativeItemUrl}).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:i.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(n)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?d.n.wrapError(_.e.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?d.n.wrapError(_.e.ShortcutErrors.InvalidCharacterError):d.n.wrapError(_.e.ShortcutErrors.UnknownError)})},t.prototype.getShortcutTargetData=function(e){var n,a,i=this,r=e.url,c=e.avoidGetFileByUrlCall,l=e.parentKey,u=e.targetSiteUrl,f=d.n.resolve(void 0);if(u)n=new s.t({webAbsoluteUrl:u}).build(),f=this._getAuthTokenForSite(u),a=decodeURIComponent(r);else{var p=l?this._itemUrlHelper.getItemUrlParts(l):this._itemUrlHelper.getUrlParts({path:r});l&&p.isCrossDomain?(n=new s.t({webAbsoluteUrl:p.fullWebUrl}).build(),f=this._getAuthToken({parentKey:l})):n=this._apiUrlHelper.build(),a=p.fullItemUrl}return n=n.method("SP.Utilities.ShortcutLink.GetShortcutLink",a),f.then(function(e){return i._dataRequestor.getData({url:n.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0,authToken:e}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==o.e.Empty?e.d.siteId:null,webId:e.d.webId!==o.e.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==o.e.Empty?e.d.uniqueId:null,isInternal:i.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(e){return e.uniqueId||c?d.n.wrap(e):t.isSharePointUrl(e.url)?i.getFileByUrl(e.url).then(function(t){var n=!!t&&t.UniqueId&&o.e.normalizeLower(t.UniqueId);return n&&(e.uniqueId=n),e}):d.n.wrap(e)})})},t.prototype.generateShortcutsOpenUrl=function(e,t,n,a,i,r){if(a&&i&&r&&-1===n.toLowerCase().indexOf("guestaccess.aspx")){var o="",s="?";if(n){var c=n.indexOf("?");-1!==c&&(s=n.substring(c)+"&")}return o=e+"/"+t+"/ShortcutLink.aspx",o+=s+"siteid="+f.e.encodeURIComponent(a),(o+="&webid="+f.e.encodeURIComponent(i))+"&uniqueid="+f.e.encodeURIComponent(r)}return n},t.prototype.enqueueParseShortcut=function(e,t){var n=this,a=this._itemUrlHelper.getItemUrlParts(e);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var i=new(n.managed(h.default));return n.getShortcutTargetData({url:a.fullItemUrl,avoidGetFileByUrlCall:!0,parentKey:e}).then(function(a){var r,o=n.generateShortcutsOpenUrl(n._pageContext.webAbsoluteUrl,n._pageContext.layoutsUrl,a.url,a.siteId,a.webId,a.uniqueId),s={key:e,shortcutInfo:{shortcutLinkRewritten:!0},urls:(r={},r[g.t.shortcutTarget]=o,r)};a.uniqueId&&(s.thumbnail=m.previewImageUrl(a,n._pageContext.webAbsoluteUrl,n._pageContext)),i.update([new b.e(e).succeed({item:s})]),i.flush(),n.resources.consume(C.t)&&t&&n.resources.consumeAsync(x).then(function(n){n.updateItemShortcutValues(e,t,a)})}).then(function(){i.dispose()},function(e){return i.dispose(),d.n.wrapError(e)})}))},t.prototype.getFileByUrl=function(e){var t,n=this,a=this._itemUrlHelper.getUrlParts({path:e});if(a.isCrossDomain||a.siteRelation===y.e.sameSite)t=d.n.wrap(e);else if(!w.e.isActivated("F7992BA7-BA5A-4B76-B0E7-2E3755D6201A")&&a.fullWebUrl)t=d.n.resolve(a.fullWebUrl);else{var i=this._apiUrlHelper.contextInfoUrl(a.fullItemUrl);t=this._dataRequestor.getData({url:i,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return t.then(function(t){var a=n._apiUrlHelper.build().webByUrl({path:t,webUrl:t}).method("GetFileByUrl",e);return n._dataRequestor.getData({url:a.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(t){return n._parseGetFileResponse(t,e)})})},t.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"},t.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:!!e.d.Exists,IrmEnabled:!!e.d.IrmEnabled,Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new p.e(t).authority,TimeCreated:Object(r.t)(e.d.TimeCreated),TimeLastModified:Object(r.t)(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}},t.prototype._getAuthToken=function(e){var t=d.n.resolve(void 0),n=this._itemUrlHelper.getItemUrlParts(e.parentKey);return n&&n.fullWebUrl&&n.isCrossDomain&&(t=this._identityDataSource.getSharePointToken(new p.e(n.fullItemUrl).authority).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})),t},t.prototype._getAuthTokenForSite=function(e){return this._identityDataSource.getSharePointToken(e).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageContext:D.r,apiUrlHelper:v.e,itemUrlHelper:y.o,dataRequestorType:S.e,identityDataSource:O.resourceKey}),t}(i.n),A=(t.default=E,Object(I.r)("ShortcutLinkDataSource",E))},2127:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(9);function i(){return Object(a.yo)(a.ir)}n(17)},2972:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n(487),r=function(){function e(){}return e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.initSimplePerfDashboard=function(t){e._perfDashboardOpen||(e._markPerfDashboardOpen(!0),n.ee([205],2385).then(function(n){n.show(t,e._markPerfDashboardOpen)}))},e.isInitialized=function(){return e._initialized},e.init=function(t){e._initialized||Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.ee([42],3018)];case 1:return i=a.sent().default,e._initialized||(e._initialized=!0,i.init(t)),[2]}})})},e.enableAutoOpen=function(e){},e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t},e.AutoOpenSessionKey="DebugWindow_AutoOpen",e}();t.default=r},4004:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return F});var a,i=n(1),r=n(56),o=n(0),s=n(85),c=n(481),d=n(334),l=n(179),u=n(206),f=function(){var e,t,n;return a||(a=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t)),a},p=function(e,t){var n,a,i=t||_(),r=e||h().activeScopeId;try{for(var o=Object(u.i)(i||[]),s=o.next();!s.done;s=o.next()){var c=s.value;if(c.id===r)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},m=function(e,t){var n;t&&(a=t);var i=f();i&&i.setProps({hostAppInfo:Object(u.e)(Object(u.e)({},i.props.hostAppInfo),{scopeId:null===(n=p(e.activeScopeId,e.scopes))||void 0===n?void 0:n.searchBoxScopeId}),scopingControl:Object(u.e)({},e)})},_=function(){var e;return null===(e=h())||void 0===e?void 0:e.scopes},h=function(){var e;return null===(e=f())||void 0===e?void 0:e.props.scopingControl},b=n(16),g=n(919),v=new c.t("scopingControlDataSource"),y=n(1355),S=n(409),D=(n(17),n(1423)),I={id:"spListFolder",name:D.t},x={id:"spList",name:D.r},C={id:"spDocLibFolder",name:D.t},O={id:"spDocLib",name:D.i};D.o,D.a,D.e,D.n,D.h;var w,E=n(435),A=n(9),L=n(6),k=n(19),M=n(529),P=n(2980),T="AdvancedSearchButton",U=function(){function e(e,t){this._isConfigured=!1,this._resources=t.resources,this._engagement=t.engagement,this._searchBoxDataSource=t.searchBoxDataSource,this._config=t.searchBoxConfig,this._scope=new l.e,this._getViewParams=function(){throw new Error("Search box not configured")},this._isLastPageSearch=!1,this._searchInstrumenter=this._config.getInstrumenter(),this._scopingControlDataSource=t.scopingControlDataSource,this._metadataSearchDataSource=t.metadataSearchDataSource,this._bootOptions=t.bootOptions,this._teachingBubbleProvider=t.teachingBubbleProvider,this._shouldLogContentQueryFREDismissed=!o.t.isActivated("A9535421-FA61-46CA-BC67-46B656FE5319","05/24/2023","add logs for unintentional teaching bubble dismiss")}return e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new s.e({name:"SuiteNavSearchBox.Configure"});this._getViewParams=e,this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage(),this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var a,r,c,d,l=e.Search;Object(A.yo)(A.fa)&&!(null===(a=t._metadataSearchDataSource)||void 0===a?void 0:a.isMetadataSearchResultPage(t._getViewParams()))||l.SetSearchText(t._config.getSearchText()),l.SetPlaceholderText(t._config.getPlaceholderText()),l.SetTokenProviders(t._searchBoxDataSource.getTokenProviders());var u=l.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),f=l.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),p=l.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(u,l.RemoveOnSubmitSearch),t._trackHandler(f,l.RemoveOnSearchBoxActivated),t._trackHandler(p,l.RemoveOnSearchBoxDeactivated);var m,_=l.OnExitSearch(t._onExitSearchCallback.bind(t));t._trackHandler(_,l.RemoveOnExitSearch),t._searchBoxDataSource.getProviderConfigUpdaters&&l.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters(null===(r=t._scopingControlDataSource)||void 0===r?void 0:r.getActiveScope.bind(t._scopingControlDataSource),t._getViewParams)),t._shouldDisableSetSearchBoxSettingsInChromeless()&&(null===(c=t._bootOptions)||void 0===c?void 0:c.chromeless)&&!(null===(d=t._bootOptions)||void 0===d?void 0:d.isListHome)&&!t.shouldSetSearchBoxSettings(l)||l.SetSearchBoxSettings(Object(i.__assign)({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()},o.t.isActivated("8852ae00-f7e0-4a74-bf2e-f5f33e61fde7","09/30/2020","[stvikenv] Specify search box loading pattern in SetSearchBoxSettings in odsp-next.")?{}:{loadingPattern:(w||(w=L.n.isFeatureEnabled({ODB:1804})||(m=window._spPageContextInfo)&&!o.e.isActivated("1166a987-eb1e-4f42-baf6-46d50b7fc0c4","09/30/2020","[stvikenv] Activate this kill switch to pause experiment 90065 - using the PFP loading pattern in the search box.")&&1===Object(k.n)(90065,m)?"pfp":"eager"),w)})),t._updateSearchInstrumenter(),n.end({resultType:s.t.Success})})}).catch(function(e){n.end({resultType:s.t.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:s.t.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})}),this._updateSearchInstrumenter(),this._isConfigured=!0}},e.prototype.updateSearchBoxConfiguration=function(e,t){var n,a,i,c,d;null===(a=(n=this._searchBoxDataSource).setIsPrimedLibrary)||void 0===a||a.call(n,t),!o.t.isActivated("aa2a6471-d9a3-4277-8151-55fd6b5b4b27","11/18/2022","set isGenericList")&&e&&(null===(c=(i=this._searchBoxDataSource).setIsGenericList)||void 0===c||c.call(i,Object(r.o)(e))),this._listTemplate=e,this._isMetadataSearchSupported=this._isMetadataSearchSupportedTemplate(this._listTemplate);var l=new s.e({name:"SuiteNavSearchBox.UpdateSearchBoxConfiguration"});if(this._isConfigured)try{this._resetSearchBoxText(),this._updateSearchInstrumenter(),l.end({resultType:s.t.Success})}catch(e){l.end({resultType:s.t.Failure,error:e,resultCode:"RuntimeError"})}else l.end({resultType:s.t.Failure,resultCode:"SearchBoxNotInitialized"});var u=null===(d=this._removeTeachingBubble)||void 0===d?void 0:d.call(this);this._logTeachingBubbleDismissEngagment(!1,u)},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._shouldDisableSetSearchBoxSettingsInChromeless=function(){return!o.t.isActivated("4385e4cc-3ff4-4707-a6b7-ca36740100a0","2020/11/12","Disable SetSearchBoxSettings when chromeless")},e.prototype._isMetadataSearchSupportedTemplate=function(e){var t;if(!this._metadataSearchDataSource)return!1;var n=!!e&&!Object(r.o)(e);return Object(A.yo)(A.g)?(n=!0,this._metadataSearchDataSource.isList=!!e&&Object(r.o)(e)):n=n||(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.isMetadataSearchResultPage(this._getViewParams())),n},e.prototype.shouldSetSearchBoxSettings=function(e){var t=e.GetSearchBoxSettings();return!(null==t?void 0:t.instrumenter)},e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})},e.prototype._resetSearchBoxText=function(e){var t=this,n=this._searchBoxDataSource.isSearchResultsPage(),a=Object(A.yo)(A.fa);this._config.isEnabled()&&this._runInShellSearch(function(e){(!a||n||t._isLastPageSearch)&&e.SetSearchText(t._config.getSearchText()),e.SetPlaceholderText(t._config.getPlaceholderText()),t._isLastPageSearch=n})},e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})},e.prototype._onSubmitSearchCallback=function(e,t,n){var a,i,r,o=this._getViewParams();this._searchBoxDataSource.isSearchResultsPage()||(this._viewParamsBeforeSearch=o,this._urlBeforeSearch=window.location.href),this._isScopeControlSupported()&&(r=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage()),i=this._scopingControlDataSource.getActiveScope()),this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0,extraData:{trigger:n?"ScopingControl":"SubmitSearch",targetScope:null==i?void 0:i.id},scenario:r,privacyClassification:b.t.optionalDiagnostic}),this._searchBoxDataSource.onSubmitSearchCallback(e,this._getViewParams,null===(a=this._scopingControlDataSource)||void 0===a?void 0:a.getActiveScope(),this._urlBeforeSearch,n),this._endQos("Click")},e.prototype._onExitMetadataSearchCallback=function(){var e,t,n=this;if(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode){this._metadataSearchDataSource.isMetadataSearchMode=!1;var a=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource);this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(a,n._getViewParams)),n._updateSearchInstrumenter()})}},e.prototype._onExitSearchCallback=function(){this._searchBoxDataSource.onExitSearchCallback&&(this._searchBoxDataSource.isSearchResultsPage()&&(this._engagement.logData({name:"SuiteNavSearchBox.ExitSearch",isIntentional:!0}),this._searchBoxDataSource.onExitSearchCallback(this._viewParamsBeforeSearch)),this._onExitMetadataSearchCallback())},e.prototype._onSearchBoxActivatedCallback=function(){var e,t,n,a,i,r,s;!o.t.isActivated("5c0f5dc3-91a3-4147-9c7c-e846afa940a7","01/24/2024","add warmupSubstrateSearchContextOptions to search instrumentation")&&(null===(t=(e=this._config).removeWarmupSetup)||void 0===t?void 0:t.call(e))&&this._updateSearchInstrumenter(),this._isScopeControlSupported()&&(s=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage())),this._engagement.logData({name:"SuiteNavSearchBox.FocusIn",isIntentional:!0,scenario:s,privacyClassification:b.t.optionalDiagnostic,extraData:{isMetadataSearchAvailable:!!this._metadataSearchDataSource}}),this._startQos(),(null===(n=this._metadataSearchDataSource)||void 0===n?void 0:n.isQueryableListColumnsSupported())&&(null===(a=this._metadataSearchDataSource)||void 0===a?void 0:a.shouldLoadCustomQueryableListColumns())||null===(i=this._metadataSearchDataSource)||void 0===i||i.getSiteColumns(),Object(A.yo)(A._)&&(null===(r=this._metadataSearchDataSource)||void 0===r?void 0:r.shouldShowDiscoveryFRE())&&this._runContentQueryDiscoveryFRE()},e.prototype._runContentQueryDiscoveryFRE=function(){var e=this,t=document.querySelector("#".concat(T));this._metadataSearchDataSource&&t&&n.ee(17,1897).then(function(a){var i=!!e._shouldLogContentQueryFREDismissed||void 0;e._teachingBubbleProvider.shouldBubbleBeAdded(a.DISCOVERY_TEACHING_BUBBLE_CAMPAIGN,!1).then(function(r){r?n.ee([632,"ondemand.resx-ondemand"],4074).then(function(n){n.showContentQueryDiscoveryTeachingBubble(t,function(){o.t.isActivated("EB47E8AD-F922-4EAD-A345-1BD51CC67383","04/14/2023","do not show second attack FRE if user 'Try it now'")||e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN),e._openMetadataSearchForm(),e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_TRYITNOW_ENGAGEMENT,isIntentional:i})},function(){e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_MAYBELATER_ENGAGEMENT,isIntentional:i})}),e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_CAMPAIGN),e._removeTeachingBubble=n.removeMetadataSearchTeachingBubble,e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_SHOWN_ENGAGEMENT,isIntentional:i})}):a.shouldShowSecondaryDiscoveryTeachingBubble()&&e._teachingBubbleProvider.shouldBubbleBeAdded(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN,!1).then(function(r){r&&n.ee(8,3906).then(function(n){n.runContentQueryDiscoverySecondaryTeachingBubble(t,function(){e._engagement.logData({name:a.DISCOVERY_SECONDARY_TEACHING_BUBBLE_DISMISSED_ENGAGEMENT,isIntentional:i})}),e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN),e._removeTeachingBubble=n.removeMetadataSearchTeachingBubble,e._engagement.logData({name:a.DISCOVERY_SECONDARY_TEACHING_BUBBLE_SHOWN_ENGAGEMENT,isIntentional:i})})})})})},e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut",isIntentional:!0,privacyClassification:b.t.optionalDiagnostic}),this._endQos("FocusOut")},e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:s.t.Failure}),this._currentQosEvent=new s.e({name:"SuiteNavSearchBox.Usage"})},e.prototype._endQos=function(e){this._currentQosEvent&&(this._currentQosEvent.end({resultType:s.t.Success,resultCode:e}),this._currentQosEvent=void 0)},e.prototype._updateSearchInstrumenter=function(){if(this._triggerSearchBoxReconfiguration(),this._isScopeControlSupported()){m(this._getScopingControlConfig(),this._searchInstrumenter);var e=this._scopingControlDataSource.getInitialScope();this._scopingControlDataSource.setActiveScope(e)}this._setSearchInstrumenterProps(),this._configureMetadataSearch()},e.prototype._isScopeControlSupported=function(){return!!this._scopingControlDataSource&&this._scopingControlDataSource.isScopingControlEnabled()},e.prototype._isMetadataSearchSupportedScope=function(e){var t=e||O,n=t===O||t===C,a=t===x||t===I;return Object(A.yo)(A.g)?n||a:n},e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._scopingControlDataSource.getAvailableScopes(),activeScopeId:this._scopingControlDataSource.getInitialScope().id,onChange:function(t,n){e._scopingControlDataSource.setActiveScope(n),e._triggerSearchBoxReconfiguration();var a=!!t&&e._searchBoxDataSource.isSearchResultsPage();e._logScopeChange(n,a),a?e._onSubmitSearchCallback(t,void 0,!0):e._setFocusSearchBox(),e._metadataSearchDataSource&&e._updateMetadataSearchConfiguration()}}},e.prototype._hideScopingControl=function(){this._searchInstrumenter.setProps({scopingControl:Object(i.__assign)(Object(i.__assign)({},this._searchInstrumenter.props.scopingControl),{activeScopeId:void 0,scopes:void 0})})},e.prototype._configureMetadataSearch=function(){var e=this;this._metadataSearchDataSource&&(this._metadataSearchDataSource.updateMetadataSearchConfig=function(t){e._metadataSearchDataSource.isMetadataSearchMode=e._metadataSearchDataSource.isMetadataSearchResultPage(e._getViewParams())||t,e._updateMetadataSearchConfiguration(),e._metadataSearchDataSource.isMetadataSearchMode?t&&e._setFocusSearchBox():e._isScopeControlSupported()&&m(e._getScopingControlConfig(),e._searchInstrumenter)},this._metadataSearchDataSource.isMetadataSearchMode=this._metadataSearchDataSource.isMetadataSearchResultPage(this._getViewParams()),this._updateMetadataSearchConfiguration())},e.prototype._hideMetadataSearchButton=function(){var e;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:void 0})},e.prototype._showMetadataSearchButton=function(){var e,t=this;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:{id:T,onClick:function(e){var n,a,i,r,o=e||window.event;if(o){if(o.preventDefault(),t._teachingBubbleProvider&&!Object(A.yo)(A._))t._showMetadataSearchTeachingBubble(o);else{var s=null===(n=t._removeTeachingBubble)||void 0===n?void 0:n.call(t);t._onUnmountDiscoveryTeachingBubble(s),t._openMetadataSearchForm(o.type)}(null===(a=t._metadataSearchDataSource)||void 0===a?void 0:a.isQueryableListColumnsSupported())&&(null===(i=t._metadataSearchDataSource)||void 0===i||i.enableQueryableListColumns())}else null===(r=t._removeTeachingBubble)||void 0===r||r.call(t),t._openMetadataSearchForm()},ariaLabel:D.c,title:D.c}})},e.prototype._onUnmountDiscoveryTeachingBubble=function(e){var t=this;this._logTeachingBubbleDismissEngagment(!1,e,{isSearchFormOpenened:!0}),o.t.isActivated("AB505D1C-57C3-45D2-8065-4F7D2E8D6B2F","05/24/2023","do not show second attack if user has open search form")||n.ee(17,1897).then(function(n){var a;e===n.DISCOVERY_TEACHING_BUBBLE&&(null===(a=t._teachingBubbleProvider)||void 0===a||a.markBubbleAsSeen(n.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN))})},e.prototype._logTeachingBubbleDismissEngagment=function(e,t,n){this._shouldLogContentQueryFREDismissed&&t&&this._engagement.logData({name:"ContentQuery.Form.".concat(t,".Dismissed"),extraData:n,isIntentional:e})},e.prototype._showMetadataSearchTeachingBubble=function(e){var t=this,a=e.target,i=e.type;n.ee(8,3906).then(function(e){var n={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:{Fallback:!0}},r=new s.e({name:"SearchBox.ShowMetadataSearchTeachingBubble"});t._teachingBubbleProvider.shouldBubbleBeAdded(n,!1).then(function(o){if(o){var c={isVisible:o,onDismiss:function(){t._teachingBubbleProvider.markBubbleAsDismissed(n),t._openMetadataSearchForm(i)},target:a,listTemplate:t._listTemplate};e.showMetadataSearchTeachingBubble(c),t._teachingBubbleProvider.markBubbleAsSeen(n),r.end({resultType:s.t.Success})}else e.removeMetadataSearchTeachingBubble(),t._openMetadataSearchForm(i),r.end({resultType:s.t.Success,resultCode:"AlreadyShowed"})}).catch(function(n){e.removeMetadataSearchTeachingBubble(),t._openMetadataSearchForm(i),r.end({resultType:s.t.Failure,error:n.message})})}).catch(function(){t._openMetadataSearchForm(i)})},e.prototype._openMetadataSearchForm=function(e){var t,n,a=this;if(this._metadataSearchDataSource&&(this._metadataSearchDataSource.isMetadataSearchMode=!0,this._updateMetadataSearchConfiguration(),this._setFocusSearchBox(),"keydown"===e&&setTimeout(function(){return a._setFocusSearchBox()},0),void 0===this._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble&&Object(A.yo)(A._)&&(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.shouldShowDiscoveryFRE())))if(o.t.isActivated("5426BA38-F699-47BF-9782-5AED17CB1B8A","04/14/2023","do not show queryable teaching bubble")){var i={campaignGuid:"6f376cef-52b4-4abc-b6e9-aca8686e5220",flag:{Fallback:!0},isDismissable:!0};null===(n=this._teachingBubbleProvider)||void 0===n||n.shouldBubbleBeAdded(i,!1).then(function(e){a._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=e,a._metadataSearchDataSource.markQueryableFieldMenuTeachingBubbleAsSeen=function(){var e;null===(e=a._teachingBubbleProvider)||void 0===e||e.markBubbleAsSeen(i),a._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=!1}})}else this._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=!1},e.prototype._updateMetadataSearchConfiguration=function(){var e,t,n=this,a=null===(e=this._scopingControlDataSource)||void 0===e?void 0:e.getActiveScope(),i=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource),r=this._isMetadataSearchSupportedScope(a),o=this._isMetadataSearchSupported&&r;this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(i,n._getViewParams))}),o?this._metadataSearchDataSource.isMetadataSearchMode?(this._hideScopingControl(),this._hideMetadataSearchButton()):this._searchBoxDataSource.isSearchResultsPage()?this._hideMetadataSearchButton():this._showMetadataSearchButton():this._hideMetadataSearchButton()},e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox()})})},e.prototype._setSearchInstrumenterProps=function(){this._searchBoxDataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._searchBoxDataSource.getSearchInstrumenterProps())},e.prototype._triggerSearchBoxReconfiguration=function(){this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})},e.prototype._logScopeChange=function(e,t){if(!this._scopingControlDataSource)throw new Error("Scoping control is not supported.");var n=this._scopingControlDataSource.getInitialScope(),a=this._scopingControlDataSource.getScopeControlScenario(n,this._searchBoxDataSource.isSearchResultsPage());this._engagement.logData({name:"SuiteNavSearchBox.ScopeChanged",isIntentional:!0,scenario:a,extraData:{initialScope:n.id,targetScope:e.id,searchTriggered:t},privacyClassification:b.t.optionalDiagnostic})},e.dependencies={resources:c.r,engagement:E.e,searchBoxDataSource:y.e,searchBoxConfig:g.e,scopingControlDataSource:v.optional,metadataSearchDataSource:P.e.optional,bootOptions:M.e.optional,teachingBubbleProvider:S.s.optional},e}(),F=(t.default=U,Object(d.r)("SearchBoxProvider",U))},4025:function(e,t,n){"use strict";n.r(t),n.d(t,"SuiteNavDataUpdater",function(){return k}),n.d(t,"resourceKey",function(){return M});var a=n(1),i=n(2978),r=n(1064),o=n(2744),s=n(17),c=n(878),d=n(334),l=n(481),u=n(58),f=n(56),p=n(130),m=n(0),_=n(162),h=n(4),b=n(2),g=n(452),v=n(249),y=n(124),S=n(1360),D=n(2977),I=n(1249),x=n(914),C=n(99),O=(new l.t("hasExposedSuiteNavResources"),new l.t("hasExposedSuiteNavDeferredResources"),new l.t("suiteNavContext"),new l.t("suiteNavCapabilities"),new l.t("suiteNavSyncActionCallback")),w=new l.t({name:"isSyncButtonInSuiteNavEnabled.key",factory:new l.e(function(){return!1})}),E=Object(h.isFeatureEnabled)(h.DocumentSettingPanel),A=m.e.isActivated("55d7c666-d509-4231-9bd7-fd3e8f76384d","05/25/2022","Use unique link id for list settings"),L=!m.e.isActivated("7D7A934E-3754-4737-9B67-CBDE6311CC78","01/04/2023","Use a direct link to go to downloads page instead of using the navigation resource"),k=function(){function e(e,t){this._resources=t.resources,this._pageContext=this._resources?this._resources.consume(u.r):t.pageContext}return e.prototype.updateSuiteNavData=function(e){var t,o=this,c=Object(a.__assign)({},e.suiteNavData);this._suiteNavContext=e.suiteNavContext;var d=this._pageContext.isSPO;this._isODB=Number(this._pageContext.webTemplate)===_.t.mySite,c.CurrentMainLinkElementID=this._suiteNavContext.currentMainLinkElementID||this._suiteNavContext.workloadId,c.ActionsMap={};var l=this._resources?this._resources.consume(S.e.optional):void 0;l&&l.set(!!c.AdminLink);var u=this._resources?this._resources.consume(S.t.optional):void 0;if(u)for(var p=0,h=Object(a.__spreadArray)(Object(a.__spreadArray)([],c.AppsLinks||[],!0),c.WorkloadLinks||[],!0);p<h.length;p++){var b=h[p];if("ShellSites"===b.Id){u.set(b.Url||"");break}}if(d&&this._pageContext.isAnonymousGuestUser)try{var g={Text:this._pageContext.userDisplayName||c.UserDisplayName||"",Url:null},C=JSON.parse(c.ClientData);C.SignInLink=g,c.ClientData=JSON.stringify(C),c.SignOutLink=null,c.AboutMeLink=null,c.IsAuthenticated=!1,c.O365SettingsLink=null,c.UserDisplayName=null}catch(e){}else{if(c.ActionsMap[r.e.SIGN_OUT]=function(){v.e.logData({name:"SuiteNav.SignOut.Click"});try{delete localStorage["onedrive.autoredirect"]}catch(e){}return!0},d&&this._pageContext.isEmailAuthenticationGuestUser)c.CurrentWorkloadSettingsSubLinks=null,c.LogoNavigationUrl=null;else if(!m.e.isActivated("f8d47155-9b9a-4663-9477-800f8da227fa","02/11/2022","Remove links from Stream settings")&&(m.e.isActivated("a7eb44e0-dbbe-46e1-8c95-88cdab4c07d4","04/29/2022","Use SuiteNavLinkId to identify Stream")?(null===(t=this._pageContext.serverRequestPath)||void 0===t?void 0:t.indexOf("stream.aspx"))>=0:c.CurrentMainLinkElementID===r.e.STREAM))c.CurrentWorkloadSettingsSubLinks=null;else{var O=this._pageContext.listBaseType?Object(f.a)(this._pageContext.listBaseType):Object(f.i)(this._pageContext.listBaseTemplate);E&&(c.ActionsMap[r.e.LIBRARY_SETTINGS]=function(e){var t=e.resources.consume(y.e);return new(e.resources.injected(t.LaunchDocLibSettingPanelAction))({panelHeaderText:D.e,isEditSettingPanel:E,settingPanelProps:{classicSettingLink:o._getDocLibSettingLink()}}).execute(null),!1}),c.CurrentWorkloadSettingsSubLinks=this._getSettingsLinks(O)}if(this._isSiteInformationLinkEnabled()&&(c.ActionsMap[r.e.SITE_INFORMATION]=function(e){return Object(I.e)(e.resources,function(e){return e.LaunchSiteSettingsPanelAction}),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteSettings=function(){Object(I.e)(o._resources,function(e){return e.LaunchSiteSettingsPanelAction})})),this._isHubSettingsLinkEnabled()&&(c.ActionsMap[r.e.HUB_SETTINGS]=function(e){return Object(I.e)(e.resources,function(e){return e.LaunchHubSettingsPanelAction}),!1},this._pageContext.isHubSite&&window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchHubSettings=function(){Object(I.e)(o._resources,function(e){return e.LaunchHubSettingsPanelAction})})),this._isChangeTheLookLinkEnabled()&&(c.ActionsMap[r.e.CHANGE_THE_LOOK]=function(e){return Object(I.e)(e.resources,function(e){return e.LaunchChangeTheLookPanelAction}),!1}),this._isSitePermissionsLinkEnabled()&&(c.ActionsMap[r.e.SITE_PERMISSIONS]=function(e){return Object(I.e)(e.resources,function(e){return e.LaunchSitePermissionsPanelAction}),!1}),this._isSiteDesignsLinkEnabled()){var w=function(){Promise.resolve(n.ee([26],4012)).then(x.e).then(function(e){e.SiteScriptProgressStateManager.getInstance({pageContext:o._pageContext}).triggerOpenPanelAction()})};c.ActionsMap[r.e.SITE_DESIGNS]=function(e){return w(),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteDesignProgress=w)}this._shouldShowGroupifyLink()&&(c.ActionsMap.Groupify=function(e){return Object(I.e)(e.resources,function(e){return e.LaunchGroupifyPanelAction}),!1}),this._isGlobalNavSettingsPanelEnabled()&&(c.ActionsMap.GLOBALNAV_SETTINGS_SUITENAVID=function(e){return Object(I.e)(e.resources,function(e){return e.LaunchGlobalNavSettingsPanelAction}),!1}),this._isWebTemplatesGalleryEnabled()&&(c.ActionsMap.SuiteMenu_MenuItem_WebTempaltesGallery=function(e){var t;return v.e.logData({name:"SiteTemplates.Panel.Click",webTemplateId:null===(t=o._pageContext)||void 0===t?void 0:t.webTemplate}),Object(I.e)(e.resources,function(e){return e.LaunchWebTemplatesGalleryAction}),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchWebTemplatesGallery=function(){Object(I.e)(o._resources,function(e){return e.LaunchWebTemplatesGalleryAction})})),this._isVivaConnectionsSettingsLinkEnabled()&&(c.ActionsMap[r.e.VIVA_CONNECTIONS]=function(e){var t=e.resources.consume(y.e);return new(e.resources.injected(t.LaunchVivaConnectionsSettingsPanelAction))({}).execute(null),!1}),!c.SignOutLink&&d||(c.SignOutLink.Url=Object(s.n)(this._pageContext)+"/_layouts/15/SignOut.aspx",c.SignOutLink.Text||(c.SignOutLink.Text=i._)),c.UserDisplayName=this._pageContext.userDisplayName||c.UserDisplayName||this._pageContext.webTitle||null}if(c.FeedbackLink=null,this._suiteNavContext.firstRunScenarioType&&(c.CurrentWorkloadHelpSubLinks=[{Id:r.e.FIRSTRUN,Text:i.m,Url:"#"}],c.ActionsMap[r.e.FIRSTRUN]=function(e){return Object(I.e)(e.resources,function(e){return e.InvokeFirstRunExperienceAction}),!1}),d||(c.StringsOverride=c.StringsOverride||{},c.StringsOverride.l_ShellCore_O365_Text="SharePoint"),this._suiteNavContext.helpNamespace&&this._suiteNavContext.helpId?c.HelpLink.Url="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=".concat(this._suiteNavContext.helpNamespace,"&clid=").concat(this._pageContext.currentLanguage,"&ver=").concat(d?"16":"19","&HelpId=").concat(this._suiteNavContext.helpId):c.HelpLink.Url="https://support.microsoft.com",!d){if(c.HelpLink){var A=this._suiteNavContext.helpIdOnPrem||"WSSEndUser",L=this._pageContext.currentLanguage;c.HelpLink.Url="https://support.office.com/client/results?helpid=".concat(A,"&NS=").concat("WSSEndUser","&lcid=").concat(L,"&SYSLCID=").concat(L,"&UILCID=").concat(L,"&Version=19")}c.ActionsMap[r.e.HELP]=function(){var e=window.open("","_blank","resizable=1,location=0,width=400,height=500");return e.opener=null,e.location.href=c.HelpLink.Url,!1}}c.HelpLink.Text||(c.HelpLink.Text=i.o);var k=Number(this._pageContext.webTemplate),M=k===_.t.mySite||k===_.t.mySiteHost;return c.UseSPOBehaviors=!M,c},e.prototype._getDocLibSettingLink=function(){return this._pageContext.webAbsoluteUrl+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId)},e.prototype._getSettingsLinks=function(e){var t,s=this,c=this._pageContext.webAbsoluteUrl,d=f.t.documentLibrary===Number(this._pageContext.listBaseTemplate),l=[];if(t=e&&E?{Id:r.e.LIBRARY_SETTINGS,Text:i.c,Url:"#",Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[p.e.manageLists]}:{Id:A?r.e.LIBRARY_SETTINGS:r.e.LIST_SETTINGS,Text:e?i.c:i.d,Url:c+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId),Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[p.e.manageLists]},this._suiteNavContext.currentMainLinkElementID===r.e.LISTS){var u={Id:r.e.LIBRARY_SETTINGS,Text:i.u,Url:c+"/_layouts/15/"+(this._pageContext.isSiteAdmin?"AdminRecycleBin.aspx":"RecycleBin.aspx")+"?view=5&env=WebViewList"};return l.push(u),Object(g.n)(this._pageContext)&&l.push(t),l}if(this._suiteNavContext.showMySiteSettings||this._suiteNavContext.showTrimmedSettings){var _=this._pageContext.listPermsMask||p.e.fullMask,y=this._pageContext.webPermMasks,S=!1,D=this._pageContext.MenuData&&this._pageContext.MenuData.SettingsData;if(D&&!this._isODB){for(var I=this._suiteNavContext.showTrimmedSettings&&!t.Hidden&&p.e.hasAny(_,t.ListPermissions),x=function(e){return{Id:e.Id,Text:e.Text,Url:e.Url}},k=0,M=D;k<M.length;k++){var P=M[k];P?(S&&(l.push(null),S=!1),P.Id===t.Id?I=!1:I&&P.Id===r.e.SITE_SETTINGS&&(l.push(x(t)),I=!1),l.push(x(P))):S=!0}I&&l.push(x(t)),Object(h.isFeatureEnabled)(h.ShowSharepointRestoreLink)&&this._pageContext.isSiteAdmin&&d&&l.push(x({Id:"Document_Library_Restore",Text:i.f,Url:"?p=18"}))}else for(var T=0,U=[{Id:r.e.ADD_APP,Text:i.e,Url:c+"/_layouts/15/addanapp.aspx",IsMySiteSettingLink:!0,WebPermissions:[p.e.manageLists,p.e.manageSubwebs],Hidden:this._isODB},{Id:r.e.SITE_CONTENTS,Text:i.b,Url:c+"/_layouts/15/viewlsts.aspx",IsMySiteSettingLink:!0,WebPermissions:[p.e.viewFormPages],Hidden:this._isODB},null,t,{Id:r.e.SITE_SETTINGS,Text:i.S,Url:c+"/_layouts/15/settings.aspx",IsMySiteSettingLink:!0,WebPermissions:o.e.siteSettingsPermissions.concat(),Hidden:this._isODB}];T<U.length;T++){var F=U[T];S=S||!F,F&&!F.Hidden&&(this._suiteNavContext.showMySiteSettings?F.IsMySiteSettingLink:p.e.hasAny(y,F.WebPermissions)||p.e.hasAny(_,F.ListPermissions))&&(S&&(l.push(null),S=!1),l.push({Id:F.Id,Text:F.Text,Url:F.Url}))}}if(this._isGlobalNavSettingsPanelEnabled()&&l.push({Id:"GLOBALNAV_SETTINGS_SUITENAVID",Text:i.i,Url:"#"}),this._isHubSettingsLinkEnabled()&&l.push({Id:r.e.HUB_SETTINGS,Text:i.s,Url:"#"}),this._isSiteInformationLinkEnabled()&&(l=l.filter(function(e){return!e||e.Id!==r.e.SITE_SETTINGS})).push({Id:r.e.SITE_INFORMATION,Text:i.g,Url:"#"}),this._isSitePermissionsLinkEnabled()&&l.push({Id:r.e.SITE_PERMISSIONS,Text:i.v,Url:"#"}),this._isWebTemplatesGalleryEnabled()&&l.push({Id:"SuiteMenu_MenuItem_WebTempaltesGallery",Text:i.D,Url:"#"}),this._isODB){if(this._pageContext.isSiteAdmin&&(Object(h.isFeatureEnabled)(h.OneDriveSettings)&&l.push({Id:"OneDrive_Settings",Text:i.l,Url:c+"/_layouts/15/onedrive.aspx?p=22"}),l.push({Id:"OneDrive_Restore",Text:i.p,Url:c+"/_layouts/15/onedrive.aspx?p=18"})),l.push({Id:"GetOneDriveApps",Text:i.a,Action:function(){return Object(a.__awaiter)(s,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){return e=this._resources.consume(C.e),v.e.logData({name:"SuiteNav.GetOneDriveApps.Click"}),L||e.navigateTo({url:"https://www.onedrive.com/download",frameId:"_blank"}),[2]})})},Url:L?"https://www.onedrive.com/download":void 0,TargetWindow:L?"_blank":void 0}),this._resources.consume(w)()){var H=m.e.isActivated("05ACCA89-13E8-4666-A081-074DFBD7EFFB","01/04/2023","Add an href attribute to the link")?void 0:"javascript:void(0)";l.push({Id:"SuiteNave_Sync_OneDrive",Text:i.x,Action:function(){return Object(a.__awaiter)(s,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){return v.e.logData({name:"SuiteNav.SyncThisOneDrive.Click"}),(e=this._resources.consume(O))&&e(),[2]})})},Url:H})}Object(h.isFeatureEnabled)(b.i)&&l.push({Id:"Download_Logs",Text:"Download Logs",Action:function(){return Object(a.__awaiter)(s,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([208],4046)];case 1:return(0,e.sent().downloadDebugLogs)(),[2]}})})}})}return this._isSiteAnalyticsLinkEnabled()&&l.push({Id:"Site_Analytics",Text:i.h,Url:c+"/_layouts/15/siteanalytics.aspx"}),this._isStreamSiteAnalyticsLinkEnabled()&&l.push({Id:"Stream_Site_Analytics",Text:i.I,Url:c+"/_layouts/15/streamanalytics.aspx"}),this._isBrandCenterLinkEnabled()&&l.push({Id:r.e.BRAND_CENTER,Text:i.t,Url:c+"/_layouts/15/brandcenter.aspx"}),this._isChangeTheLookLinkEnabled()&&l.push({Id:r.e.CHANGE_THE_LOOK,Text:i.n,Url:"#"}),this._isSiteDesignsLinkEnabled()&&l.push({Id:r.e.SITE_DESIGNS,Text:i.y,Url:"#"}),this._shouldShowGroupifyLink()&&l.push({Id:"Groupify",Text:i.r,Url:"#"}),this._isVivaConnectionsSettingsLinkEnabled()&&l.push({Id:r.e.VIVA_CONNECTIONS,Text:this._isVivaConnectionsSettingsPreviewTagEnabled()?i.O:i.C,Url:"#"}),l.length>0?l:null},e.prototype._isSiteAnalyticsLinkEnabled=function(){return!this._isODB&&Object(h.isFeatureEnabled)(h.SiteAnalyticsV3)},e.prototype._isStreamSiteAnalyticsLinkEnabled=function(){var e;return m.e.isActivated("dd13d90c-3b4d-4a6f-8f30-dc3b3d906253","01/18/2024","Use site admin check for stream site analytics")?!this._isODB&&Object(h.isFeatureEnabled)(h.DisplayStreamSiteAnalyticsButton):!this._isODB&&Object(h.isFeatureEnabled)(h.DisplayStreamSiteAnalyticsButton)&&(null===(e=this._pageContext)||void 0===e?void 0:e.isSiteAdmin)},e.prototype._isSiteInformationLinkEnabled=function(){var e=Number(this._pageContext.webTemplate)===_.t.mySite||Number(this._pageContext.webTemplate)===_.t.mySiteHost;return p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb)&&(Object(s.r)(this._pageContext)||!e)},e.prototype._isHubSettingsLinkEnabled=function(){return this._pageContext.isSiteAdmin&&this._pageContext.isHubSite},e.prototype._isSitePermissionsLinkEnabled=function(){return!this._isODB&&(!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isExternalGuestUser||p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb))},e.prototype._isChangeTheLookLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);return this._pageContext.modernThemingEnabled&&p.e.hasPermission(this._pageContext.webPermMasks,p.e.applyThemeAndBorder)&&e!==_.t.mySite&&e!==_.t.mySiteHost},e.prototype._hasApplyTemplatePermission=function(){return this._pageContext.isSiteAdmin||p.e.hasPermission(this._pageContext.webPermMasks,{High:2147483647,Low:4294705151})},e.prototype._isSiteDesignsLinkEnabled=function(){if(!this._isWebTemplatesGalleryEnabled()&&this._hasApplyTemplatePermission()){var e=Number(this._pageContext.webTemplate);return e===_.t.group||e===_.t.sitePagePublishing||"STS#3"===this._pageContext.webTemplateConfiguration}return!1},e.prototype._isWebTemplatesGalleryEnabled=function(){return Object(h.isFeatureEnabled)(h.EnableWebTemplatesGallery)&&this._hasApplyTemplatePermission()&&Object(s.o)({webTemplateConfiguration:this._pageContext.webTemplateConfiguration})},e.prototype._isGlobalNavSettingsPanelEnabled=function(){var e=this._pageContext;return Object(h.isFeatureEnabled)(h.WEXMultipleVivaConnectionsGlobalNav)?Object(s.s)(e)&&e.isCurrentSiteAHomeSite&&p.e.hasPermission(e.webPermMasks,p.e.manageWeb):Object(s.s)(e)&&e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0&&p.e.hasPermission(e.webPermMasks,p.e.manageWeb)},e.prototype._shouldShowGroupifyLink=function(){return e=this,Object(h.isFeatureEnabled)(h.GroupifyFromModernPages)&&e._pageContext.isSPO&&e._pageContext.isSiteAdmin&&!e._pageContext.restrictedToRegion&&"/"!==e._pageContext.siteServerRelativeUrl&&e._pageContext.siteServerRelativeUrl===e._pageContext.webServerRelativeUrl&&Number(e._pageContext.webTemplate)===_.t.teamSite&&!e._pageContext.groupId&&!e._pageContext.isGroupifyDisabled&&(m.e.isActivated("616A3856-3AB2-4319-BB53-F25B63B5FC02","10/03/2020","Respect isGroupifyMenuButtonFeatureOff in Suite Nav")||!e._pageContext.isGroupifyMenuButtonFeatureOff);var e},e.prototype._isBrandCenterLinkEnabled=function(){var e,t;return Object(h.isFeatureEnabled)(h.BrandCenterPhase1)&&(null===(t=null===(e=this._pageContext.featureInfo)||void 0===e?void 0:e.BrandCenter)||void 0===t?void 0:t.Enabled)&&p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb)},e.prototype._isVivaConnectionsSettingsLinkEnabled=function(){var e,t="false"!==(null===(e=this._pageContext.farmSettings)||void 0===e?void 0:e.ExternalService_vivaconnectionsenabled),n=m.e.isActivated("30DBB208-E98E-41EF-B53E-6A7DDA4EE2AD")?p.e.hasItemPermission({permissions:this._pageContext.listPermsMask},p.e.editListItems):p.e.hasPermission(this._pageContext.webPermMasks,p.e.editListItems);return t&&Object(h.isFeatureEnabled)(h.VivaConnectionsGA)&&Object(c.t)(this._pageContext)&&n},e.prototype._isVivaConnectionsSettingsPreviewTagEnabled=function(){return!Object(h.isFeatureEnabled)(h.VivaConnectionsPreviewTagRemoval)},e}(),M=Object(d.r)("SuiteNavDataUpdater",k,{resources:l.r});t.default=k},4026:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return P}),n.d(t,"clearCache",function(){return T}),n.d(t,"isProvisioning",function(){return U});var a=n(1830),i=n(118),r=n(129),o=n(334),s=n(2983),c=n(2521),d=n(1),l=n(1182),u=n(62),f=function(){function e(){}return e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}},e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){u.e.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}},e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){u.e.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}},e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e.prototype.OnFlexPaneZoomChanged=function(e){try{O365Shell.FlexPane.OnFlexPaneZoomChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e.prototype.RemoveOnFlexPaneZoomChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneZoomChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e}(),p=function(){function e(){}return e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){u.e.log(e,"NavigationWrapper","OnLinkClick")}},e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){u.e.log(e,"NavigationWrapper","OnHamburgerButtonClick")}},e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){u.e.log(e,"NavigationWrapper","RemoveOnLinkClick")}},e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){u.e.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}},e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){u.e.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}},e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){u.e.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}},e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){u.e.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}},e}(),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._flexPane=new f,t._navigation=new p,t}return Object(d.__extends)(t,e),Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!1,configurable:!0}),t}(l.e),_=m,h=n(1064),b=n(69),g=n(868),v=n(4),y=n(2728),S=n(742),D=n(558),I=n(249),x=n(85),C=n(2981),O=n(58),w="Data",E="CacheDate",A="CacheVersion",L="CachedThisSession",k=new i.e("odSuiteNav",r.e.local),M=function(){function e(e,t){this._dataSource=t.dataSource,this._capabilities=this._dataSource.getCapabilities(),this._cssLoaded=!1}return Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accountSwitchCallback",{get:function(){return this._dataSource.accountSwitchCallback},enumerable:!1,configurable:!0}),e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.clearCachedPromise=function(){this._modelPromise=void 0,this._shellSignal=void 0},e.prototype.getRenderSetting=function(e){return this._dataSource.getRenderSetting?this._dataSource.getRenderSetting(e):null},e.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})},e.prototype.getO365Shell=function(){if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var e=this._shellSignal;if(!e){e=new a.e;var t=new x.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(e),e.getPromise().then(function(){t.end({resultType:x.t.Success})},function(e){t.end(R({error:e}))}),this._shellSignal=e}return e.getPromise()},e.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i&&i.Id===h.e.MAIL)return i.Url}})},e.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(a){!n._cssLoaded&&a.cssUrl&&(D.e.loadStylesheet(a.cssUrl),n._dataSource.onCssLoad&&n._dataSource.onCssLoad(a),n._cssLoaded=!0);var i=a.requireConfig,r=i&&i.paths;t&&r&&(r.shellcore+=".js?odb_cb="+(new Date).toISOString()),C.e.addConfig(a.requireConfig),n._requestShellCore().then(function(t){e.complete(t)},function(t){(t=R({error:t}))&&"RequireError"===t.resultCode&&n._isDataFromCache?(I.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),n._getSuiteNavShell(e)):n._hasRetriedShell?e.error(t):(n._hasRetriedShell=!0,n._cssLoaded=!1,I.e.logData({name:"SuiteNavProvider.O365ShellRetry"}),n._getSuiteNavShell(e,!0))})})},e.prototype._requestShellCore=function(){var e=this,t=new a.e,n=requirejs.toUrl("shellcore");return window.require(["shellcore"],function(){!function(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var a=n[t];H(e.b,a)}}();var e=new _;e.Exists()?t.complete(e):t.error(R({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:n}}))},function(a){e._capabilities.supportsCaching&&T(),requirejs.undef("shellcore"),e._modelPromise=void 0,t.error(R({error:a,resultCode:"RequireError",extraData:{shellUrl:n}}))}),t.getPromise()},e.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,a,o=this._capabilities.supportsCaching,s=this._dataSource,c=x.t.Failure,d=x.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new S.n(function(a,d){var l,u,f;!e&&o&&t._isCacheValid()&&(l=k.getValue(w)),l&&l.data?(s.updateDataForCurrentPage&&s.updateDataForCurrentPage(l.data),o&&(u=k.getValue(L,r.e.session),f=Date.parse(k.getValue(E)),i.e.hasStorageType(r.e.session)&&!u||Date.now()-f>=432e5)&&s.loadData().done(F),t._isDataFromCache=!0,a(l)):(t._isDataFromCache=!1,s.loadData(e).done(function(e){e?e.data?(o&&!U(e)&&F(e),a(e)):(n="NoModelData",d("Model with no data returned")):(n="NoModel",d("No model returned"))},function(e){S.n.isCanceled(d)?(n="Canceled",c=x.t.ExpectedFailure):n="ServerLoadFailure",d(e)}))})},null,function(e){return S.n.isCanceled(e)&&(c=x.t.ExpectedFailure,n="Canceled"),{resultType:c,resultCode:n||"Other",error:e}});return(a=Object(y.e)())?this._modelPromise=S.n.all({suiteNavModel:d,theme:a.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,a=t&&t.data,i=t&&t.hasCobranding,r=a&&a.UseSPOBehaviors,o=Object(v.isFeatureEnabled)(v.SuiteNavPrefersTenantTheme),s=n&&n.suiteBarBackground;return!(s&&a&&r)||i&&o||(a.ThemeColors=[s,n.primaryText,s,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]),t}):this._modelPromise=d,this._modelPromise},e.prototype._isCacheValid=function(){var e=k.getValue(w),t=k.getValue(A),n=Date.parse(k.getValue(E)),a=this._capabilities.supportsRealSuiteNav,i=this._dataSource,r=e&&e.data&&(!a||e.requireConfig)&&5===t&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&!isNaN(n)&&Date.now()-n<864e5;if(!r){var o={model:!!e,"model.data":e&&!!e.data,"model.requireConfig":e&&!!e.requireConfig,supportsRealSuiteNav:a,oldVersion:t,CACHE_VERSION:5,userIsIdentical:e&&e.userIdentifier===i.getUserIdentifier(),cacheToken:e&&e.cacheToken,dataSourceCacheToken:i.getCacheToken(),cacheDate:!isNaN(n),expired:Date.now()-n>=864e5};I.e.logData({name:"SuiteNavCacheDataInvalid",extraData:o})}return r},e}(),P=(t.default=M,Object(v.isFeatureEnabled)(v.UnifiedSuiteNavComponent)?Object(o.r)("SuiteNavProvider",s.e,{dataSource:g.e,pageContext:O.r}):Object(o.r)("SuiteNavProvider",M,{dataSource:b.h}));function T(){k.remove(w),k.remove(E),k.remove(A),k.remove(L,r.e.session)}function U(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}function F(e){k.setValue(w,e),k.setValue(E,new Date),k.setValue(A,5),k.setValue(L,!0,r.e.session)}function H(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];try{return n.apply(this,e)}catch(e){c.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}function R(e){var t=e.error;if(t&&t.resultCode)return t;var n=x.t.Failure;return S.n.isCanceled(t)&&(n=x.t.ExpectedFailure,e.resultCode="Canceled"),{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}},4066:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return F});var a=n(1),i=n(334),r=n(1959),o=n(1628),s=n(175),c=n(427),d=n(86),l=n(691),u=n(59),f=n(301),p=n(145),m=n(267),_=n(72),h=n(2127),b=n(69),g=n(434),v=n(467),y=n(58),S=n(1851),D=n(494),I=n(304),x=n(46),C=n(73),O=n(20),w=n(343),E=n(214),A=n(657),L=n(289),k=n(357),M=n(1835),P=n(42),T=n(859),U=function(){function e(e,t){this._listItemBuilder=t.listItemBuilder,this._listItemResultProcessor=t.listItemResultProcessor,this._itemTaskObserverType=t.itemTaskObserverType,this._urlDataSource=t.urlDataSource,this._microServiceDataSource=t.microServiceDataSource,this._microServiceDataSourceStore=t.microServiceDataSourceStore,this._listContext=t.listContext,this._onePageContext=t.onePageContext,this._pageContext=t.pageContext}return e.prototype.updateFromResponse=function(e){var t=this;return function(n){var i=new t._itemTaskObserverType,r=e.itemSetKey,o=e.serverData,s=e.isItemSetRequest,p=n(Object(l.e)(function(e){var t=e.demandItemFacet(k.e,r),n=t.webAbsoluteUrl,a=t.listFullUrl,i=M.e.serialize({webAbsoluteUrl:n,listFullUrl:a}),o=e.demandItemFacet(P.Lt,i);return{storeKey:e.demandItemFacet(f.t,r),pageContextKey:i,pageContext:o}})),_=p.storeKey,h=p.pageContext,b=p.pageContextKey;if(void 0!==_){var g=[_],v=_.key;s&&(o&&S.e.updateListContext(o,t._listContext),t._onePageContext&&n(function(e,t,n,i){return function(r){var o;i.refreshClientForm=!0,t&&t.listUrl&&i.listId&&t.listId&&i.listId.toUpperCase()===t.listId.toUpperCase()?(O.e(e,t),n&&r(Object(E.e)({items:(o={},o[C.e]=Object(a.__assign)({},w.t.pack({itemKey:n})),o)}))):(e.listUrl=i.listUrl,e.listId=i.listId,e.listTitle=i.listTitle,e.listBaseTemplate=i.listTemplateType),Object(A.t)(void 0,{listId:Object(L.a)(i.listId)}),e.serverRequestPath=void 0}}(t._pageContext,h,b,t._listContext)));var y=t._listItemResultProcessor.processResponse({response:o,pageContext:h,requestKey:v,observer:i}).listRootItemKey;if(s){var U=t._processRootFolder({response:o,requestKey:v,observer:i,isItemSetRequest:s,pageContext:h});U&&g.push(U.item)}var F=o.ListData&&o.ListData.Row||[],H=t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(y);if(H&&o.ListSchema){var R={data:o.ListSchema,allowCookies:!1};H.setBaseInfo(R),t._microServiceDataSource.setBaseInfo(R)}for(var N=o.ListSchema&&"TRUE"===o.ListSchema.Collapse,B=0,j=o.SpotlightInfo&&o.SpotlightInfo.Items&&o.SpotlightInfo.Items.Row||[];B<j.length;B++){var V=j[B],z=t._listItemBuilder.getItemResult({microServiceDataSource:H,itemFromServer:Object(a.__assign)({},V),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i}).item;g.push(z)}if(!N)for(var G=0,K=F;G<K.length;G++){var W=K[G];z=t._listItemBuilder.getItemResult({microServiceDataSource:H,itemFromServer:Object(a.__assign)({},W),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i,pageContext:h}).item,g.push(z)}i.flush();for(var q=new u.e,Q=function(e){var t,r,o=i.getItem(e);if(o&&!o.isPlaceholder){var s=Object(m.f)(e.key),d=n(Object(l.e)(function(e){var t=e.demandItemFacet(c.e,C.e);return c.e.evaluate(t)(e,{viewParams:s,isNavigation:!1}).itemKey}));if(d){var u=D.n.serialize({itemKey:d});q.resolveItems({items:(t={},t[d]=Object(a.__assign)({},Object(I.e)().forFacet(x.u).thenInvalidate(u,D.e).pack()),t[u]=Object(a.__assign)({},D.e.pack(void 0)),t)});var f=n(Object(T.t)({itemKey:d}));if(f)for(var p=0,_=Object.keys(f);p<_.length;p++){var h=_[p];h!==d&&q.mapKeys({mappings:(r={},r[u]=D.n.serialize({itemKey:h}),r)})}}}},Y=0,J=g;Y<J.length;Y++)Q(J[Y]);n(q.execute())}}},e.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,a=e.observer,i=e.pageContext,r=e.isItemSetRequest,o=t.ListData,s=t.ListSchema,c=(void 0===s?{}:s).Collapse,d=void 0===c?"FALSE":c;if(o){var l=o&&o.Row,u="";o.NextHref&&(u=(u=o.NextHref).replace("&View=".concat(_.e.Empty),""));var f="TRUE"===d,m=!f&&l?l.slice(0):[],b=this._urlDataSource.getKeyParams(n),g={id:b[p.t.idParamKey],folder:{childCount:m.length,children:m},nextRequestToken:u,PermMask:o.FolderPermissions,groups:f?l:null,isRootFolder:!1};if(Object(h.e)()){var v=o&&o.CurrentFolderProgId;g.ProgId=v}return this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(b),itemFromServer:g,supportsNestedGroups:!1,isItemDataOnly:!r,observer:a,groupBy:[],pageContext:i})}},e}(),F=(t.default=U,Object(i.r)("LegacyItemCacheSPResponseHandler",U,{listItemBuilder:r.e,listItemResultProcessor:o.e,itemTaskObserverType:s.resourceKey,urlDataSource:b.v,microServiceDataSource:g.resourceKey,microServiceDataSourceStore:v.e,listContext:y.a,pageContext:y.r,onePageContext:y.i.optional}))},4073:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return p}),n.d(t,"deferredSetup",function(){return m});var a=n(128),i=n(481),r=n(1),o=n(2744),s=n(114),c=n(334),d=n(939),l=Object(c.o)("SuiteNavDataSourceV2",o.e,Object(r.__assign)({pageContext:s.e},{prefetchCache:d.e.optional})),u=n(623),f=n(868),p=new i.t({name:"SuiteNavDeferredSetup",factory:{dependencies:{},create:function(){return{instance:m}}}}),m=function(e,t){var i=e.rumone,r=e.resources,o=e.suiteNavCapabilities,s=e.suiteNavContext,c=e.onSuiteNavLoaded,d=e.setDataParams,p=e.onAfterSetData,m=e.deferredSetupCallback,_=e.isEarlySuiteNav,h=e.suiteNavDataUpdaterKey,b=e.suiteNavProviderKey,g=e.searchBoxProviderKey;return h&&b&&r.consumeAsync(h).then(function(e){var h,v,y=new(r.consume(l))({suiteNavCapabilities:o,suiteNavContext:s,suiteNavDataUpdater:e,suiteNavDataSourceBasic:r.consume(u.e.optional)});r.isExposed(f.e)||r.expose(f.e,y);var S=r.consumeAsync(b).then(function(e){return h=e,e.getO365Shell()}).then(function(e){return v=e,null==c||c(v),n.ee([175],3907),m&&m({resources:r,shell:v}),v.GetResourceLoader().loadAll(),h.trySetDataAfterInitialRender(v,d||{})}).then(function(e){e&&(i.mark("Bootstrapper.SuiteNav.CompleteRendered"),i.logRUMOneForDeferredControl("SuiteNav",a.a.now())),null==p||p(v,e)}),D=g?r.consumeAsync(g).then(function(e){e.configureSearchBox(t)}):Promise.resolve();return _?Promise.all([S,D]).then(function(){}):void 0})}}}]);