var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_plus_start"),(self["suiteux_shell_webpackJsonp_suiteux-main"]=self["suiteux_shell_webpackJsonp_suiteux-main"]||[]).push([["plus"],{65537:function(e,t,n){(t=e.exports=n(37541)(!1)).push([e.id,'.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\={display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;border:1px solid hsla(0,0%,100%,0);box-shadow:0 1px 2px 0 rgba(0,0,0,.1);box-sizing:border-box;width:276px;padding-left:0;align-items:flex-start;margin:0 0 17px 16px}html[dir=rtl] .o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\={margin-left:0;margin-right:16px}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.1);box-shadow:0 8px 16px 0 rgba(0,0,0,.1)}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>button{min-width:30px;width:30px;height:36px;padding-left:10px;padding-right:10px;background-color:transparent;border:none;align-items:flex-start}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-ms-clear{display:none}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-cancel-button,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-decoration,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-results-button,.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=>input::-webkit-search-results-decoration{-webkit-appearance:none;display:none}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\= .j6BvNpCF90XiKxu0F7sZzw\\=\\={width:250px;height:32px;background:transparent;align-items:flex-start;border:none;display:block;font:13px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;text-overflow:ellipsis;padding-left:5px;outline:none;margin:.1em}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\= .j6BvNpCF90XiKxu0F7sZzw\\=\\=:-internal-autofill-selected{background-color:transparent!important}.o365cs-base .oxbF2LyKwVB\\/a5\\+4gTMkFg\\=\\=:focus{cursor:text}.o365cs-base .nHk7LESAfIWtWyD9f7IM9g\\=\\={margin:0 0 5px 16px}',""]),t.locals={SearchControl:"oxbF2LyKwVB/a5+4gTMkFg==",inputBox:"j6BvNpCF90XiKxu0F7sZzw==",SearchControlZoomMargin:"nHk7LESAfIWtWyD9f7IM9g=="}},36440:function(e,t,n){(t=e.exports=n(37541)(!1)).push([e.id,'.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\={position:absolute}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._1ZqUEbZKjUMrjQWoZseg6g\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:16px;height:16px;line-height:15px;border-radius:1em;box-sizing:border-box;text-align:center;left:0}@media (-ms-high-contrast:active),(forced-colors:active){.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._1ZqUEbZKjUMrjQWoZseg6g\\=\\={-ms-high-contrast-adjust:none;forced-color-adjust:none;background-color:Highlight!important;color:highlightText!important}}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= ._56EuyMD2soE1\\/gKXBY0q9g\\=\\={top:7px;width:8px;height:8px;border:1px solid #fff;border-radius:4px}.o365cs-base .TlAdlUrWd0Z6\\/TteKJSQig\\=\\= .\\+OLPNIF6B5kKoA97J3vVpw\\=\\={border-color:#000}',""]),t.locals={unseenitems:"TlAdlUrWd0Z6/TteKJSQig==",unseenCount:"_1ZqUEbZKjUMrjQWoZseg6g==",emptyBadge:"_56EuyMD2soE1/gKXBY0q9g==",emptyBadgeDarkMode:"+OLPNIF6B5kKoA97J3vVpw=="}},38243:function(e,t,n){(t=e.exports=n(37541)(!1)).push([e.id,'.NszUgtzDfx0t1PQrucmvnA\\=\\={display:block}.c6QE6q0imyqZPiHyLPm9YA\\=\\={font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.uGAx4CbRh\\+jEaMdf4Etv7w\\=\\={font-family:SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:600}.vmO5rYvtVrmsybm3QJFJUw\\=\\={font-family:SegoeUI-Light-final,Segoe UI Light,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.Q8qHkqThZ3HCwPmk\\+m2bFQ\\=\\={font-family:SegoeUI-SemiLight-final,Segoe UI Semilight,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.iDm2WTqpMgwzbBSSRlbuog\\=\\={font-family:Arial,SegoeUI-Regular-final,Segoe UI,Segoe,Tahoma,Helvetica,sans-serif}',""]),t.locals={displayBlock:"NszUgtzDfx0t1PQrucmvnA==",segoeRegular:"c6QE6q0imyqZPiHyLPm9YA==",segoeSemibold:"uGAx4CbRh+jEaMdf4Etv7w==",segoeLight:"vmO5rYvtVrmsybm3QJFJUw==",segoeSemiLight:"Q8qHkqThZ3HCwPmk+m2bFQ==",arialRegular:"iDm2WTqpMgwzbBSSRlbuog=="}},78153:function(e,t,n){(t=e.exports=n(37541)(!1)).push([e.id,".LOH65mHND5UuJ9b5MOPIyg\\=\\={height:calc(100vh - 115px)}.EjkBtpEVGYQK1q\\/td6mhdg\\=\\={height:calc(100vh - 113px)}.sbU\\+9csU7o21SILr6MJmgw\\=\\={height:calc(100vh - 73px)}",""]),t.locals={flexPaneContentContainer:"LOH65mHND5UuJ9b5MOPIyg==",flexPaneContentContainerForThinHeader:"EjkBtpEVGYQK1q/td6mhdg==",flexPaneContentContainerForShyHeader:"sbU+9csU7o21SILr6MJmgw=="}},98212:function(e,t,n){(t=e.exports=n(37541)(!1)).push([e.id,'.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\={font-family:ShellFabricMDL2IconsLite,ShellFabricMDL2Icons;line-height:1}.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\= .o365cs-base [class*=" ms-Icon--"]:before,.TaSuqlyJ5MSqTQbXTeS3tQ\\=\\= .o365cs-base [class^=ms-Icon--]:before{font-family:inherit}.HKHsnwPD9asgCY\\/1RHVuQw\\=\\=,.I4nj8afMLjWpJ2UOud88zg\\=\\={height:100%}',""]),t.locals={customHeaderButton:"TaSuqlyJ5MSqTQbXTeS3tQ==",customHeaderButtonsContainer:"HKHsnwPD9asgCY/1RHVuQw==",customHeaderButtonWrapper:"I4nj8afMLjWpJ2UOud88zg=="}},46051:function(e,t,n){(t=e.exports=n(37541)(!1)).push([e.id,".\\/FzkYcX7qvnoEMaUtV922A\\=\\=,.hNRvTvwVOsDErxAdwaiZGQ\\=\\={-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-timing-function:cubic-bezier(.1,.9,.2,1)}.MqP9cttxW\\/k6fP9KBfvJXw\\=\\=,.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={width:100%;height:8px;visibility:hidden;display:none}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\={background:transparent;cursor:pointer}.tqq1tl3OHof\\+9xOfBWUR4Q\\=\\=:hover{opacity:.4;background:#404040}.mYrlHvrSR57f9RgjZDapRg\\=\\={position:absolute;left:47.81%;right:47.81%;border-radius:6px;width:14px;height:2px;align-self:center;pointer-events:none}.DJNRezt7dApXIOSDqmGElw\\=\\={-webkit-animation-name:headerSlideInFrames;animation-name:headerSlideInFrames}.QU0CdgILUm0YoP\\+SCe437g\\=\\={-webkit-animation-name:headerSlideOutFrames;animation-name:headerSlideOutFrames}.ICSgbPvcuYIMYmjWDVZjyQ\\=\\={-webkit-animation-name:workloadDivSlideInFrames;animation-name:workloadDivSlideInFrames;animation-fill-mode:forwards}.psEYMGfctmMkbBQaQqGwDg\\=\\={-webkit-animation-name:workloadDivSlideOutFrames;animation-name:workloadDivSlideOutFrames;animation-fill-mode:forwards}@-webkit-keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes headerSlideInFrames{0%{height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@keyframes headerSlideOutFrames{0%{visibility:visible;display:flex;height:48px;opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}to{visibility:hidden;display:none;height:8px;opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}}@-webkit-keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@keyframes workloadDivSlideInFrames{0%{height:8px;min-height:8px}to{height:48px;min-height:48px}}@-webkit-keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}@keyframes workloadDivSlideOutFrames{0%{height:48px;min-height:48px}to{height:8px;min-height:8px}}",""]),t.locals={headerAnimations:"/FzkYcX7qvnoEMaUtV922A==",workloadDivAnimations:"hNRvTvwVOsDErxAdwaiZGQ==",shyHeader:"MqP9cttxW/k6fP9KBfvJXw==",shyHeaderOverlay:"tqq1tl3OHof+9xOfBWUR4Q==",shyHeaderGripper:"mYrlHvrSR57f9RgjZDapRg==",headerSlideIn:"DJNRezt7dApXIOSDqmGElw==",headerSlideOut:"QU0CdgILUm0YoP+SCe437g==",workloadDivSlideIn:"ICSgbPvcuYIMYmjWDVZjyQ==",workloadDivSlideOut:"psEYMGfctmMkbBQaQqGwDg=="}},5746:function(e,t,n){var a=n(65537);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},82973:function(e,t,n){var a=n(36440);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},48648:function(e,t,n){var a=n(38243);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},18341:function(e,t,n){var a=n(78153);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},71253:function(e,t,n){var a=n(98212);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},4223:function(e,t,n){var a=n(46051);"string"==typeof a&&(a=[[e.id,a,""]]);var i={hmr:!0,transform:undefined,insertInto:void 0};n(66134)(a,i);a.locals&&(e.exports=a.locals)},79487:function(e,t,n){"use strict";var a;n.d(t,{o:function(){return a}}),function(e){e[e.OWA=1]="OWA",e[e.TokenFactory=3]="TokenFactory"}(a||(a={}))},56597:function(e,t,n){"use strict";function a(e){let t=null;try{null!=sessionStorage&&(t=sessionStorage.getItem(e))}catch(e){}return t}n.d(t,{K:function(){return y}});var i=n(91011),r=n(62244),s=n(66337),o=n(79487),l=n(39013),c=n(17698),u=n(84686),d=n(32964),p=n(89990),h=n(9264),g=n(85884),m=n(41018),f=n(99964),S=n(78453);class y{get appWebProxyUrl(){return h.buildUrl(this.url,this.iFrameSourceUrl)}get canExecuteNow(){return null!==document.body||y.sWindowLoadCalled}constructor(e,t,n,a=!1){if(h.validateField(t,"url",h.StringTypeString,!0),h.isNullOrEmptyString(t))throw h.createInvalidParameterException("url");if(t.indexOf("?")>=0)throw h.createInvalidParameterException("url");"/"===t.charAt(0)&&(t=h.buildUrl(h.getCurrentWindowLocation(),t)),h.validateFullUrl(t,"url"),t.charCodeAt(t.length-1)==="/".charCodeAt(0)&&(t=t.substr(0,t.length-1)),t=t.toLowerCase(),this.url=t,h.getUrlDomainPart(t,!0)!==h.getUrlDomainPart(h.getCurrentWindowLocation(),!0)&&!a||window.IsO365ShellTestPage?this.mode=1:this.mode=0,this.formDigestHandlingEnabled=!1,this.iFrameSourceUrl=n,y.sIFrameInstanceCode[this.appWebProxyUrl]=e,window.addEventListener("unload",y.resetMessageListenerAttachedFlag)}executeAsync(e){return this.validateRequest(e,!1),this.executeValidatedRequestInternal(e)}executeCrossDomainRequestAsync(e,t=!1){return this.validateRequest(e,!0),this.executeValidatedRequestInternal(e,t)}ping(){return null!=y.sFramePinged&&y.sFramePinged[this.appWebProxyUrl]}registerOpxHost(e){this.executeOrQueueCrossDomainRequest(S.u.RegisterOpxHost,e)}executeOpxRequest(e){const t={requestObject:e};this.executeOrQueueCrossDomainRequest(S.u.OutgoingOpxMessage,t)}executeStorageRequest(e){if(1===this.mode)this.executeOrQueueCrossDomainRequest(S.u.Storage,e);else if(0===this.mode)try{const t=e.requestObject,n=t=>{const n={responseObject:t};y.fireDataWatchSentCallback(e),null!=e.success&&e.success(n),y.fireDataWatchReceivedCallbackGivenResponseInfo(e,n,0,"")};1===t.RequestType?(0,i.jl)().tag("RequestExecutor_SuiteDataSharingDeprecated",6,-1018,p.OH):f.J.processRequest(t,n)}catch(t){null!=e.error&&e.error({},0,t.message),y.fireDataWatchReceivedCallbackGivenResponseInfo(e,{},t.errorCode||0,t.message)}}executeIdentityProviderRequest(e){1===this.mode&&this.executeOrQueueCrossDomainRequest(S.u.UserState,e)}executeSignalRRequest(e){this.validateRequest(e,!1),e.timeout=0,this.executeOrQueueCrossDomainRequest(S.u.SignalR,e)}setBeforeSendRequestAction(e){this.beforeSendRequest=e}prefetchOAuthAccessToken(e){c.e.Instance.configuration.EnableTokenDictionary?u.g.getToken(e).catch((t=>{1===t.responseType&&this.executeOrQueueCrossDomainRequest(S.u.TokenPrefetch,e)})):this.executeOrQueueCrossDomainRequest(S.u.TokenPrefetch,e)}getOwaUserConfiguration(e){this.executeOrQueueCrossDomainRequest(S.u.OwaUserConfig,e)}static internalProcessIFrameRequestTimeoutCallback(e){if(null===y.sPostMessageIdToRequestInfoMap)return;const t=y.sPostMessageIdToRequestInfoMap[e];null!=t&&(y.isCurrentSiteInTrustOrLocalZone()&&(0,i.jl)().tag("RequestExecutor_IFrameLoadError",4,-1007,p.DP),y.sPostMessageIdToRequestInfoMap[e]=null,delete y.sPostMessageIdToRequestInfoMap[e],h.reportSimpleError(t.requestInfo,-1001,p.fL,"IFrameRequest"),(0,i.jl)().serverRequest(t.command,t.requestInfo.method,y.sIFrameInstanceCode[t.appWebProxyUrl].toString(),t.requestInfo.url,-1001),y.fireDataWatchReceivedCallbackGivenResponseInfo(t.requestInfo,null,-1001,p.fL))}validateRequest(e,t){if(h.validateRequestInfo(e),h.isFullUrl(e.url)){if(!t&&h.getUrlDomainPart(e.url,!0).toLowerCase()!==h.getUrlDomainPart(this.url,!0))throw h.createInvalidParameterException("requestInfo.url")}else e.url=h.buildUrl(this.url,e.url);(e.binaryStringRequestBody||e.binaryStringResponseBody)&&h.checkBrowserBinaryDataSupport()}executeValidatedRequestInternal(e,t=!1){return t?this.executeQueryDirect(e):1===this.mode?this.executeOrQueueCrossDomainRequest(S.u.Query,e):this.executeQueryDirect(e),e.postMessageId}executeQueryDirect(e){let t=h.buildUrl(this.url,"_api/contextinfo");t=h.encodeUrlForXmlHttpRequest(t),y.ensureFormDigest(this.url,t,this.formDigestHandlingEnabled,e,((e,t)=>this.executeQueryUsingXMLHttpRequest(e,t)))}static ensureFormDigest(e,t,n,a,s){e=e.toLowerCase();const o=new Date;if(!n||"GET"===a.method.toUpperCase()||null!=y.sFormDigestExpirationCache[e]&&y.sFormDigestExpirationCache[e]>o.getTime())s(y.sFormDigestValueCache[e],a);else{const n=h.getXMLHttpRequest();n.open("POST",t),n.setRequestHeader("accept","application/json;odata=verbose");const o=Date.now();let l=0;a.timeout>0&&(l=window.setTimeout((()=>{n.onreadystatechange=()=>{};try{n.abort()}catch(e){}h.reportSimpleError(a,-1001,p.fL,"ensureFormDigest"),(0,i.jl)().serverRequest(S.u.Query,a.method,null,a.url,-1001,a.isTokenGeneratedFromWorkload)}),a.timeout)),n.onreadystatechange=()=>{if(4===n.readyState){const t=Date.now()-o;if(0!==l&&window.clearTimeout(l),n.onreadystatechange=()=>{},200!==n.status||null===n.getResponseHeader("content-type")||n.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){const e=(0,r.Uw)(p.vK,n.status.toString(),n.getResponseHeader("content-type"));h.reportSimpleError(a,-1002,e),(0,i.jl)().tag("RequestExecutor_UnexpectedResponse",6,-1002,n.status.toString(),n.getResponseHeader("content-type")),(0,i.jl)().serverRequest(S.u.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,t,h.getXMLHttpResponseLength(n))}else{const r=JSON.parse(n.responseText);if(null!=r){const o=r.d.GetContextWebInformation.FormDigestValue,l=r.d.GetContextWebInformation.FormDigestTimeoutSeconds,c=(new Date).getTime()+750*l;y.sFormDigestValueCache[e]=o,y.sFormDigestExpirationCache[e]=c,s(o,a),(0,i.jl)().serverRequest(S.u.Query,a.method,null,a.url,n.status,a.isTokenGeneratedFromWorkload,t,h.getXMLHttpResponseLength(n))}else h.reportSimpleError(a,-1002,p.OX),(0,i.jl)().tag("RequestExecutor_UnableToParseJson",6,-1002,p.OX,n.status.toString(),n.responseText),(0,i.jl)().serverRequest(S.u.Query,a.method,null,a.url,-1002,a.isTokenGeneratedFromWorkload,t,h.getXMLHttpResponseLength(n))}}},n.send("")}}executeOrQueueCrossDomainRequest(e,t){s.isBrowserIE()&&y.sIFrameInstanceCode[this.appWebProxyUrl]===o.o.TokenFactory||(y.sMessageListenerAttached=!!y.sMessageListenerAttached||h.ensureAttachMessageListener(y.internalOnMessage),y.fireDataWatchSentCallback(t),t.postMessageId=y.getPostMessageId(),this.canExecuteNow?this.executeCommandByIFrame(e,this.appWebProxyUrl,t):y.addToRequestExecutorQueue(this,t))}executeCommandByIFrame(e,t,n){const a={command:e,postMessageId:n.postMessageId,appWebProxyUrl:t,requestInfo:n,timeoutId:null};let i=y.sPendingRequestInfo[t];null==i&&(i=[],y.sPendingRequestInfo[t]=i),y.sPostMessageIdToRequestInfoMap[a.postMessageId]=a,a.requestInfo.timeout>0&&(a.timeoutId=window.setTimeout((()=>y.internalProcessIFrameRequestTimeoutCallback(a.postMessageId)),a.requestInfo.timeout));let r=h.getFrameElement(y.sIFrameInstanceCode[t]);null!=r?y.sFrameLoaded[t]&&y.sFramePinged[t]?y.sendPostMessage(a):i.push(a):(i.push(a),r=y.createIFrame(t))}static createIFrame(e){const t=y.sIFrameInstanceCode[e],n=h.getFrameID(t);switch(t){case o.o.OWA:(0,i.jl)().perfMarker("OwaIframeLoadStarted");break;case o.o.TokenFactory:(0,i.jl)().perfMarker("TokenFactoryIframeLoadStarted")}const a=document.createElement("iframe");a.src=e,a.id=n,a.name=n,a.style.display="none",a.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms");a.addEventListener("load",(()=>{y.internalProcessIFrameOnload(e)})),document.body.appendChild(a);const r=window.setTimeout((()=>{delete y.sFrameLoadTimeoutId[e],y.processPingTimeoutOrIFrameLoadTimeout(e)}),this.IFrameLoadTimeout);return y.sFrameLoadTimeoutId[e]=r,a}executeQueryUsingXMLHttpRequest(e,t){const n=h.getXMLHttpRequest(),a=h.encodeUrlForXmlHttpRequest(t.url);n.open(t.method,a);let r=!1;if(null!=t.headers)for(const e of Object.keys(t.headers))null!=e&&(n.setRequestHeader(e,t.headers[e]),"x-requestdigest"===e.toLowerCase()&&(r=!0));r||null==e||n.setRequestHeader("X-RequestDigest",e),t.binaryStringResponseBody&&(n.responseType="arraybuffer");let s=0;t.timeout>0&&(s=window.setTimeout((()=>y.internalProcessXMLHttpRequestTimeoutCallback(n,t)),t.timeout)),n.onreadystatechange=()=>y.internalProcessXMLHttpRequestOnreadystatechange(n,t,s);let o=t.body;if(t.binaryStringRequestBody&&(o=h.convertBinaryStringToXmlHttpRequestBody(t.body)),null!=this.beforeSendRequest&&this.beforeSendRequest(n,null,null),!m.W.isAllowedApi(a)&&!c.e.Instance.configuration.EnableTokenDictionary)return h.reportSimpleError(t,-1009,p.H1),void(0,i.jl)().serverRequest(S.u.Query,t.method,null,a,-1009);y.fireDataWatchSentCallback(t),t.requestSentTime=Date.now(),n.send(o)}static sendPostMessage(e){h.validateField(e.postMessageId,"requestInfo.postMessageId",h.StringTypeString,!0),h.validateField(e.appWebProxyUrl,"requestInfo.appWebProxyUrl",h.StringTypeString,!0);const t=h.getFrameElement(y.sIFrameInstanceCode[e.appWebProxyUrl]);if(null==t)throw(0,i.jl)().tag("RequestExecutor_IFrameNull",6,-2002,p.Dm,e.appWebProxyUrl),new d.F(p.Dm,-2002);null==y.sPostMessageIdToRequestInfoMap&&(y.sPostMessageIdToRequestInfoMap={}),y.sPostMessageIdToRequestInfoMap[e.postMessageId]=e;const n={command:e.command,url:e.requestInfo.url,resource:e.requestInfo.resource,method:e.requestInfo.method,body:e.requestInfo.body,headers:e.requestInfo.headers,postMessageId:e.postMessageId,timeout:e.requestInfo.timeout,binaryStringRequestBody:e.requestInfo.binaryStringRequestBody,binaryStringResponseBody:e.requestInfo.binaryStringResponseBody,requestObject:e.requestInfo.requestObject,getPerformanceTrace:e.requestInfo.getPerformanceTrace},a=JSON.stringify(n),r=e.appWebProxyUrl;e.requestInfo.requestSentTime=Date.now(),c.e.isUnitTestMode||t.contentWindow.postMessage(a,r)}static getPostMessageId(){return y.sPostMessageIdCount++,h.PostMessageIdPrefix+y.sPostMessageIdCount.toString()}static internalProcessWindowLoad(){y.sWindowLoadCalled=!0;const e=y.sRequestExecutorQueue;y.sRequestExecutorQueue=null;const t=y.sRequestExecutorParameterQueue;if(y.sRequestExecutorParameterQueue=null,null!==e)for(let n=0;n<e.length;n++)e[n].executeAsync(t[n])}static resetMessageListenerAttachedFlag(){y.sMessageListenerAttached=!1}static internalProcessIFrameOnload(e){y.sFrameLoaded[e]=!0,null!=y.sFrameLoadTimeoutId[e]&&(window.clearTimeout(y.sFrameLoadTimeoutId[e]),delete y.sFrameLoadTimeoutId[e]),h.ensureAttachMessageListener(y.internalOnMessage),null!=y.sFramePingTimeoutId[e]&&(window.clearTimeout(y.sFramePingTimeoutId[e]),delete y.sFramePingTimeoutId[e]);const t={requestObject:{upn:c.e.Instance.configuration.CurrentUserUpn,puid:c.e.Instance.configuration.CurrentUserPuid,shellConfig:{enableOpx:c.e.Instance.configuration.OpxEnabled}}},n=a("shellver");n&&window.O365ShellBootInfo&&(t.requestObject.overrideRequest=h.buildIframeResourceData(n,window.O365ShellBootInfo));const i={command:S.u.Ping,postMessageId:y.getPostMessageId(),appWebProxyUrl:e,timeoutId:-1,requestInfo:t};y.sPostMessageIdToRequestInfoMap[i.postMessageId]=i;const r=window.setTimeout((()=>{delete y.sFrameLoadTimeoutId[e],y.processPingTimeout(i.postMessageId,e)}),y.IFramePingTimeout);i.timeoutId=r,c.e.isUnitTestMode||(y.sFramePingTimeoutId[e]=r),y.sendPostMessage(i)}static internalOnMessage(e){if(null==e)return;const t=e.origin,n=e.data;if(null!=t&&""!==t&&null!=n&&""!==n)try{const e=JSON.parse(n);y.isPostMessageResponseInfo(e)&&y.onResponseMessageReceived(t,e)}catch(e){}}static isPostMessageResponseInfo(e){const t=e;return null!=t.postMessageId&&null!=t.command}static onResponseMessageReceived(e,t){const n=Date.now();if(null==y.sPostMessageIdToRequestInfoMap)return;if(null==t.postMessageId)return;const a=y.sPostMessageIdToRequestInfoMap[t.postMessageId];if(null==a)return;const r=h.getUrlDomainPart(e,!0),s=h.getUrlDomainPart(a.appWebProxyUrl,!0);if(r.toLowerCase()!==s.toLowerCase())return;const o=t.postMessageId,l=n-a.requestInfo.requestSentTime,c=t.command===S.u.Query&&0===t.errorCode&&3===t.readyState,u=t.command===S.u.Notification&&null==t.errorMessage;if(c||u||(delete y.sPostMessageIdToRequestInfoMap[o],null!=a.timeoutId&&(window.clearTimeout(a.timeoutId),a.timeoutId=0,delete a.timeoutId)),t.command===S.u.Ping)y.processPingMessage(a.appWebProxyUrl,t),y.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,t),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),h.getUrlDomainPart(a.appWebProxyUrl),0===t.errorCode?200:t.errorCode,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0);else if(t.command===S.u.Query){const e={responseAvailable:t.responseAvailable,body:t.responseText||"",statusCode:t.statusCode,statusText:t.statusText,contentType:t.contentType,state:a.requestInfo.state,allResponseHeaders:t.allResponseHeaders,headers:h.parseResponseHeaders(t.allResponseHeaders),binaryStringResponseBody:t.binaryStringResponseBody};let n=0,r=null;0!==t.errorCode?(n=t.errorCode,r=t.errorMessage):t.statusCode>=200&&t.statusCode<300||1223===t.statusCode||(n=-1003,r=t.statusCode),0===n?4===t.readyState?(e.performanceTrace=t.performanceTrace,null!=a.requestInfo.success&&a.requestInfo.success(e),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,0,null),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,t.statusCode,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0)):3===t.readyState&&null!=a.requestInfo.loading&&a.requestInfo.loading(e):4!==t.readyState&&0!==t.readyState&&null!=t.readyState||(e.performanceTrace=t.performanceTrace,null!=a.requestInfo.error&&a.requestInfo.error(e,n,r),(0,i.jl)().tag("RequestExecutor_IFrameError",4,n,r),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,n,r),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,n,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0))}else if(t.command===S.u.Storage||t.command===S.u.TokenPrefetch||t.command===S.u.OwaUserConfig){const e={responseObject:t.responseObject},n=t.errorCode,r=t.errorMessage;0===n&&h.isNullOrEmptyString(r)?(null!=a.requestInfo.success&&a.requestInfo.success(e),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,0,null)):(null!=a.requestInfo.error&&a.requestInfo.error(e,n,r),y.fireDataWatchReceivedCallbackGivenResponseInfo(a.requestInfo,e,n,r)),(0,i.jl)().serverRequest(a.command,a.requestInfo.method,y.sIFrameInstanceCode[a.appWebProxyUrl].toString(),a.requestInfo.url,0!==n?n:200,a.requestInfo.isTokenGeneratedFromWorkload,l,t.responseText?t.responseText.length:0)}else t.command===S.u.Notification?(0!==t.errorCode&&null!=a.requestInfo.error&&a.requestInfo.error({responseObject:t.responseObject},t.errorCode,t.errorMessage),y.NotificationCallback(JSON.stringify(t.responseObject)),y.fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(a.requestInfo,t)):t.command===S.u.RegisterOpxHost&&null!=a.requestInfo.success&&a.requestInfo.success(null)}static internalProcessXMLHttpRequestTimeoutCallback(e,t){e.onreadystatechange=()=>{};try{e.abort()}catch(e){}h.reportSimpleError(t,-1001,p.fL,"XMLHttpRequest"),(0,i.jl)().serverRequest(S.u.Query,t.method,null,t.url,-1001),y.fireDataWatchReceivedCallbackGivenResponseInfo(t,null,-1001,p.fL)}static internalProcessXMLHttpRequestOnreadystatechange(e,t,n){if(4===e.readyState){const a=Date.now();0!==n&&window.clearTimeout(n),e.onreadystatechange=()=>{};const r={state:t.state,responseAvailable:!0,body:t.binaryStringResponseBody?h.convertArrayBufferToBinaryString(e.response):e.responseText,statusCode:e.status,statusText:e.statusText,contentType:e.getResponseHeader("content-type"),allResponseHeaders:e.getAllResponseHeaders(),headers:h.parseResponseHeaders(e.getAllResponseHeaders()),performanceTrace:null},s=a-t.requestSentTime;if(t.getPerformanceTrace){const e=performance.getEntriesByName(t.url);null!=e&&e.length>0&&(r.performanceTrace=e[0])}e.status>=200&&e.status<300||1223===e.status?(null!=t.success&&t.success(r),y.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,0,null),(0,i.jl)().serverRequest(S.u.Query,t.method,null,t.url,r.statusCode,t.isTokenGeneratedFromWorkload,s,h.getXMLHttpResponseLength(e))):(null!=t.error&&t.error(r,-1003,e.statusText),y.fireDataWatchReceivedCallbackGivenResponseInfo(t,r,-1003,e.statusText),(0,i.jl)().serverRequest(S.u.Query,t.method,null,t.url,e.status,t.isTokenGeneratedFromWorkload,s,h.getXMLHttpResponseLength(e)))}}static isCurrentSiteInTrustOrLocalZone(){if(!y.isTrustedSiteEvaluated){if(s.isBrowserIE()){const e=window.status,t=window.status+(new Date).getTime();window.status=t,y.isTrustedSite=window.status===t,window.status=e}y.isTrustedSiteEvaluated=!0}return y.isTrustedSite}static processPingTimeout(e,t){null!=y.sPostMessageIdToRequestInfoMap[e]&&(y.sFramePinged[t]||((0,i.jl)().tag("PingTimeout",0,y.sIFrameInstanceCode[t].toString()),y.sPostMessageIdToRequestInfoMap[e]=null,delete y.sPostMessageIdToRequestInfoMap[e],y.processPingTimeoutOrIFrameLoadTimeout(t)))}static processPingTimeoutOrIFrameLoadTimeout(e){switch(y.sIFrameInstanceCode[e]){case o.o.OWA:(0,i.jl)().perfMarker("OwaIframeLoadFailed");break;case o.o.TokenFactory:(0,i.jl)().perfMarker("TokenFactoryIframeLoadFailed")}const t=h.getUrlDomainPart(e,!0);if(t.toLowerCase()===h.getUrlDomainPart(c.e.Instance.configuration.SuiteServiceUrl,!0)){const e=y.isCurrentSiteInTrustOrLocalZone()?g.v.SecurityZoneMismatched:g.v.IframeLoadError;l.t.Instance.blockSuiteServiceCalls(e,t)}const n=(0,r.Uw)(p.EE,t);y.reportFrameLoadError(e,n)}static reportFrameLoadError(e,t,n=-1007){y.sFrameLoadError[e]=!0;const a=y.sPendingRequestInfo[e];y.sPendingRequestInfo[e]=[];let r=!1;if(r=y.isTrustedSiteEvaluated?y.isTrustedSite:y.isCurrentSiteInTrustOrLocalZone(),(0,i.jl)().tag("RequestExecutor_IFrameLoadError",4,n,t,"isTrustedSite: "+r),null!=y.sFrameLoadTimeoutId[e]&&(window.clearTimeout(y.sFrameLoadTimeoutId[e]),delete y.sFrameLoadTimeoutId[e]),y.removeIFrame(e),null!=a)for(const r of a){const a=r.postMessageId;null!=y.sPostMessageIdToRequestInfoMap[a]&&(y.sPostMessageIdToRequestInfoMap[a]=null,delete y.sPostMessageIdToRequestInfoMap[a],null!=r.timeoutId&&window.clearTimeout(r.timeoutId),h.reportSimpleError(r.requestInfo,n,t),(0,i.jl)().serverRequest(r.command,r.requestInfo.method,y.sIFrameInstanceCode[e].toString(),r.requestInfo.url,-1007))}}static removeIFrame(e){const t=h.getFrameElement(y.sIFrameInstanceCode[e]);null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t),null!=y.sPendingRequestInfo&&delete y.sPendingRequestInfo[e],null!=y.sFrameLoadTimeoutId&&delete y.sFrameLoadTimeoutId[e],null!=y.sFrameLoaded&&delete y.sFrameLoaded[e],null!=y.sFramePinged&&delete y.sFramePinged[e],null!=y.sFramePingTimeoutId&&delete y.sFramePingTimeoutId[e],null!=y.sFrameLoadError&&delete y.sFrameLoadError[e]}static processPingMessage(e,t){switch(y.sIFrameInstanceCode[e]){case o.o.OWA:(0,i.jl)().perfMarker("OwaIframeLoadCompleted");break;case o.o.TokenFactory:(0,i.jl)().perfMarker("TokenFactoryIframeLoadCompleted")}if(t.errorCode&&0!==t.errorCode)return void y.reportFrameLoadError(e,t.errorMessage,t.errorCode);y.sFramePinged[e]=!0;const n=y.sPendingRequestInfo[e];if(null!=n){y.sPendingRequestInfo[e]=[];for(const e of n)null!=y.sPostMessageIdToRequestInfoMap[e.postMessageId]&&y.sendPostMessage(e)}}static addToRequestExecutorQueue(e,t){null===y.sRequestExecutorQueue&&(y.sRequestExecutorQueue=[]),null===y.sRequestExecutorParameterQueue&&(y.sRequestExecutorParameterQueue=[]),y.sRequestExecutorQueue.push(e),y.sRequestExecutorParameterQueue.push(t)}static fireDataWatchSentCallback(e){null!==y.DataWatchSentCallback&&(y.DataWatchRequestId++,e.dataRequestId=y.DataWatchRequestId,y.DataWatchSentCallback(y.DataWatchRequestId,e))}static fireDataWatchReceivedCallbackGivenPostMessageResponseInfo(e,t){if(null==y.DataWatchReceivedCallback)return;const n={body:t.responseText,responseAvailable:t.responseAvailable,statusCode:t.statusCode,statusText:t.statusText,contentType:t.contentType,allResponseHeaders:t.allResponseHeaders,headers:h.parseResponseHeaders(t.allResponseHeaders),binaryStringResponseBody:t.binaryStringResponseBody,responseObject:t.responseObject,state:e.state,performanceTrace:t.performanceTrace};y.fireDataWatchReceivedCallbackGivenResponseInfo(e,n,t.errorCode,t.errorMessage)}static fireDataWatchReceivedCallbackGivenResponseInfo(e,t,n,a){null!==y.DataWatchReceivedCallback&&null!=e.dataRequestId&&y.DataWatchReceivedCallback(e.dataRequestId,t,n,a)}}y.DefaultTimeout=6e4,y.IFrameLoadTimeout=15e3,y.IFramePingTimeout=1e4,y.sPendingRequestInfo={},y.sFrameLoaded={},y.sFramePinged={},y.sFramePingTimeoutId={},y.sFrameLoadTimeoutId={},y.sFrameLoadError={},y.sPostMessageIdToRequestInfoMap={},y.sIFrameInstanceCode={},y.sFormDigestValueCache={},y.sFormDigestExpirationCache={},y.sPostMessageIdCount=0,y.sWindowLoadCalled=!1,y.sRequestExecutorQueue=[],y.sRequestExecutorParameterQueue=[],y.DataWatchSentCallback=null,y.DataWatchRequestId=0,y.DataWatchReceivedCallback=null},84185:function(e,t,n){"use strict";n.d(t,{Ou:function(){return c}});var a=n(62244),i=n(41018),r=n(79487),s=n(56597),o=n(17698);const l="SuiteServiceProxy.aspx";class c{static get OwaInstance(){return null==c.suiteSvcInstance?c.createOwaRequestExecutor():c.suiteSvcInstance}static get OauthTokenFactoryInstance(){return null==c.tokenFactoryInstance?c.createOauthTokenFactoryRequestExecutor():c.tokenFactoryInstance}static setOauthTokenFactoryInstanceForTesting(e){o.e.isUnitTestMode&&(c.tokenFactoryInstance=e)}static resetAllInstancesForTesting(){c.tokenFactoryInstance=null,c.suiteSvcInstance=null}static createOauthTokenFactoryRequestExecutor(){if(o.e.assertInitialized(),null!=o.e.Instance.configuration.TokenFactoryIframeOrigin){let e=(0,a.Uw)("{0}//{1}",window.location.protocol,window.location.host),t=(0,a.Uw)(c.TokenFactoryIframePath,encodeURIComponent(e),encodeURIComponent(o.e.Instance.configuration.ShellSID),encodeURIComponent(c.TokenFactoryIframeApiVersion),encodeURIComponent(o.e.Instance.configuration.ClientShellVersion));t+=`&upn=${encodeURIComponent(o.e.Instance.configuration.CurrentUserUpn)}`;let n="https://consumer.suite.office.com"===o.e.Instance.configuration.TokenFactoryIframeOrigin;c.tokenFactoryInstance=new s.K(r.o.TokenFactory,o.e.Instance.configuration.TokenFactoryIframeOrigin,t,n)}return c.tokenFactoryInstance}static createOwaRequestExecutor(){if(o.e.assertInitialized(),null!=o.e.Instance.suiteServiceHostPageBaseUrl&&o.e.Instance.configuration.UserHasExchangeLicense){let e;e=o.e.Instance.configuration.HintUserName?(0,a.Uw)("{0}?suiteServiceUserName={1}&{2}={3}&{4}",l,encodeURIComponent(o.e.Instance.configuration.CurrentUserUpn),c.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),c.SuiteServiceProxyIframeApiVersion):(0,a.Uw)("{0}?{1}={2}&{3}",l,c.SuiteServiceReturnUrlParam,encodeURIComponent(window.location.href),c.SuiteServiceProxyIframeApiVersion),c.suiteSvcInstance=new s.K(r.o.OWA,o.e.Instance.suiteServiceHostPageBaseUrl,e),c.suiteSvcInstance.setBeforeSendRequestAction(i.W.onBeforeSendRequestSuiteService)}return c.suiteSvcInstance}}c.TokenFactoryIframePath="/iframe/TokenFactoryIframe?origin={0}&shsid={1}&apiver={2}&cshver={3}",c.TokenFactoryIframeApiVersion="oneshell",c.SuiteServiceProxyIframeApiVersion="apiver=1",c.SuiteServiceReturnUrlParam="suiteServiceReturnUrl"},39013:function(e,t,n){"use strict";n.d(t,{t:function(){return y}});var a=n(91011),i=n(9028),r=n(62244),s=n(17698),o=n(32964),l=n(85884),c=n(2221);class u{constructor(e){this.service=e,this.NumMinutesToADReplication=2}setTargetServerReceivedTime(e){if(!s.e.isUnitTestMode)throw new o.P("Operation not allowed if it is not a unit test",-2002);this.targetServerReceivedTime=e}beforeSuiteServiceCall(e){if(null!=this.targetServer){(new Date).getTime()-this.targetServerReceivedTime.getTime()<=60*this.NumMinutesToADReplication*1e3&&(e[u.TargetServerHeader]=this.targetServer)}}afterSuiteServiceSuccess(e){null==this.targetServer&&null!=e[u.TargetServerHeader]&&(this.targetServer=e[u.TargetServerHeader],this.targetServerReceivedTime=new Date)}afterSuiteServiceError(e,t){null!=e[y.XSuiteError]&&e[y.XSuiteError]===u.ShardNotFoundException?(this.service.blockSuiteServiceCalls(l.v.ShardNotDetected),t(c.convertErrorToException(null,-1010,l.v.ShardNotDetected.toString()))):t(e)}}u.TargetServerHeader="X-TARGETSERVER",u.ShardNotFoundException="InvalidOrUnavailableMailboxException";var d=n(9264);class p{constructor(){this.handleMessage=e=>{let t=!1;if(null!=e)for(let n=0;!t&&n<this.handlers.length;n++)if(e&&e.data&&e.origin){let a=this.handlers[n];if(a.validateOrigin(e.origin)){let n=e.data;a.validateMessage(n)&&(t=a.handleMessage(n))}}},this.handlers=[],(0,d.ensureAttachMessageListener)(this.handleMessage)}registerHandler(e){this.handlers.push(e)}}var h=n(56597),g=n(84185),m=n(84686),f=n(25889);class S{constructor(e,t,n){this.RequestExecutor=e,this.RequestInfo=t,this.ErrorCallback=n}}class y{constructor(){this.firstDataRequestSent=!1,this.startupCallbacks=[],this.owsStartupActionCompleted=!1,this.queuedCalls=[],this.messageDispatcher=new p}static get Instance(){return this.instance}get ConnectionEstablished(){return this.owsStartupActionCompleted}get AreSuiteServiceCallsBlocked(){return null!=this.suiteServiceCallsBlockedReason}get ShouldQueueOwsCalls(){return!this.owsStartupActionCompleted&&!s.e.Instance.configuration.IsOwa}registerPostMessageHandler(e){this.messageDispatcher.registerHandler(e)}setStartupActionCompleted(){this.owsStartupActionCompleted=!0;for(const e of this.queuedCalls)try{e.RequestExecutor.executeAsync(e.RequestInfo)}catch(e){}this.queuedCalls=[],this.callStartupCallbacks()}static setInstanceForTesting(e){s.e.isUnitTestMode&&(this.instance=e)}callOwaIframeAction(e,t,n=!0){return this.callOwaIframeActionWithAdditionalHeaders(e,t,null,n)}callOwaIframeResourceUrl(e,t,n){return new Promise(((a,r)=>{i.throwOnNullOrEmpty(e,"resourceUrl"),i.throwOnUndefined(n,"method"),null!==this.owaCallsInterceptor||s.e.Instance.configuration.UserHasExchangeLicense||(this.owaCallsInterceptor=new u(this)),n===f.F.PUT&&i.throwOnUndefined(t,"data");const o={};null!==s.e.Instance.configuration.CurrentUserUpn&&(o[y.UPNAnchorMailboxHeaderKey]=s.e.Instance.configuration.CurrentUserUpn);const l=s.e.Instance.configuration.SuiteServiceUrl.replace(d.OwsRelativePath,e);null!=this.owaCallsInterceptor&&this.owaCallsInterceptor.beforeSuiteServiceCall(o);let c=r;null!=this.owaCallsInterceptor&&(c=e=>{this.owaCallsInterceptor.afterSuiteServiceError(e,r)}),this.callOwaIframeWithOrWithoutRetry(l,o,t,n).then((e=>a(""!==e?JSON.parse(e):""))).catch(c)}))}callOwaIframeActionWithAdditionalHeaders(e,t,n,a=!0){return new Promise(((o,l)=>{i.throwOnNullOrEmpty(e,"action"),i.throwOnUndefined(t,"data");const c=s.e.Instance.configuration.SuiteServiceUrl,u="suiteservice.svc",d=-1!==c.toLowerCase().indexOf(u,c.length-16)?"{0}/?action={1}":"{0}?action={1}",p=this.isUserInitiatedCall(e)?e:e+"&UA=0",h=(0,r.Uw)(d,c,p);null===n&&(n={}),n[y.ActionHeaderKey]=e,this.callOwaIframeWithOrWithoutRetry(h,n,t,f.F.POST,a).then((e=>o(""!==e?JSON.parse(e):""))).catch(l)}))}prefetchAccessToken(e,t=null){const n={url:e,resource:t};return new Promise(((e,t)=>{n.error=(e,n,a)=>{t(c.convertErrorToException(e,n,a))},n.success=t=>e(t);const a=g.Ou.OauthTokenFactoryInstance;null!=a&&a.prefetchOAuthAccessToken(n)}))}registerOpxHost(e,t,n=h.K.DefaultTimeout){return new Promise(((a,i)=>{const r={resource:e,url:t,error:(e,t,n)=>{i(c.convertErrorToException(e,t,n))},success:e=>{a()},timeout:n},s=g.Ou.OauthTokenFactoryInstance;null==s?i(new o.P("OauthTokenFactoryIframe",-1011)):s.registerOpxHost(r)}))}callOpxIframe(e){const t=g.Ou.OauthTokenFactoryInstance;if(null==t)throw new o.P("OauthTokenFactoryIframe",-1011);t.executeOpxRequest(e)}callEndpointWithOauthToken(e,t){return new Promise(((n,a)=>{null==e.body&&(e.body=""),null==e.method&&(e.method="GET"),null==e.headers&&(e.headers={}),e.resource===s.e.Instance.configuration.TokenFactoryIframeOrigin&&(e.headers["x-o365suiteuxshell-workloadid"]=s.e.Instance.configuration.WorkloadId),e.success=e=>{try{let a;a=null!=e.contentType&&e.contentType.indexOf("application/json")>-1?t?e:JSON.parse(e.body):t?e:e.body,n(a)}catch(e){return void a(new o.P("Invalid response format."))}},e.error=(e,t,n)=>{a(c.convertErrorToException(e,t,n))};const i=g.Ou.OauthTokenFactoryInstance;null!=i?s.e.Instance.configuration.EnableTokenDictionary||0===i.mode?m.g.getToken(e).then((t=>{0===t.responseType&&(e.headers.Authorization="Bearer "+t.token,null!=s.e.Instance.configuration.ServiceWorkerCacheId&&null!=s.e.Instance.configuration.ServiceWorkerCacheId&&(e.headers["X-SW-OHP-UserCacheId"]=s.e.Instance.configuration.ServiceWorkerCacheId,e.headers["X-SW-OHP-FetchStrategy"]=s.e.Instance.configuration.ServiceWorkerFetchStrategy),e.isTokenGeneratedFromWorkload=!0,delete e.headers["x-o365suiteuxshell-workloadid"],i.executeCrossDomainRequestAsync(e,!0))})).catch((t=>{1===t.responseType&&i.executeCrossDomainRequestAsync(e)})):i.executeCrossDomainRequestAsync(e):a(new o.P("OauthTokenFactoryIframe",-1011))}))}callWebClientShellServiceFunction(e,t,n,a){const i=(0,r.Uw)("{0}/{1}",s.e.Instance.configuration.TokenFactoryIframeOrigin,"/"===e.charAt(0)?e.substr(1):e);null==n&&(n={}),"Content-Type"in n||(n["Content-Type"]="application/json;charset=UTF-8"),"Accept"in n||(n.Accept="application/json");const o={method:t,url:i,resource:s.e.Instance.configuration.TokenFactoryIframeOrigin,body:JSON.stringify(a),headers:n};return this.callEndpointWithOauthToken(o)}owaSessionStorageRequest(e){return new Promise(((t,n)=>{if(i.throwOnUndefined(e,"data"),this.shouldBlockCall(4))return void n(new o.P("SuiteService",-1011));const a={url:s.e.Instance.suiteServiceHostPageBaseUrl,requestObject:e,timeout:3e4,success:e=>t(e.responseObject),error:(e,t,a)=>n(new o.P(a,-2002))},r=g.Ou.OwaInstance;null==r?n(new o.P("SuiteService",-1011)):r.executeStorageRequest(a)}))}callOwaIframeWithOrWithoutRetry(e,t,n,a,i=!0){const r={};if(null!=t)for(const e of Object.keys(t))r[e]=t[e];r.Accept="application/json",r["Content-Type"]="application/json; charset=utf-8";const l=s.e.Instance.MailboxGuid,u=s.e.Instance.configuration.ShellSID,d=l||u;let p=c.generateCorrelationId(d);r["X-OWA-CorrelationId"]=p;const h=JSON.stringify(n);return new Promise(((n,s)=>{if(null!=this.suiteServiceCallsBlockedReason){const e=new o.P(this.suiteServiceCallsBlockedReason,-1010);return s(e)}const l=g.Ou.OwaInstance;if(null===l)return void this.executeErrorCallback(t,s,c.convertErrorToException(null,-1011,"OwaIframe"));let u=!1;this.firstDataRequestSent||(u=!0,this.firstDataRequestSent=!0);const m=e=>{null!=this.owaCallsInterceptor&&this.owaCallsInterceptor.afterSuiteServiceSuccess(e.headers),n(e.body)};this.owaHttpRequest(l,e,h,r,a).then(m).catch(i?n=>{449===n.HttpStatus?this.owaHttpRequest(l,e,h,r,a).then(m).catch((e=>this.executeErrorCallback(t,s,e))):null!=n[y.XSuiteError]&&n[y.XSuiteError]===y.WrongServerException?(p=c.generateCorrelationId(d),r["X-OWA-CorrelationId"]=p,this.owaHttpRequest(l,e,h,r,a).then((e=>{m(e)})).catch((e=>{this.executeErrorCallback(t,s,e)}))):s(n)}:()=>{s()})}))}owaHttpRequest(e,t,n,r,s){return new Promise(((o,u)=>{if(i.throwOnNullOrUndefined(t,"url"),this.shouldBlockCall(this.getExchangeServiceToCall(t)))return u(c.convertErrorToException(null,-1010,this.suiteServiceCallsBlockedReason));let d=null;const p={headers:r,url:t,method:s.toString(),body:s!==f.F.GET?n:void 0,success:e=>{const t=c.getOwaError(e.headers);if(null!=t)return this.checkAndHandleBlockingOwaErrors(t),void u(c.convertErrorToException(e,e.statusCode,t));try{o(e)}catch(e){}null!=d&&d()},error:(e,t,n)=>{const i=c.getOwaError(e.headers);null!=i&&this.checkAndHandleBlockingOwaErrors(i),e.statusCode!==y.HttpStatusCodeTokenExpired&&e.statusCode!==y.HttpStatusCodeUnauthorized||(this.blockSuiteServiceCalls(l.v.TokenExpired,t,n),(0,a.Lo)().invoke("AuthenticationExpired")),u(c.convertErrorToException(e,t,n))}};if(this.ShouldQueueOwsCalls)if(this.isStartupAction(r))d=()=>{this.setStartupActionCompleted(),d=null};else if(2===this.getExchangeServiceToCall(p.url))return void this.queuedCalls.push(new S(e,p,u));e.executeAsync(p)}))}registerAuthenticationExpiredCallback(e){(0,a.Lo)().subscribe("AuthenticationExpired",e,!0)}registerCultureNotSetCallback(e){(0,a.Lo)().subscribe("CultureNotSet",e,!0)}guaranteeConnectionEstablished(e){this.ConnectionEstablished||s.e.Instance.configuration.IsOwa?e():this.startupCallbacks.push(e)}blockSuiteServiceCalls(e,...t){
// the more important blocking reasons are evaluated first e.g. NoExoLicense etc
null!=this.suiteServiceCallsBlockedReason&&e!==l.v.ShardNotDetected||(this.suiteServiceCallsBlockedReason=e.toString(),(0,a.jl)().tag("RequestExecuter_SuiteServiceCallsBlocked",4,l.v[e],t))}stopBlockingCalls(){this.suiteServiceCallsBlockedReason=null}callStartupCallbacks(){for(const e of this.startupCallbacks)null!=e&&e();this.startupCallbacks=[]}checkAndHandleBlockingOwaErrors(e){e.indexOf("OwaInvalidUserLanguageException")>-1?(this.blockSuiteServiceCalls(l.v.LanguageNotSet,e),(0,a.Lo)().invoke("CultureNotSet")):"InvalidMailbox"===e?this.blockSuiteServiceCalls(l.v.InvalidMailbox,e):"ShardMailbox"===e&&this.blockSuiteServiceCalls(l.v.ShardMailbox,e)}getExchangeServiceToCall(e){const t=null!=e?d.getUrlPath(e):null;if(t){const e=(e,t)=>e.substr(0,t.length)===t;if(e(t,d.SuiteServiceApiRelativePath))return 3;if(e(t,d.OwsRelativePath))return 2;if(e(t,d.DevFabricOwsRelativePath))return 2}const n=new Error("Cannot Acquire Exchange Service to Call");throw(0,a.jl)().exception("Service_ExchangeServiceAcquireFail",6,n,t),n}shouldBlockCall(e){return null!=this.suiteServiceCallsBlockedReason&&!(2!==e&&y.callBlockingReasonsSpecificToOws.indexOf(this.suiteServiceCallsBlockedReason))}executeErrorCallback(e,t,n){try{t(n)}catch(e){}if(!this.owsStartupActionCompleted&&this.isStartupAction(e)){const e=n.errorCode||0,t=-1005===e?l.v.CallerOriginNotAllowed:l.v.InitFailed;this.blockSuiteServiceCalls(t,e,n.message);const a=c.convertErrorToException(null,-1010,"App initialization failed, call canceled",e,n.message);for(const e of this.queuedCalls)try{e.ErrorCallback(a)}catch(e){}this.queuedCalls=[]}}isUserInitiatedCall(e){return y.userInitiatedCalls.indexOf(e.toLowerCase())>=0}isStartupAction(e){const t=s.e.Instance.configuration.StartupActionName;return null!=t&&t===e[y.ActionHeaderKey]}}y.ActionHeaderKey="Action",y.UPNAnchorMailboxHeaderKey="X-UpnAnchorMailbox",y.XSuiteError=c.XSuiteError,y.HttpStatusCodeUnauthorized=401,y.HttpStatusCodeTokenExpired=440,y.WrongServerException="WrongServerException",y.instance=new y,y.callBlockingReasonsSpecificToOws=[l.v.LanguageNotSet.toString(),l.v.InitFailed.toString(),l.v.InvalidMailbox.toString(),l.v.ShardMailbox.toString()],y.userInitiatedCalls=["getowauserconfiguration"]},17698:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});class a{constructor(e){this.suiteServiceHostPageBaseUrl=e.SuiteServiceUrl.substring(0,e.SuiteServiceUrl.lastIndexOf("/")),this.configuration=e}static Initialize(e){this.instance=new a(e)}static get Instance(){return this.instance}static assertInitialized(){if(null===a.Instance)throw new Error("SessionData not initialized.")}}a.isUnitTestMode=!1},84686:function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var a=n(91011),i=n(17698);class r{static getToken(e){return new Promise(((t,n)=>{if(i.e.Instance.configuration.GetTokenRequestDictionary){let r=i.e.Instance.configuration.GetTokenRequestDictionary(),s=e=>{e?t({token:e,responseType:0}):((0,a.jl)().tag("GetAccessToken_Empty",6),n({responseType:2}))},o=e=>{(0,a.jl)().exception("GetAccessToken_Failed",6,e),n({responseType:2,exception:e})};if(r[e.resource]){let t=r[e.resource];"function"==typeof t?t().then((e=>{s(e)})).catch((e=>{o(e)})):t.then((e=>{s(e)})).catch((e=>{o(e)}))}else n({responseType:1})}else n({responseType:1})}))}}},15312:function(e,t,n){"use strict";n.d(t,{F:function(){return c}});var a=n(77224),i=n(62244),r=n(9264);const s='{ "kty": "oct", "k": "{0}", "extractable": true }';let o;const l=void 0!==typeof btoa;class c{static loadCryptoModule(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return new Promise((e=>{void 0!==o?e():null!=window.crypto?(o=window.crypto,e()):n.e("msrcrypto").then(n.t.bind(n,95384,23)).then((t=>{o=t,e()}))}))}))}static computeSHA256(e,t=!0){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((n,a)=>{try{let i=c.textToUInt8Array(e,t),r={name:"SHA-256"},s=o.subtle.digest(r,i);const l=e=>{if(c.verifyResult(e,a)){let t=Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("");n(c.toBase64(t))}},u=e=>{c.verifyResult(e,a)&&a(e.toString())};s.then(l,u)}catch(e){a(e.toString())}}))}))}static encryptAES(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((a,r)=>{try{let l=(0,i.Uw)(s,c.base64ToBase64Url(e)),u={name:"AES-CBC"},d=o.subtle.importKey("jwk",JSON.parse(l),u,!0,["encrypt","decrypt"]);const p=e=>{try{let i=e,s=c.textToUInt8Array(c.base64ToString(t),!1),l=c.textToUInt8Array(n,!0),u={name:"AES-CBC",iv:s},d=o.subtle.encrypt(u,i,l);const p=e=>{try{c.verifyResult(e,r)&&a(c.toBase64(c.bytesToText(e,!1)))}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};d.then(p,h)}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e)};d.then(p,h)}catch(e){r(e.toString())}}))}))}static decryptAES(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return yield this.loadCryptoModule(),new Promise(((a,r)=>{try{let l=(0,i.Uw)(s,c.base64ToBase64Url(e)),u={name:"AES-CBC"},d=o.subtle.importKey("jwk",JSON.parse(l),u,!0,["encrypt","decrypt"]);const p=e=>{try{let i=e,s=c.textToUInt8Array(c.base64ToString(t),!1),l=c.textToUInt8Array(c.base64ToString(n),!1),u={name:"AES-CBC",iv:s},d=o.subtle.decrypt(u,i,l);const p=e=>{try{c.verifyResult(e,r)&&a(c.bytesToText(e,!0))}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};d.then(p,h)}catch(e){r(e.toString())}},h=e=>{c.verifyResult(e,r)&&r(e.toString())};d.then(p,h)}catch(e){r(e.toString())}}))}))}static textToUInt8Array(e,t){e=t?encodeURI(e):e;let n=[];for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return new Uint8Array(n)}static bytesToText(e,t){let n=(0,r.convertArrayBufferToBinaryString)(e);return t?decodeURI(n):n}static base64ToBase64Url(e){return e.replace(new RegExp("\\+","g"),"-").replace(new RegExp("/","g"),"_").replace(new RegExp("=","g"),"")}static verifyResult(e,t){return null!=e||(t("result undefined"),!1)}static base64ToString(e){if(!l)return o.base64ToString(e);for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return atob(e)}static toBase64(e,t){if(!l)return o.toBase64(e);let n="";return t||(t=!1),n=btoa(e),t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):n}}},32964:function(e,t,n){"use strict";n.d(t,{F:function(){return i},P:function(){return a}});class a{constructor(e="",t,n){if(this.message=e,this.errorCode=t,this.errorInfo=n,this.name="ShellException",null!=n)for(let e of Object.keys(n))this[e]=n[e]}}class i extends a{constructor(e="",t,n){super(e,t,n),this.message=e,this.errorCode=t,this.errorInfo=n,this.name="RequestExecutorException"}}},25889:function(e,t,n){"use strict";n.d(t,{F:function(){return a}});class a{}a.GET="GET",a.POST="POST",a.PUT="PUT",a.PATCH="PATCH",a.DELETE="DELETE"},89990:function(e,t,n){"use strict";n.d(t,{DP:function(){return h},Dm:function(){return g},EE:function(){return s},H1:function(){return p},JP:function(){return m},OH:function(){return l},OX:function(){return u},UU:function(){return c},YG:function(){return o},e1:function(){return i},fL:function(){return a},lq:function(){return r},vK:function(){return d}});const a="Request was aborted or timed out",i="Browser not supported",r="Invalid field or parameter {0}",s="Cannot access {0}",o="Binary data not supported",l="Invalid operation",c="Session storage error",u="Unable to parse json",d="Status:{0}, Content-type:{1}",p="Access denied",h="Timeout due to trusted sites",g="Could not find IFrame element.",m="Message listener is not attached."},9264:function(e,t,n){"use strict";n.r(t),n.d(t,{BooleanTypeString:function(){return d},DevFabricOwsRelativePath:function(){return y},FunctionTypeString:function(){return p},NumberTypeString:function(){return h},OwaIFrameID:function(){return g},OwsRelativePath:function(){return S},PostMessageIdPrefix:function(){return C},StringTypeString:function(){return u},SuiteServiceApiRelativePath:function(){return f},TokenFactoryIFrameID:function(){return m},buildIframeResourceData:function(){return R},buildUrl:function(){return O},checkBrowserBinaryDataSupport:function(){return B},convertArrayBufferToBinaryString:function(){return U},convertBinaryStringToXmlHttpRequestBody:function(){return F},createInvalidParameterException:function(){return w},encodeUrlForXmlHttpRequest:function(){return G},endsWith:function(){return j},ensureAttachMessageListener:function(){return W},getCurrentWindowLocation:function(){return v},getFrameElement:function(){return $},getFrameID:function(){return ee},getUrlAuthorityPart:function(){return k},getUrlDomainPart:function(){return x},getUrlPath:function(){return L},getXMLHttpRequest:function(){return E},getXMLHttpResponseLength:function(){return te},isFullUrl:function(){return T},isNullOrEmptyString:function(){return A},parseQueryString:function(){return N},parseResponseHeaders:function(){return M},reportSimpleError:function(){return _},startsWith:function(){return H},urlEncodeCore:function(){return Y},validateField:function(){return I},validateFullUrl:function(){return D},validateRequestInfo:function(){return P}});var a=n(62244),i=n(91011),r=n(37005),s=n(56597),o=n(32964),l=n(89990),c=n(79487);const u="string",d="boolean",p="function",h="number",g="o365shellowaframe",m="o365shellwcssframe",f="O365SuiteService/api/",S="owa/service.svc",y="SuiteService.svc",C="SP.RequestExecutor",b="https://";function I(e,t,n,i){if(i){if(null==e||typeof e!==n)throw new o.F((0,a.Uw)(l.lq,t),-2001)}else if(null!=e&&typeof e!==n)throw new o.F((0,a.Uw)(l.lq,t),-2001)}function T(e){return e.substr(0,b.length).toLowerCase()===b}function D(e,t){if(!T(e))throw w(t)}function v(){return window.location.href}function w(e){return new o.F((0,a.Uw)(l.lq,e),-2001)}function A(e){return""===e||null==e}function O(e,t){if(D(e,"baseUrl"),T(t))return t;if("/"===t.charAt(0)){let n=e.indexOf("://");return n=e.indexOf("/",n+3),n>0&&(e=e.substr(0,n)),e+t}return"/"!==e.charAt(e.length-1)&&(e+="/"),e+t}function x(e,t=!1){t&&D(e,"url");let n=e.indexOf("://");return n=e.indexOf("/",n+3),n>0&&(e=e.substr(0,n)),e.substr(0,b.length).toLowerCase()===b&&":443"===e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),e}function L(e){let t="",n=x(e);const a=e.indexOf("?");return t=a>n.length+1?e.substring(n.length+1,a):e.substring(n.length+1,e.length),t}function k(e){return(e=x(e)).substr(0,b.length).toLowerCase()===b&&(e=e.substr(b.length)),e.toLowerCase()}function R(e,t){const n=(0,r.BL)(t.ShellResources.crossdomainproxyiframe),a=(0,r.BL)(t.ShellResources.msaltokenfactoryiframe);return{version:e,crossdomainproxyJsHash:n.hash,msaltokenfactoryJsHash:a.hash,resourceCatalogHostUrl:t.ResourceCatalogHostUrl}}function E(){if(!("XMLHttpRequest"in window))throw new o.F(l.e1,-2003);return new XMLHttpRequest}function P(e){if(null==e)throw w("requestInfo");if(I(e.url,"requestInfo.url",u,!0),I(e.body,"requestInfo.body",u,!1),I(e.success,"requestInfo.success",p,!1),I(e.error,"requestInfo.error",p,!1),I(e.timeout,"requestInfo.timeout",h,!1),I(e.method,"requestInfo.method",u,!1),I(e.binaryStringRequestBody,"requestInfo.BinaryRequestBody",d,!1),I(e.binaryStringResponseBody,"requestInfo.BinaryResponseBody",d,!1),A(e.method)?e.method="GET":e.method=e.method.toUpperCase(),null==e.timeout&&(e.timeout=s.K.DefaultTimeout),e.timeout<0)throw w("requestInfo.timeout");if(A(e.url))throw w("requestInfo.url")}function U(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.length;e++)t+=String.fromCharCode(n[e]);return t}function F(e){let t=null;if(typeof e===u){let n=new ArrayBuffer(e.length),a=new Uint8Array(n);for(let t=0;t<e.length;t++)a[t]=255&e.charCodeAt(t);let i=new Blob([n]);t=i||n}return t}function N(e){let t="";const n=e.indexOf("?");return n>0&&(t=e.substr(n+1,e.length)),t}function M(e){let t={};if(null!=e){let n=new RegExp("\r?\n"),a=e.split(n);for(let e of a)if(null!=e){let n=e.indexOf(":");if(n>0){let a=e.substr(0,n),i=e.substr(n+1);a=q(a),i=q(i),t[a.toUpperCase()]=i}}}return t}function q(e){return e.replace(/^\s+|\s+$/g,"")}function H(e,t){return 0===e.lastIndexOf(t,0)}function j(e,t){let n=e.lastIndexOf(t);return-1!==n&&n===e.length-t.length}function B(){if(!("ArrayBuffer"in window))throw(0,i.jl)().tag("RequestExecutor_ArrayBufferNotSupported",6,-2003,l.YG),new o.F(l.YG,-2003);if(!("Uint8Array"in window))throw(0,i.jl)().tag("RequestExecutor_Uint8ArrayNotSupported",6,-2003,l.YG),new o.F(l.YG,-2003);if(!("BlobBuilder"in window)&&!("MozBlobBuilder"in window)&&!("Blob"in window))throw(0,i.jl)().tag("RequestExecutor_BlobBuilderNotSupported",6,-2003,l.YG),new o.F(l.YG,-2003)}function W(e){if(window.addEventListener)return window.addEventListener("message",e,!1),!0;throw new o.F(l.JP,-2002)}function _(e,t,n,a){if(null!=e.error){let i={state:e.state,body:""};a&&(n=`${n} target: ${a}`),e.error(i,t,n)}else(0,i.jl)().tag("RequestExecutor_NoErrorCallback",6,t.toString(),n)}function G(e){return Y(e,!0,!0)}const K=224,z=192,V=240,Z=128,Q=55296,X=64512,J=65536;function Y(e,t,n){let a,i="";if(A(e)||void 0===e||0===e.length)return"";for(let r=0;r<e.length;r++){let s=e.charCodeAt(r),o=e.charAt(r);if(t&&("#"===o||"?"===o)){i+=e.substr(r);break}if(s<=127)n||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s>=32&&s<=95&&" \"%<>'&".indexOf(o)<0?i+=o:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase());else if(s<=2047)a=z|s>>6,i+="%"+a.toString(16).toUpperCase(),a=Z|63&s,i+="%"+a.toString(16).toUpperCase();else if((s&X)!==Q)a=K|s>>12,i+="%"+a.toString(16).toUpperCase(),a=Z|(4032&s)>>6,i+="%"+a.toString(16).toUpperCase(),a=Z|63&s,i+="%"+a.toString(16).toUpperCase();else if(r<e.length-1){s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),s+=J,a=V|s>>18,i+="%"+a.toString(16).toUpperCase(),a=Z|(258048&s)>>12,i+="%"+a.toString(16).toUpperCase(),a=Z|(4032&s)>>6,i+="%"+a.toString(16).toUpperCase(),a=Z|63&s,i+="%"+a.toString(16).toUpperCase()}}return i}function $(e){return document.getElementById(ee(e))}function ee(e){switch(e){case c.o.OWA:return g;case c.o.TokenFactory:return m;default:return(0,i.jl)().tag("RequestExecutor_UnsupportedFrameCodeSpecified",6),""}}function te(e){return"arraybuffer"===e.responseType?e.response?e.response.byteLength:0:e.responseText?e.responseText.length:0}},85884:function(e,t,n){"use strict";var a;n.d(t,{v:function(){return a}}),function(e){e[e.NoExoLicense=1]="NoExoLicense",e[e.Brs=2]="Brs",e[e.TokenExpired=3]="TokenExpired",e[e.LanguageNotSet=4]="LanguageNotSet",e[e.InitFailed=5]="InitFailed",e[e.SecurityZoneMismatched=6]="SecurityZoneMismatched",e[e.IframeLoadError=7]="IframeLoadError",e[e.CallerOriginNotAllowed=8]="CallerOriginNotAllowed",e[e.InvalidMailbox=9]="InvalidMailbox",e[e.ShardMailbox=10]="ShardMailbox",e[e.ShardNotDetected=11]="ShardNotDetected",e[e.Pwa=12]="Pwa"}(a||(a={}))},41018:function(e,t,n){"use strict";n.d(t,{W:function(){return r}});var a=n(9264),i=n(92030);n(78453);class r{static onBeforeSendRequestSuiteService(e,t,n){if(null!=n&&null!=n.userMailboxType&&null!=t&&-1!==a.parseQueryString(t.url.toLowerCase()).indexOf("getowauserconfiguration"))try{JSON.parse(n.userMailboxType)}catch(e){}{let t="X-OWA-CANARY",n="X-OWA-CANARY-DEBUG",a=(0,i.e)(t),r=(0,i.e)(n);return null!=a&&e.setRequestHeader(t,a),null!=r&&e.setRequestHeader(n,r),null}}static validateOriginWithAllowedEndpoints(e,t){let n=[];for(let e=0;e<t.length;e++)n[e]=t[e].host;return r.validateOrigin(a.getUrlAuthorityPart(e),n)}static validateOrigin(e,t){if(null==t||e.length>253)return!1;let n,a=!1;for(let i=0;i<t.length;i++)if(""!==t[i]&&(n=new RegExp(t[i],"i"),n.test(e))){a=!0;break}return a}static validatePathWithAllowedEndpoints(e,t){if(a.isNullOrEmptyString(e))return!1;let n,i=!1;const r=a.getUrlAuthorityPart(e),s=a.getUrlPath(e);for(let e of t)if(n=new RegExp(e.host,"i"),n.test(r)){if(null==e.paths)return!1;for(let t of e.paths)if(n=new RegExp(t,"i"),n.test(s)){i=!0;break}break}return i}static validatePathWithAllowedResources(e,t,n){if(null==e||a.isNullOrEmptyString(t)||null==n)return!1;let i,r=!1;const s=a.getUrlAuthorityPart(e),o=a.getUrlAuthorityPart(t);for(let e of n){let t=!1;if("^"===e.resource.charAt(0))i=new RegExp(e.resource,"i"),t=i.test(s);else{t=a.getUrlAuthorityPart(e.resource)===s}if(t){if(null==e.hosts)return!1;for(let t of e.hosts){let e=!1;if("^"===t.charAt(0))i=new RegExp(t,"i"),e=i.test(o);else{e=a.getUrlAuthorityPart(t)===o}if(e){r=!0;break}}break}}return r}static isAllowedApi(e){if(null==e)return!1;let t=a.getUrlPath(e);if(t in r.allowedPath){if(!r.allowedPath[t])return!0;if(a.parseQueryString(e).replace("&UA=0","")in r.allowedListOfApi)return!0}else if(a.startsWith(t,a.SuiteServiceApiRelativePath))return!0;return("owa/ev.owa2"===t||"ev.owa2"===t)&&r.checkAllowedPgmParameters(e)}static checkAllowedPgmParameters(e){if(a.isNullOrEmptyString(e)||""===e.trim())return!1;let t=e.split("?");if(2===t.length){let e=t[1];if(a.isNullOrEmptyString(e)||""===e.trim())return!1;let n=e.split("&");for(let e of n){let t=e.split("=");if(2!==t.length)return!1;if(!(t[0]in r.AllowedPgmQueryStringParametersList))return!1}return!0}return!1}static createAllowedPgmParamters(){return{ecnsq:!0,brwnm:!0,cid:!0,syncFnshRq:!0,ns:!0,ev:!0,Fn:!0,UA:!0,"UX-E4E-CANARY":!0,"X-OWA-CANARY":!0,"X-OWA-CANARY-DEBUG":!0,"X-E4E-CANARY-DEBUG":!0}}static createAllowedApiList(){return{"action=GetReminders":!0,"action=GetOwaUserConfiguration":!0,"action=SetNotificationSettings":!0,"action=FindItem":!0,"action=GetUserAvailabilityInternal":!0,"action=GetCalendarFolders":!0,"action=ProcessSuiteStorage":!0,"action=SubscribeToNotification":!0,"action=PerformReminderAction":!0,"action=GetOwaUserOofSettings":!0,"action=SetUserTheme":!0,"action=SetUserLocale":!0,"action=UnsubscribeToNotification":!0,"action=GetDaysUntilPasswordExpiration":!0,"action=GetModernGroups":!0,"action=GetModernGroup":!0,"action=GetModernGroupUnseenItems":!0,"action=GetCalendarFolderConfiguration":!0,"action=SubscribeToGroupUnseenNotification":!0,"action=SubscribeToGroupNotification":!0,"action=GetSocialActivityNotifications":!0,"action=GetSocialActivityNotifications2":!0,"action=MarkSocialActivityNotificationsAsSeen":!0,"action=MarkSocialActivityNotificationsAsSeen2":!0,"action=GetBingHelpSearchResults":!0,"action=GetMailboxRegionalConfiguration":!0,"action=SetMailboxRegionalConfiguration":!0,"format=json":!0,"api-version=1":!0,"action=TestAddReminders":!0,"action=TestDeleteAllReminders":!0,"action=TestAddItems":!0,"action=TestDeleteAllItems":!0,"action=TestAddCalendarFolders":!0,"action=TestAddCalendarGroups":!0,"action=TestDeleteAllCalendarFolders":!0,"action=TestDeleteAllCalendarGroups":!0,"action=TestAddUserAvailability":!0,"action=TestDeleteAllUserAvailability":!0,"action=TestAddOwaUserOofSettings":!0,"action=TestDeleteNotifications":!0,"action=TestAddNotifications":!0,"action=TestGetSettings":!0}}static createAllowedPath(){return{[a.OwsRelativePath]:!0,"SuiteService.svc/":!0,"SuiteService.svc":!0,"owa/ev.owa2":!0,"ev.owa2":!0,"Microsoft.Online.BOX.Admin.UI.SystemAlert.GetAlerts.model":!0,"Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetPrePinnedAppTiles.model":!0,"Microsoft.Online.BOX.Admin.UI.AppHub.AppUICallbacks.GetAllAppTilesForAllCollectors.model":!0,"api/myapps/GetAllApps":!1,"api/myapps/GetAppDetails":!1,"api/myapps/GetCompleteAppData":!1,"api/myapps/ExecuteAppCustomAction":!1,"api/myapps/ActivatePendingProvisioningApps":!1,"owa/service.svc/s/GetPersonaPhoto":!1,"api/settings/cards":!1,"api/settings/cards/data":!1,"api/settings/theme":!1,"api/settings/darkmode":!1,"api/settings/language":!1,"api/settings/contactPreferences":!1,"api/NotificationsSettings/User":!1,"api/settings/SPO/MySiteUrl":!1,"api/settings/regiontimezone":!1,"api/profile/photo":!1,"v1.0/me/photo/$value":!1,"api/storage/CustomerContent/Tenant/CustomSupportData":!0}}}r.allowedPath=r.createAllowedPath(),r.allowedListOfApi=r.createAllowedApiList(),r.AllowedPgmQueryStringParametersList=r.createAllowedPgmParamters()},2221:function(e,t,n){"use strict";n.r(t),n.d(t,{XSuiteError:function(){return p},convertErrorToException:function(){return C},generateCorrelationId:function(){return m},genericServiceExceptionLog:function(){return I},genericServiceRejection:function(){return T},getOwaError:function(){return S},getOwaServerName:function(){return f},isCallsBlockedException:function(){return b}});var a=n(62244),i=n(91011),r=n(17698),s=n(32964);class o{constructor(e){this.value=e}static newSuid(){const e=(new Date).getTime();return o.disambiguationIndex=99===o.disambiguationIndex?0:o.disambiguationIndex+1,new o(100*e+o.disambiguationIndex)}}o.disambiguationIndex=-1;const l="X-OWA-ERROR",c="X-OWA-CORRELATIONID",u="X-FESERVER",d="X-BESERVER",p="X-SUITE-ERROR",h="FE_{0}_BE_{1}",g=[c,u,d,l,p];function m(e){return e+"_"+o.newSuid().value.toString()}function f(){return(0,a.Uw)(h,r.e.Instance.OwaFrontEndServerName,r.e.Instance.OwaBackEndServerName)}function S(e){return null==e?null:(null!=e[u]&&(r.e.Instance.OwaFrontEndServerName=e[u]),null!=e[d]&&(r.e.Instance.OwaBackEndServerName=e[d]),e[l])}const y="errorCode";function C(e,t,n,...a){let i=function(e){let t={};if(null!=e&&(t.HttpStatus=e.statusCode,null!=e.headers))for(let n of g)null!=e.headers[n]&&(t[n]=e.headers[n]);return t}(e);i[y]=t;let r=0;for(let e of a)i["arg"+r]=e,r++;return new s.P(n,t,i)}function b(e){return-1010===e.errorCode||-1007===e.errorCode}function I(e,t,n){if(n){const r=n.errorCode||"",s=n.errorInfo&&n.errorInfo.HttpStatus?n.errorInfo.HttpStatus:"",o=n[l]||n[p]||"",g=null!=n[u]&&null!=n[d]?(0,a.Uw)(h,n[u],n[d]):"",m=n[c]||"";(0,i.jl)().exception(e,t,n,r,s,o,g,m)}else(0,i.jl)().exception(e,t,n)}function T(e,t,n,a){b(n)&&I(e,t,n),a(n)}},99964:function(e,t,n){"use strict";n.d(t,{J:function(){return c}});var a=n(9264),i=n(92030),r=n(32964),s=n(89990),o=n(15312);const l="$";class c{static processRequest(e,t){let n={},l=(0,i.e)("SuiteServiceProxyKey"),u=null,d=null;if(a.isNullOrEmptyString(l)){if(l=(0,i.e)("ClientStorageCookie"),a.isNullOrEmptyString(l))throw new r.P(s.UU,-2007);l=decodeURIComponent(l)}const p=l.split("&");if(2!==p.length)throw new r.P(s.UU,-2007);if(u=p[0],d=p[1],a.isNullOrEmptyString(e.UserId))throw new r.P(s.UU,-2004);let h=window.sessionStorage;if(null==h)throw new r.P(s.UU,-2005);try{let a=e.UserId;const i=a=>{h.setItem("CurrentUserId",a),c.doClearAll(e,n,h),c.doDeletes(e,n,h),c.doWritesAndReads(e,u,d,h,n,t)},l=e=>{const a=null==e?s.UU:e;n.ResetError=new r.P(a,-2008),t(n)};o.F.computeSHA256(a).then(i).catch(l)}catch(e){n.ResetError=e,t(n)}}static doClearAll(e,t,n){try{if(!0===e.ClearAll){const e=Object.keys(n);c.doDeletes({Deletes:e},t,n)}}catch(e){t.ClearError=e}}static doDeletes(e,t,n){try{if(null!=e.Deletes)for(let t of e.Deletes)n.removeItem(t)}catch(e){t.DeleteError=e}}static doWritesAndReads(e,t,n,a,i,r){try{null!=e.Writes?c.encryptWrites(t,n,e.Writes,0,a,(()=>{c.doReads(e,t,n,a,i,r)}),(s=>{i.WriteError=s,c.doReads(e,t,n,a,i,r)})):c.doReads(e,t,n,a,i,r)}catch(s){i.WriteError=s,c.doReads(e,t,n,a,i,r)}}static doReads(e,t,n,a,i,r){try{if(null!=e.Reads){let s={};c.decryptReads(t,n,e.Reads,0,s,a,(e=>{i.Reads=e,r(i)}),(e=>{i.ReadError=e,r(i)}))}}catch(e){i.ReadError=e,r(i)}}static encryptWrites(e,t,n,a,i,u,d){null!=n&&a<n.length?null==e?(i.setItem(n[a].Key,n[a].Value),c.encryptWrites(e,t,n,a+1,i,u,d)):o.F.encryptAES(e,t,l+n[a].Value+l).then((r=>{i.setItem(n[a].Key,r),c.encryptWrites(e,t,n,a+1,i,u,d)})).catch((e=>{let t=null==e?s.UU:e;d(new r.P(t,-2009))})):u()}static decryptReads(e,t,n,i,s,u,d,p){if(null!=n&&i<n.length){let h=n[i],g=u.getItem(h);null===g?c.decryptReads(e,t,n,i+1,s,u,d,p):(null===e&&(s[h]=g,c.decryptReads(e,t,n,i+1,s,u,d,p)),o.F.decryptAES(e,t,g).then((r=>{null==r||!a.startsWith(r,l)||!a.endsWith(r,l)||r.length<2?c.doClearAll({ClearAll:!0},{},u):s[h]=r.substr(1,r.length-2),c.decryptReads(e,t,n,i+1,s,u,d,p)})).catch((a=>{"OperationError"===a?(c.doClearAll({ClearAll:!0},{},u),c.decryptReads(e,t,n,i+1,s,u,d,p)):p(new r.P(a))})))}else d(s)}}},20851:function(e,t,n){"use strict";n.d(t,{Pp:function(){return o.P},FH:function(){return d.F},uJ:function(){return g.u},Ou:function(){return i.Ou},xX:function(){return l},t6:function(){return r.t},vj:function(){return p.v},LU:function(){return h},es:function(){return s.e},fO:function(){return u},$_:function(){return S}});var a=n(56597),i=n(84185),r=n(39013),s=n(17698),o=n(32964),l=(n(41018),n(9264)),c=n(89990);class u{static checkScope(e,t){if(null!=e&&!(0,l.startsWith)(e,t+u.DictionaryStringPartsSeparator))throw new o.P(c.H1,-2010)}}u.SuiteScope="O365S",u.DictionaryStringPartsSeparator="//";var d=n(25889),p=n(85884),h=(n(99964),n(15312),n(2221)),g=n(78453);let m=null;try{window.MSA&&window.MSA.MeControl&&(m=window.MSA.MeControl.UserStateModel)}catch(e){}class f{}function S(){"complete"===document.readyState?a.K.internalProcessWindowLoad():window.onload=a.K.internalProcessWindowLoad}f.MSA="msa",f.AAD="aad",f.MSAFed="msaFed"},62452:function(e,t,n){"use strict";var a,i;n.d(t,{A:function(){return i},C:function(){return a}}),function(e){e.LifeCycle="LifeCycle",e.DataProviderResponseNotification="DataProviderResponseNotification",e.ChallengeToken="ChallengeToken"}(a||(a={})),function(e){e.GetConfig="GetConfig",e.RefreshToken="RefreshToken",e.PageReady="PageReady",e.Closed="Closed",e.FatalError="FatalError"}(i||(i={}))},78453:function(e,t,n){"use strict";var a;n.d(t,{u:function(){return a}}),function(e){e.Ping="Ping",e.Query="Query",e.OwaUserConfig="OwaUserConfig",e.TokenPrefetch="TokenPrefetch",e.Storage="Storage",e.Notification="Notification",e.UserState="UserState",e.SignalR="SignalR",e.IncomingOpxMessage="IncomingOpxMessage",e.OutgoingOpxMessage="OutgoingOpxMessage",e.RegisterOpxHost="RegisterOpxHost"}(a||(a={}))},32825:function(e,t,n){"use strict";n.d(t,{GD:function(){return a}});const a="cdn-url#oneshell"},51932:function(e,t,n){"use strict";n.d(t,{AQ:function(){return u},UN:function(){return p},W3:function(){return h},e9:function(){return d},o0:function(){return o},yX:function(){return c}});var a=n(81494),i=n(91011),r=n(72607),s=n(51031);const o={IsVirtual:!0,ParallelView:!0,Style:"o365shell",CanCollapse:!0,SuppressBackgroundRinging:!0};let l;function c(e,t){!t&&swc&&(e?swc.API.triggerEvent(a.X_.ApiRecentsShown):swc.API.triggerEvent(a.X_.ApiRecentsHidden))}function u(e,t){!t&&swc&&swc.SDK.Recents.refreshDOM(e)}function d(e,t,n){!n&&swc?(swc.API.registerEvent(a.X_.ApiRecentsReady,t),swc.create(a.PO.Recents,{},e)):n&&(l=e)}function p(e,t){TeamsClient&&TeamsClient.client&&TeamsClient.client.conversations.get().then((n=>{n.render(l).then(e),n.subscribe((e=>{e.type===s.q.ConversationOpened&&t(!1,r.vP)}))}))}function h(e,t){swc&&swc.getPresence().then((t=>{t.setMyStatus(e.key)})).catch((e=>{(0,i.jl)().exception("UserPresence_SetMyStatus_Exception",6,e),t()}))}},81494:function(e,t,n){"use strict";var a,i,r;n.d(t,{PO:function(){return r},X_:function(){return a},l$:function(){return i}}),function(e){e.ChatCoreReady="swc:core:ready",e.ChatAPIReady="swc:ready",e.ApiRecentsReady="recentsReady",e.ApiRecentsShown="recentsShown",e.ApiRecentsHidden="recentsHidden",e.ApiUnreadConversationUpdate="unreadConversationsUpdate",e.ApiStartChat="startChat",e.ApiOnCallStart="onCallStart",e.ApiRecentItemsLoaded="recentItemsLoaded",e.ApiOnRecentItemSelected="onRecentItemSelected"}(a||(a={})),function(e){e.ChatRecents="skype-recents",e.ChatWrapper="chat-wrapper"}(i||(i={})),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(r||(r={}))},51031:function(e,t,n){"use strict";var a,i;n.d(t,{k:function(){return a},q:function(){return i}}),function(e){e[e.UnreadCounterUpdate=0]="UnreadCounterUpdate"}(a||(a={})),function(e){e.TeamsChatAPIReady="ms-teams-sdk-loaded",e.TeamsChatAuthFailed="ms-teams-sdk-auth-failed",e.ConversationOpened="conversationOpened",e.KeyPressed="keyPressed"}(i||(i={}))},40719:function(e,t,n){"use strict";n.d(t,{Ak:function(){return c},D:function(){return i},M3:function(){return l},P7:function(){return r},YI:function(){return o},nZ:function(){return s},q:function(){return a}});const a="suiteux-chat.UPDATE_IS_CHAT_RECENTS_INITIALIZED",i="suiteux-chat.UPDATE_IS_CHAT_API_INITIALIZED",r="suiteux-chat.UPDATE_IS_CHAT_API_PREAUTH_COMPLETED",s="suiteux-chat.UPDATE_UNREAD_CONVERSATION_COUNT",o="suiteux-chat.UPDATE_IS_TEAMS_CHAT_ACTIVATED",l="suiteux-chat.UPDATE_IS_TEAMS_CHAT_AUTH_FAILED",c="suiteux-chat.UPDATE_INIT_CHAT_IN_FIRST_CLICK"},93643:function(e,t,n){"use strict";n.d(t,{Ou:function(){return T.Ou},xV:function(){return i.x},Zo:function(){return r.Z},tw:function(){return a.t},BH:function(){return g.B},Eg:function(){return s.E},GI:function(){return o.G},ri:function(){return T.ri},Q:function(){return T.Q},lD:function(){return h},hs:function(){return T.hs},C1:function(){return T.C1},__:function(){return T.__},Eb:function(){return y},Zp:function(){return M},yw:function(){return P.yw},aM:function(){return N.aM},y3:function(){return w},mI:function(){return A},iv:function(){return k.i},Jb:function(){return I.Jb},Mq:function(){return N.Mq},RF:function(){return R},vo:function(){return E},M1:function(){return O},Y5:function(){return U.Y5},GS:function(){return L},g6:function(){return C},Uw:function(){return S.Uw},ef:function(){return x.e},Wu:function(){return S.Wu},xH:function(){return S.xH},pG:function(){return b},Vz:function(){return v},nJ:function(){return P.nJ},Te:function(){return P.Te},ir:function(){return P.ir},YA:function(){return D.Y},NN:function(){return F},gJ:function(){return I.gJ},uS:function(){return I.uS}});var a=n(33836),i=n(73225),r=n(57931),s=(n(31089),n(6867)),o=n(53106),l=n(64731),c=n(27676),u=n(5746),d=n(58930),p=n(35439);class h extends l.Component{constructor(e){super(e),this.setRef=e=>this.searchControl=e,this.SearchBarKey=e=>{let t=e.currentTarget.value;this.setState((()=>({currentSearchText:t,showDismissButton:!0}))),this.props.onSearch(t)},this.DismissDefaultText=()=>{this.state.clearTextOnFocus?this.setState((()=>({currentSearchText:"",showDismissButton:!1}))):this.setState((()=>({showDismissButton:!0,clearTextOnFocus:!0})))},this.DefaultSearchText=()=>{""===this.state.currentSearchText?this.setState((()=>({currentSearchText:this.props.defaultText,showDismissButton:!1}))):this.setState((()=>({clearTextOnFocus:!1})))},this.ButtonClearText=()=>{this.searchControl.focus(),this.searchControl.placeholder="",this.setState((()=>({currentSearchText:"",showDismissButton:!1}))),this.props.onSearch("")},this.moveCursor=()=>{this.searchControl.focus()},this.props.currentSearchText?this.state={currentSearchText:this.props.currentSearchText,showDismissButton:!0,clearTextOnFocus:!1}:this.state={currentSearchText:this.props.defaultText,showDismissButton:!1,clearTextOnFocus:!0}}getSearchResultAriaLabel(){return(0,S.xH)(this.state.currentSearchText)?"":(0,S.Uw)(c.b.SearchBoxResultAriaLabel,`${this.props.searchResultCount}`)}render(){let e=(0,d.j)(),t=(0,p.E)();return l.createElement("div",{className:(0,k.i)(u.SearchControl,t?u.SearchControlZoomMargin:null,e.neutral.foregroundAlt.background)},l.createElement("div",{"aria-live":"polite",style:{position:"absolute",left:"-999em",top:"0em"}},this.getSearchResultAriaLabel()),this.state.showDismissButton?l.createElement("button",{onClick:this.ButtonClearText,"aria-label":c.b.SearchBoxClearButtonText,title:c.b.SearchBoxClearButtonText},l.createElement(g.B,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--ChromeClose",fontSize:"12"})):l.createElement("button",{onClick:this.moveCursor,tabIndex:-1,"aria-hidden":!0},l.createElement(g.B,{className:e.neutral.dark.font,fontIconCss:"ms-Icon--Search",fontSize:"12"})),l.createElement("input",{className:(0,k.i)(u.inputBox,e.neutral.dark.font),type:"text",onFocus:this.DismissDefaultText,value:this.state.currentSearchText,onChange:this.SearchBarKey,onBlur:this.DefaultSearchText,ref:this.setRef,placeholder:this.props.defaultText,id:"appLauncherSearch",autoComplete:"off","aria-label":this.props.ariaLabel||this.props.defaultText}))}}var g=n(87317),m=n(82973),f=n(91011),S=n(62244);class y extends l.Component{render(){var e,t,n,a,i;let r=(0,d.j)();if(null!=this.props.unseenItemCount&&0!==this.props.unseenItemCount){const s=null!==(e=this.props.badgeCharacter)&&void 0!==e?e:(0,S.Tn)(this.props.unseenItemCount);let o=(0,k.i)(m.unseenCount,r.accent.border,{[r.badge]:!this.props.isParentHovered},{[m.emptyBadge]:""===this.props.badgeCharacter},{[m.emptyBadgeDarkMode]:""===this.props.badgeCharacter&&this.props.isDarkMode}),c={};return(null===(t=this.props.badgeColors)||void 0===t?void 0:t.badgeColor)&&(c.backgroundColor=this.props.badgeColors.badgeColor),(null===(n=this.props.badgeColors)||void 0===n?void 0:n.badgeFontColor)&&(c.color=this.props.badgeColors.badgeFontColor),this.props.isParentHovered&&(c.boxSizing="border-box",c.border="1px solid",(null===(a=this.props.badgeColors)||void 0===a?void 0:a.badgeHoverColor)?c.backgroundColor=this.props.badgeColors.badgeHoverColor:c.backgroundColor=(0,f.q4)().getThemeData().AccentHover||"white",(null===(i=this.props.badgeColors)||void 0===i?void 0:i.badgeFontHoverColor)?c.color=this.props.badgeColors.badgeFontHoverColor:c.color="#106EBE"),l.createElement("div",{className:(0,k.i)(m.unseenitems,this.props.badgeStyles)},l.createElement("span",{style:c,className:o},s,this.props.children))}return null}}var C=n(48648),b=n(23825),I=n(46676),T=n(36198),D=n(80054);let v={notificationsEnabled:!1,toastsMuted:!1,bellHeaderButtonInLayout:!0,isSubscriptionReady:!1,systemNotificationsDisabled:!0,notifications:[]};n(3533);let w={timestamp:null,appsUpdateTimeSpan:null,appDataCache:null,moreAppDataAvailable:null,doNotCallGetAllAppsUntil:null};const A={isChatAPIInitialized:null,isChatRecentsPaneInitialized:!1,isChatAPIPreAuthCompleted:!1,unreadBadgeValue:0,chatEnabled:!1,chatWebLink:null,webChatSDKUrl:null,isTeamsChatActivated:!1,isTeamsChatAuthFailed:!1,chatButtonRenderedCallback:null,isConsumerShell:!1};let O={activeButtonId:"",customFlexPanes:{},customFlexPaneHash:void 0,customHeaderButtonFlexPaneTriggers:{},customHeaderButtons:[],badgeValues:{},badgeColors:{},badgeLabels:{},badgeCharacters:{},customFlexpaneWidth:void 0};n(12406),n(65527);var x=n(30884);n(56279);function L(e,t,n=0){let a=-1;for(let i=n;i<e.length;i++)if(t(e[i])){a=i;break}return a}var k=n(49876),R=n(86614),E=n(9028),P=n(1995),U=n(84159);function F(e,t,n=","){return e=e?e.toLowerCase().trim():"",(t?t.toLowerCase().split(n):[]).some((t=>t.trim()===e))}var N=n(26403),M=n(66337)},9028:function(e,t,n){"use strict";function a(e,t){if(null===e)throw new Error(`Error: ${t} is null.`)}function i(e,t){if(void 0===e)throw new Error(`Error: ${t} is undefined.`)}function r(e,t){a(e,t),i(e,t)}function s(e,t){if(r(e,t),0===e.length)throw new Error(`Error: ${t} is an empty string.`)}function o(e,t){if(r(e,t),0===e.length)throw new Error(`Error: ${t} is a null or empty array.`)}n.r(t),n.d(t,{throwOnNull:function(){return a},throwOnNullOrEmpty:function(){return s},throwOnNullOrEmptyArray:function(){return o},throwOnNullOrUndefined:function(){return r},throwOnUndefined:function(){return i}})},31833:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var a=n(91011);function i(){return new Promise(((e,t)=>{(0,a.Lo)().subscribe("SuiteAPILoaded",(n=>{let a=n.WebShellStorage.createWebShellStorageRequest();a.requestClearAll(),n.WebShellStorage.removeSessionStorage(a).then(e).catch(t)}),!0)}))}},56003:function(e,t,n){"use strict";n.d(t,{Gj:function(){return s},P2:function(){return l},WA:function(){return r},r2:function(){return i},wW:function(){return o}});var a=n(91011);const i="OPX",r="https://outlook.office.com",s=[r,"https://to-do.office.com","https://outlook-sdf.office.com"];function o(e){return{themeDarker:e.Darker,themeDark:e.Dark,themeDarkAlt:e.DarkAlt,themePrimary:e.Primary,themeSecondary:e.Secondary,themeTertiary:e.Tertiary,themeLight:e.Light,themeLighter:e.Lighter,themeLighterAlt:e.LighterAlt}}function l(){const e="hiddenOpxContainer";let t=document.getElementById(e);if(!t){let n=(0,a.aH)();if(n){let a=document.getElementById(n.top);a&&(t=document.createElement("div"),t.id=e,t.style.display="none",a.appendChild(t))}}return t}},98630:function(e,t,n){"use strict";n.d(t,{rP:function(){return a},tL:function(){return r},yo:function(){return i}});const a=6e4,i=60*a,r=24*i},26403:function(e,t,n){"use strict";n.d(t,{Mq:function(){return r},aM:function(){return i},w6:function(){return s}});var a=n(91011);function i(e,t,n){let a="?";return e.indexOf(a)>-1&&(a="&"),e+a+t+"="+n}function r(e){if(!e)return"";return encodeURI(e).replace(/#/g,"%23")}function s(e,t){if(null==e)return!0;if((e=(e=e.toLowerCase()).trim()).startsWith("https://")||!0===e.startsWith("http://"))return!0;{let n=e.indexOf("://"),i=null;return-1!==n&&(i=e.substring(0,n)),(0,a.jl)().tag("Unsafe URL: "+{beforeColonUrl:i},6),!t}}},97260:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var a=n(30720);function i(e){return{type:a.k,dttProps:e}}},30720:function(e,t,n){"use strict";n.d(t,{k:function(){return a}});const a="suiteux-dtt.UPDATE_PROPS"},84735:function(e,t,n){"use strict";function a(e){return null!=e&&0!==e.length&&e.some((e=>i(e)))}function i(e){return!(null==e||r(e.Id)||r(e.Text)||r(e.Url)&&null==e.Action)}function r(e){return""===e||null==e}n.d(t,{l:function(){return i},q:function(){return a}})},5719:function(e,t,n){"use strict";var a;n.d(t,{l:function(){return a}}),function(e){e[e.SystemAlert=0]="SystemAlert",e[e.ReminderNotification=1]="ReminderNotification"}(a||(a={}))},78031:function(e,t,n){"use strict";n.r(t);var a=n(91011),i=n(64731),r=n(25445),s=n(61371),o=n(93643),l=n(64252),c=n(46676),u=n(59633),d=n(2221),p=n(25190),h=n(15315),g=n(62244),m=n(71684),f=n(27676),S=n(79502),y=n(60331),C=n(20851);function b(e){return new Promise(((t,n)=>{let i=(0,o.Uw)("/api/myapps/GetIcon?appDataJson={0}",encodeURIComponent(JSON.stringify({Id:e.Id,CollectorId:e.CollectorId,Properties:e.Properties})));S.nR.Instance.Service.callWebClientShellServiceFunction(i,"GET",null,null).then((e=>{t(e)})).catch((e=>{C.LU.isCallsBlockedException(e)||(0,a.jl)().exception("AppsManager_GetAppIcon_Failed",6,e),n(e)}))}))}const I="AppsPinnedData",T=["FirstParty","SharePoint","Graph","LineOfBusiness","Dynamics"];class D extends i.Component{constructor(){super(...arguments),this.lastAppsPinnedDataWriteTimestampKey=new y.Qt("User","Suite","LastAppsPinnedDataWriteTimestamp"),this.cachedAppsDataKey=new y.Qt("User","Suite","CachedAppsData")}componentDidMount(){window.O365Shell.OnSuiteAPILoaded((()=>{this.initializeInternal()}))}componentDidUpdate(e){if(this.props.appsPinnedData&&e.appsPinnedData&&this.props.appsPinnedData!==e.appsPinnedData&&(!this.props.appsPinnedData.timestamp||!e.appsPinnedData.timestamp||this.props.appsPinnedData.timestamp>=e.appsPinnedData.timestamp)){this.hasAppsPinnedDataChanged(e.appsPinnedData)&&this.saveCustomization()}}render(){return null}initializeInternal(){const{appsPinnedData:e}=this.props;this.props.disableSessionStorageCache?this.updateAppsFromStorage():null!=e?Date.now()-this.props.timestamp<6e4?this.readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync().then((t=>{t&&e.timestamp<t?this.readAppsPinnedData(1):this.updateApps(e,!0)})).catch((()=>{this.readAppsPinnedData(3)})):this.readAppsPinnedData(2):this.readAppsPinnedData(0);const t=(0,a.Lo)();t.subscribe("AppIconRequested",(e=>{b(e).then((t=>{this.props.onSetImageDataUrl(e.CollectorId,e.Id,`data:${t.MimeType};base64,${t.Base64EncodedImage}`)})).catch((()=>{}))})),t.subscribe("AppDataDetailsRequested",(e=>{e.Id===m.tx?this.props.onSetAppDataDetails({CollectorId:"none",Details:f.b.M365AppTileDetails,EulaUrl:null,HomepageUrl:null,PrivacyUrl:null,SupportUrl:null,Publisher:null,Permissions:null,Id:m.tx}):this.getAppDataDetailsAsync(e).then((t=>{t.CollectorId=e.CollectorId,this.props.onSetAppDataDetails(t)})).catch((()=>{}))}),!0),t.subscribe("AppsReset",(()=>{this.props.onSetAppsPinnedData({apps:[]})})),t.subscribe("AppsUpdate",(()=>{this.updateAppsFromCollectors()}))}readAppsPinnedData(e){this.readAppsPinnedDataFromStorageAsync().then((e=>{this.updateApps(e,!0)})).catch((()=>{this.updateApps(this.props.appsPinnedData,!1),(0,a.jl)().tag("AppsManager_ReadAppsPinnedDataFromStorageReason",1,e)}))}updateApps(e,t){e&&e!==this.props.appsPinnedData&&void 0!==e.apps&&this.props.onSetAppsPinnedData(e),t&&this.props.onEnableCustomization(),this.readCachedAppsFromSessionStorageAsync().then((e=>{if(e){if(Date.now()-e.timestamp>this.props.appsUpdateTimeSpan||e.cultureName!==this.props.cultureName)this.updateAppsFromStorage();else{let t=!0;this.props.appDataCache&&!this.props.moreAppDataAvailable&&this.props.timestamp>=e.timestamp&&(t=!1),t&&this.updateMyApps(e.apps,1)}}else this.updateAppsFromStorage()})).catch((()=>{this.updateAppsFromStorage()}))}updateAppsFromStorage(){this.props.appDataCache&&!this.props.moreAppDataAvailable?this.updateAppsFromCollectors():this.readAppDataCacheFromStorageAsync().then((e=>{this.onReadAppDataCacheSucceeded(e)})).catch((()=>{this.updateAppsFromCollectors()}))}onReadAppDataCacheSucceeded(e){const t={};for(const n of T){const a=e[n];if(a&&a.Apps)t[n]=a.Apps;else{const e=this.props.appsData.filter((e=>e.CollectorId===n));e.length>0&&(t[n]=e)}}this.onAppDataDictionaryFetched(t,2),this.updateAppsFromCollectors()}updateAppsFromCollectors(){this.props.doNotCallGetAllAppsUntil&&this.props.doNotCallGetAllAppsUntil>Date.now()||this.getAllAppsFromCollectorsAsync().then((e=>{this.onGetAllAppsSucceeded(e)})).catch((()=>{this.invokeAppsUpdatedEvent(null,0,3)}))}onGetAllAppsSucceeded(e){if(0!==Object.keys(e).length){for(const t of T){if(!e[t]){const n=this.props.appsData.filter((e=>e.CollectorId===t));n.length>0&&(e[t]=n)}}this.onAppDataDictionaryFetched(e,3)}}onAppDataDictionaryFetched(e,t){e.FirstParty&&(e.FirstParty=this.getFirstPartyAppsFromAppsData(this.props.appsData,e.FirstParty)),this.updateMyApps(e,t),this.writeCachedAppsToSessionStorageAsync({timestamp:Date.now(),apps:e,cultureName:this.props.cultureName}).catch((()=>{}))}getFirstPartyAppsFromAppsData(e,t){const n=[];for(const a of e.filter((e=>"FirstParty"===e.CollectorId))){const e=(0,p.Bl)(t,"FirstParty",a.Id);null!=e&&(a.AlternateNames=e.AlternateNames,a.DateInstalled=e.DateInstalled),n.push(a)}if(!n.some((e=>"Partner"===e.Id))){const e=(0,p.Bl)(t,"FirstParty","Partner");null!=e&&n.push(e)}return n}updateMyApps(e,t){const n=this.aggregateAppDatas(e);this.props.onSetAppsData(n,t)}invokeAppsUpdatedEvent(e,t,n){const i={Apps:e,DataSource:t,FailureReason:n},r=null!=e?"AppsRetrievalSucceeded":"AppsRetrievalFailed";(0,a.Lo)().invoke(r,i)}hasAppsPinnedDataChanged(e){if(void 0===this.props.appsPinnedData.apps)return!1;const t=this.props.appsPinnedData.apps,n=e.apps;if(t.length!==n.length)return!0;for(let e=0;e<t.length;e++)if(t[e].CollectorId!==n[e].CollectorId||t[e].Id!==n[e].Id)return!0;return!1}saveCustomization(){const e=this.props.appsPinnedData.apps.map((e=>e.Id));(0,a.jl)().tag("AppsManager_SavingAppsCustomizationData",1,e.join());const t=Date.now();if("number"==typeof t)this.props.appsPinnedData.timestamp=t,this.props.appsPinnedData.cultureName=this.props.cultureName,this.writeAppsPinnedDataToStorageAsync(this.props.appsPinnedData).then((()=>{this.writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(this.props.appsPinnedData.timestamp).catch((()=>{}))})).catch((()=>{}));else{let e=null;try{e=Date.now.toString()}catch(e){}(0,a.jl)().tag("AppsManager_InvalidDateNowFunction",6,t,e)}}aggregateAppDatas(e){const t=[];for(const n of Object.keys(e))e[n]&&t.push(...e[n]);return t}readLastAppsPinnedDataWriteTimestampFromSessionStorageAsync(){return new Promise(((e,t)=>{const n=S.nR.Instance.WebShellStorage.createWebShellStorageRequest();n.requestRead(this.lastAppsPinnedDataWriteTimestampKey),S.nR.Instance.WebShellStorage.readSessionStorage(n).then((t=>{t.hasValue(this.lastAppsPinnedDataWriteTimestampKey)?e(t.getValue(this.lastAppsPinnedDataWriteTimestampKey)):e(null)})).catch((e=>{(0,a.jl)().exception("AppsManager_ReadLastAppsPinnedDataWriteTimestamp_Failed",6,e),t(e)}))}))}writeLastAppsPinnedDataWriteTimestampToSessionStorageAsync(e){return new Promise(((t,n)=>{const a=S.nR.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,this.lastAppsPinnedDataWriteTimestampKey),S.nR.Instance.WebShellStorage.writeSessionStorage(a).then((()=>{t(void 0)})).catch((e=>{(0,d.genericServiceRejection)("AppsManager_WriteLastAppsPinnedDataWriteTimestamp_Failed",6,e,n)}))}))}readAppsPinnedDataFromStorageAsync(){return new Promise(((e,t)=>{S.nR.Instance.WebShellStorage.readStorage(y.gD.User,y.rq.SystemMetadata,I).then((t=>{const n=t.value;n&&"string"==typeof n.timestamp&&(n.timestamp=(0,h.s)(n.timestamp).getTime()),e(n)})).catch((e=>{(0,d.genericServiceRejection)("AppsManager_ReadPinnedAppsData_Failed",6,e,t)}))}))}writeAppsPinnedDataToStorageAsync(e){if(e&&e.apps){const t=e.apps.length;e.apps=(0,p.Mj)(e.apps),t>e.apps.length&&(0,a.jl)().tag("AppsManager_WriteAppsPinnedData_Deduped",4,t,e.apps.length)}return new Promise(((t,n)=>{S.nR.Instance.WebShellStorage.writeStorage(y.gD.User,y.rq.SystemMetadata,I,e).then((()=>{t(void 0)})).catch((e=>{(0,d.isCallsBlockedException)(e)||(0,a.jl)().exception("AppsManager_WriteAppsPinnedData_Failed",6,e),n(e)}))}))}readAppDataCacheFromStorageAsync(){return new Promise(((e,t)=>{const n=(0,g.Uw)("/api/myapps/GetAppDataCache?hasMailboxInCloud={0}&culture={1}",this.props.hasMailboxInCloud.toString(),this.props.cultureName);S.nR.Instance.Service.callWebClientShellServiceFunction(n,"GET",null,null).then((t=>{e(t)})).catch((e=>{(0,d.isCallsBlockedException)(e)||(0,a.jl)().exception("AppsManager_ReadAppDataCacheFromWCSS_Failed",6,e),t(e)}))}))}getAllAppsFromCollectorsAsync(){return new Promise(((e,t)=>{const n=(0,g.Uw)("/api/myapps/GetAllApps?culture={0}",this.props.cultureName);S.nR.Instance.Service.callWebClientShellServiceFunction(n,"GET",null,null).then((t=>{e(t)})).catch((e=>{(0,d.isCallsBlockedException)(e)||(0,a.jl)().exception("AppsManager_AppCollectorFetch_Failed",6,e),t(e)}))}))}readCachedAppsFromSessionStorageAsync(){return new Promise(((e,t)=>{const n=S.nR.Instance.WebShellStorage.createWebShellStorageRequest();n.requestRead(this.cachedAppsDataKey),S.nR.Instance.WebShellStorage.readSessionStorage(n).then((t=>{t.hasValue(this.cachedAppsDataKey)?e(t.getValue(this.cachedAppsDataKey)):e(void 0)})).catch((e=>{(0,d.isCallsBlockedException)(e)||(0,a.jl)().exception("AppsManager_ReadCacheAppsData_Failed",6,e,e.errorCode),t(e)}))}))}writeCachedAppsToSessionStorageAsync(e){return new Promise(((t,n)=>{const a=S.nR.Instance.WebShellStorage.createWebShellStorageRequest();a.requestWrite(e,this.cachedAppsDataKey),S.nR.Instance.WebShellStorage.writeSessionStorage(a).then((()=>{t(void 0)})).catch((e=>{(0,d.genericServiceRejection)("AppsManager_WriteCacheAppsData_Failed",6,e,n)}))}))}getAppDataDetailsAsync(e){return new Promise(((t,n)=>{const i=(0,g.Uw)("/api/myapps/GetAppDetails?culture={0}",this.props.cultureName),r={CollectorId:e.CollectorId,Id:e.Id,Title:e.Title,Properties:e.Properties};S.nR.Instance.Service.callWebClientShellServiceFunction(i,"POST",null,r).then((e=>{t(e)})).catch((e=>{(0,d.isCallsBlockedException)(e)||(0,a.jl)().exception("Apps_FetchDetailsForCollector_Failed",6,e),n(e)}))}))}}const v=(0,s.connect)((e=>({appsData:e.appsDataState.apps,appsPinnedData:e.appLauncherState.appsPinnedData,cultureName:e.userState.cultureName,timestamp:e.appsManagerState.timestamp,appsUpdateTimeSpan:e.appsManagerState.appsUpdateTimeSpan,hasMailboxInCloud:e.userState.hasMailboxInCloud,appDataCache:e.appsManagerState.appDataCache,moreAppDataAvailable:e.appsManagerState.moreAppDataAvailable,doNotCallGetAllAppsUntil:e.appsManagerState.doNotCallGetAllAppsUntil,disableSessionStorageCache:(0,u.So)(e.shellInitDataState.clientData.WorkloadId,e.shellInitDataState.navBarData.CurrentMainLinkElementID)})),(e=>({onSetAppsData:(t,n)=>{e((0,c.Cj)(t,n))},onSetAppsPinnedData:t=>{e((0,l.$W)(t))},onEnableCustomization:()=>{e((0,l.wc)())},onSetImageDataUrl:(t,n,a)=>{e((0,c.bv)(t,n,a))},onSetAppDataDetails:t=>{e((0,l.lH)(t))}})))(D);function w(e,t){return t?Object.assign(Object.assign({},e),{appsUpdateTimeSpan:t.AppsUpdateTimeSpan,timestamp:t.Timestamp,appDataCache:t.AppDataCache,moreAppDataAvailable:t.MoreAppDataAvailable,doNotCallGetAllAppsUntil:t.DoNotCallGetAllAppsUntil}):e}let A={appsManagerState:function(e,t){if(!e){let n=t.shellInitData.shellInitDataState;e=w(o.y3,n.clientData)}if(t.type===o.ri){return w(e,t.shellClientData)}return e}};var O=n(32217),x=n(90711);let L=(0,o.ef)();class k{constructor(){this.callbackPairings=[]}IsCustomizationEnabled(){return L.getState().appLauncherState.isCustomizable}IsPinned(e,t){return null!=x.K2(L.getState().appLauncherState.pinnedAppTiles,e,t)}Pin(e,t){let n;"string"==typeof e?n=p.Bl(L.getState().appsDataState.apps,e,t):((0,a.jl)().tag("AppLauncher_PinnedCalledWithAppData",1),n=p.Bl(L.getState().appsDataState.apps,e.CollectorId,e.Id)),n&&L.dispatch((0,O.iR)(n))}Unpin(e,t){L.dispatch((0,O.v5)(e,t))}Reset(){(0,a.Lo)().invoke("AppsReset")}Update(){(0,a.Lo)().invoke("AppsUpdate")}OnAppsUpdated(e){let t=t=>{e(this.deepCloneAppsUpdatedEventArgs(t))},n=(0,a.Lo)(),i=n.subscribe("AppsRetrievalSucceeded",t,!0),r=n.subscribe("AppsRetrievalFailed",t,!0);return this.callbackPairings.push({successCallbackToken:i,failureCallbackToken:r}),i}RemoveOnAppsUpdated(e){let t=0,n=(0,a.Lo)();for(let a of this.callbackPairings){if(a.successCallbackToken===e){n.unsubscribe("AppsRetrievalSucceeded",a.successCallbackToken),n.unsubscribe("AppsRetrievalFailed",a.failureCallbackToken);break}t++}t<this.callbackPairings.length&&this.callbackPairings.splice(t,1)}GetAuthenticatedAppIcon(e,t){null==e.FontIconCss&&null==e.IconAnonymousUrl?b(e).then(t).catch((()=>{t(null)})):t(null)}deepCloneAppsUpdatedEventArgs(e){let t=JSON.parse(JSON.stringify(e));if(t.Apps)for(let e of t.Apps)"FirstParty"===e.CollectorId&&(e.Id=p._X(e.Id,"add"));return t}}function R(e,t){if(e.IsAuthenticated&&t.Timestamp>0){(0,a.Lo)().unsubscribe("ShellDataUpdated",R);let e=(0,o.ef)();r.render(i.createElement(s.Provider,{store:e},i.createElement(v,null)),document.createElement("div"))}}var E=n(84159);n(5719);let P;var U=n(3073),F=n(48212),N=n(72607),M=n(73750),q=n(70163),H=n(82548);class j extends i.Component{componentDidMount(){this.props.isAvailable&&(0,a.jl)().perfMarker("HelpTimeToInteractive")}render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:f.b.Help_Title,affordanceMenuItemText:f.b.Help,iconID:this.props.flipHelpIcon?"HelpMirrored":"Help",iconFontSize:H.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(q.sO,Object.assign({},e)):i.createElement(q.b,Object.assign({},e))}}const B=(0,s.connect)(((e,t)=>{var n,a;return{isAvailable:!(null===(a=null===(n=e.shellInitDataState)||void 0===n?void 0:n.clientData)||void 0===a?void 0:a.HelpPaneDisabled),id:t&&t.id,isActive:e.flexPaneState&&"Help"===e.flexPaneState.activeProviderKey,flipHelpIcon:e.headerState&&e.headerState.flipHelpIcon,controlDimensionsChanged:t.controlDimensionsChanged}}),(e=>({onClick:(t,n)=>{t.stopPropagation(),(0,a.jl)().click("Help","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}`),e((0,o.uS)(t&&t.currentTarget&&t.currentTarget.id));let i=(0,a.aH)();!i||null!=i.OnHelpButtonClick&&i.OnHelpButtonClick()||e((0,F.yG)("Help")),n.onClick&&n.onClick(t)}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(j);let W=null;function _(e,t){let n;n=t.EnableVNextFeedback?(0,U.k)((()=>W().then((e=>e.FeedbackButtonPanelConnector)))):(0,U.k)((()=>W().then((e=>e.FeedbackFlexPaneConnector)))),(0,o.ef)().dispatch((0,F.wd)({component:n,key:"Feedback",width:F.yh}))}var G=n(90684);function K(e,t){const i=()=>n.e("otellogging").then(n.bind(n,37698));t.AriaTelemetryEnabled&&(!t.IsConsumerShell&&t.PUID?(0,G.C)(t)&&t.TID&&i().then((n=>{n.initializeLogging(e,t),(0,a.Lo)().unsubscribe("ShellDataUpdated",K)})):i().then((n=>{n.initializeLogging(e,t),(0,a.Lo)().unsubscribe("ShellDataUpdated",K)})))}var z=n(32825);let V=!1;function Z(e,t){if(!V&&t&&t.FootprintTelemetryEnabled){if(V=!0,!o.Zp.isMobileClient()&&!(0,o.NN)(t.WorkloadId,t.FootprintWorkloadExcludeList)){let i="https://r4.res.office365.com/footprint/v3.2/scripts/fp-min.js";window.O365ShellContext.TrustedResources.add(i),(n=i,new Promise(((e,t)=>{let a=encodeURI(n),i=document.createElement("script");i.src=window.O365ShellContext.TrustedTypesPolicies[z.GD].createScriptURL(a),i.type="text/javascript",i.crossOrigin="anonymous",i.onerror=e=>{t({ResourceName:n,Details:e.message})},i.onload=()=>{e(null)},document.body.appendChild(i)}))).then((()=>{var n;let i="";const r=(0,u.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),s="gallatin",o=(0,g.pn)((null===(n=t.Environment)||void 0===n?void 0:n.toLowerCase())||"",s)?s:"";t.IsConsumerShell?i="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa":t.TID&&(i=t.TID);try{const e=[`config.fp.measure.office.com/conf/v2/o365se${o}/fpconfig.min.json`,"r4.res.office365.com/footprint/v3.2/scripts/fpconfig.json"];Footprint.start("O365se"+o,e,1e4,JSON.stringify([{TenantId:i,AppId:r}]))}catch(e){(0,a.jl)().tag("Footprint_StartFailed",6,e||"")}})).catch((e=>{(0,a.jl)().tag("Footprint_LoadFailed",4,e.ResourceName,e.Details)}))}(0,a.Lo)().unsubscribe("ShellDataUpdated",Z)}var n}var Q=n(49472);class X extends i.Component{componentDidMount(){this.props.isAvailable&&(0,a.jl)().perfMarker("SettingsTimeToInteractive")}render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:f.b.Settings,affordanceMenuItemText:f.b.Settings,iconID:"Settings",iconFontSize:H.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(q.sO,Object.assign({},e)):i.createElement(q.b,Object.assign({},e))}}var J=n(14643);const Y=(0,s.connect)(((e,t)=>{let n=!1;if(e.shellInitDataState.layout)if(e.shellInitDataState.clientData.SettingsPaneEnabled){n=(0,J.F)(Object.assign(Object.assign({},e.shellInitDataState.clientData),{CurrentMainLinkElementID:e.shellInitDataState.navBarData.CurrentMainLinkElementID}),null,e.settingsFlexPaneState.workloadSettingLinks).length>0}else n=!1;return{isAvailable:n,id:t&&t.id,isActive:e.flexPaneState&&"Settings"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged}}),(e=>({onClick:(t,n)=>{t.stopPropagation(),(0,a.jl)().click("Settings","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}`),n.onClick&&n.onClick(t),e((0,o.uS)(t.currentTarget&&t.currentTarget.id)),e((0,F.yG)("Settings"))}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(X);var $=n(84735),ee=n(63481),te=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,ne=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,ae=/[^-+\dA-Z]/g;function ie(e,t,n,a){if(1!==arguments.length||"string"!=typeof e||/\d/.test(e)||(t=e,e=void 0),(e=e||0===e?e:new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var i=(t=String(re[t]||t||re.default)).slice(0,4);"UTC:"!==i&&"GMT:"!==i||(t=t.slice(4),n=!0,"GMT:"===i&&(a=!0));var r=function(){return n?"getUTC":"get"},s=function(){return e[r()+"Date"]()},o=function(){return e[r()+"Day"]()},l=function(){return e[r()+"Month"]()},c=function(){return e[r()+"FullYear"]()},u=function(){return e[r()+"Hours"]()},d=function(){return e[r()+"Minutes"]()},p=function(){return e[r()+"Seconds"]()},h=function(){return e[r()+"Milliseconds"]()},g=function(){return n?0:e.getTimezoneOffset()},m=function(){return ce(e)},f={d:function(){return s()},dd:function(){return oe(s())},ddd:function(){return se.dayNames[o()]},DDD:function(){return le({y:c(),m:l(),d:s(),_:r(),dayName:se.dayNames[o()],short:!0})},dddd:function(){return se.dayNames[o()+7]},DDDD:function(){return le({y:c(),m:l(),d:s(),_:r(),dayName:se.dayNames[o()+7]})},m:function(){return l()+1},mm:function(){return oe(l()+1)},mmm:function(){return se.monthNames[l()]},mmmm:function(){return se.monthNames[l()+12]},yy:function(){return String(c()).slice(2)},yyyy:function(){return oe(c(),4)},h:function(){return u()%12||12},hh:function(){return oe(u()%12||12)},H:function(){return u()},HH:function(){return oe(u())},M:function(){return d()},MM:function(){return oe(d())},s:function(){return p()},ss:function(){return oe(p())},l:function(){return oe(h(),3)},L:function(){return oe(Math.floor(h()/10))},t:function(){return u()<12?se.timeNames[0]:se.timeNames[1]},tt:function(){return u()<12?se.timeNames[2]:se.timeNames[3]},T:function(){return u()<12?se.timeNames[4]:se.timeNames[5]},TT:function(){return u()<12?se.timeNames[6]:se.timeNames[7]},Z:function(){return a?"GMT":n?"UTC":de(e)},o:function(){return(g()>0?"-":"+")+oe(100*Math.floor(Math.abs(g())/60)+Math.abs(g())%60,4)},p:function(){return(g()>0?"-":"+")+oe(Math.floor(Math.abs(g())/60),2)+":"+oe(Math.floor(Math.abs(g())%60),2)},S:function(){return["th","st","nd","rd"][s()%10>3?0:(s()%100-s()%10!=10)*s()%10]},W:function(){return m()},WW:function(){return oe(m())},N:function(){return ue(e)}};return t.replace(te,(function(e){return e in f?f[e]():e.slice(1,e.length-1)}))}var re={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},se={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(e).padStart(t,"0")},le=function(e){var t=e.y,n=e.m,a=e.d,i=e._,r=e.dayName,s=e.short,o=void 0!==s&&s,l=new Date,c=new Date;c.setDate(c[i+"Date"]()-1);var u=new Date;u.setDate(u[i+"Date"]()+1);return l[i+"FullYear"]()===t&&l[i+"Month"]()===n&&l[i+"Date"]()===a?o?"Tdy":"Today":c[i+"FullYear"]()===t&&c[i+"Month"]()===n&&c[i+"Date"]()===a?o?"Ysd":"Yesterday":u[i+"FullYear"]()===t&&u[i+"Month"]()===n&&u[i+"Date"]()===a?o?"Tmw":"Tomorrow":r},ce=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var a=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-a);var i=(t-n)/6048e5;return 1+Math.floor(i)},ue=function(e){var t=e.getDay();return 0===t&&(t=7),t},de=function(e){return(String(e).match(ne)||[""]).pop().replace(ae,"").replace(/GMT\+0000/g,"UTC")},pe=n(9028);const he="UTC",ge="tzone://Microsoft/Utc";class me{constructor(){this.timeZones=null,this.timeZoneOffsets=[]}get isInitialized(){return null!=this.timeZones&&this.timeZoneOffsets.length>0}initializeTimeZoneConverter(e){this.timeZoneOffsets=e,this.timeZones={}}convert(e,t,n){if(null===this.timeZones)throw Error("LoadTimeZoneOffsets must be called before convert.");if(e===ge&&(e=he),t===ge&&(t=he),null==n||e===t)return n;let a=be.parseISO8601DateTime(n),i=0;e===he?(i=this.findOffsetInUTC(t,a),a=a.addMinutes(i)):t===he?(i=this.findOffsetInLocal(e,a),a=a.addMinutes(0-i)):(i=this.findOffsetInLocal(e,a),a=a.addMinutes(0-i),i=this.findOffsetInUTC(t,a),a=a.addMinutes(i));let r=-1===n.indexOf(".")?be.generateISO8601DateTimeString(a):be.generateISO8601DateTimeMsString(a);if(t===he)r+="Z";else{let e=Math.abs(i),t=Math.floor(e/60),n=e%60;r+=(i<0?"-":"+")+(t<10?"0"+t:t.toString())+":"+(n<10?"0"+n:n.toString())}return r}findOffsetInLocal(e,t){let n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(let e of n)if(t.compare(e.localStart)>=0&&t.compare(e.localEnd)<0)return e.offset;throw new Error("Could not find an offset for this time stamp")}findOffsetInUTC(e,t){let n=this.getTimeZoneRanges(e);if(null==n)throw Error("Unknown time zone specified: "+e);for(let e of n)if(t.compare(e.utcStart)>=0&&t.compare(e.utcEnd)<0)return e.offset;throw new Error("Could not find an offset for this time stamp")}ConvertDateTimeMembersTimeZone(e,t,n,a,i,r){throw new Error("Unimplemented.")}getTimeZoneRanges(e){let t=this.timeZones[e];return null==t&&(this.loadOffsetsForTimezone(e),t=this.timeZones[e]),t}loadOffsetsForTimezone(e){let t;for(let n of this.timeZoneOffsets)if(e===n.TimeZoneId){t=n.OffsetRanges;break}if(!t||0===t.length)return void(0,a.jl)().tag("TimeZoneConverter_NoIncomingOffsetRanges",6,e);let n=t.map((e=>({utcStart:be.parseISO8601DateTime(e.UtcTime),offset:e.Offset})));n.forEach(((e,t)=>{if(0===t?(e.utcStart=be.MinValue,e.localStart=be.MinValue):e.localStart=e.utcStart.addMinutes(e.offset),t+1===n.length)e.utcEnd=be.MaxValue,e.localEnd=be.MaxValue;else{let a=n[t+1];e.utcEnd=a.utcStart,e.localEnd=e.utcEnd.addMinutes(Math.max(e.offset,a.offset))}})),this.timeZones[e]=n}}const fe={TimeFormat:"hh:mm tt",DateFormat:"MM/dd/yyyy",TimeZone:"Pacific Standard Time",UserCulture:"default",WeekStartDay:0,FirstWeekOfYear:0,get TimeZoneOffsets(){return[{TimeZoneId:this.TimeZone,OffsetRanges:[{UtcTime:"1970-01-01T00:00:00Z",Offset:-180}]}]}};class Se{constructor(e){let t=e.UserOptions||{},n=t.MailboxTimeZoneOffset;this.timeFormat=t.TimeFormat||fe.TimeFormat,this.dateFormat=t.DateFormat||fe.DateFormat,this.timeZone=t.TimeZone||fe.TimeZone,this.userCulture=null!=e.SessionSettings?e.SessionSettings.UserCulture:fe.UserCulture,this.weekStartDay=null!=t.WeekStartDay?t.WeekStartDay:fe.WeekStartDay,this.firstWeekOfYear=null!=t.FirstWeekOfYear?t.FirstWeekOfYear:fe.FirstWeekOfYear,this.timeZoneConverter=new me,this.timeZoneConverter.initializeTimeZoneConverter(null!=n?n:fe.TimeZoneOffsets)}static get Instance(){return null==Se.instance&&(Se.instance=new Se({})),Se.instance}static populate(e){Se.instance=new Se(e)}}var ye=n(98630);const Ce=864e13;class be{constructor(e,t,n,a=0,i=0,r=0,s=0,o=0){if(t<0||t>11||n<0||n>31||a<0||a>23||i<0||i>59||r<0||r>59||s<0||s>999)throw new Error("Date part out of range.");this.localTime=new Date(Date.UTC(e,t,n,a,i,r,s)),this.utcOffsetInMinutes=null==o?be.timeZoneConverter.findOffsetInLocal(be.timeZone,be.fromNativeDateTime(this.localTime)):o,be.throwIfDateOutOfRange(this)}get date(){return this.localTime.getUTCDate()}get month(){return this.localTime.getUTCMonth()}get year(){return this.localTime.getUTCFullYear()}get hour(){return this.localTime.getUTCHours()}get second(){return this.localTime.getUTCSeconds()}get minute(){return this.localTime.getUTCMinutes()}get millisecond(){return this.localTime.getUTCMilliseconds()}static get timeZone(){return Se.Instance.timeZone}static get Now(){let e=be.timeZoneConverter.convert(he,be.timeZone,be.generateISO8601DateTimeMsStringWithOffset(be.UTCNow));return be.parseISO8601DateTime(e)}static get timeZoneConverter(){return Se.Instance.timeZoneConverter}static get UTCNow(){return be.fromNativeDateTime(new Date).toUTC()}static get now(){let e=be.timeZoneConverter.convert(he,be.timeZone,be.generateISO8601DateTimeMsStringWithOffset(be.UTCNow));return be.parseISO8601DateTime(e)}static fromNativeDateTime(e){return new be(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),-e.getTimezoneOffset())}format(e){return ie(this.localTime,be.getDateFormatMask(e),!0)}static parseISO8601DateTime(e=""){let t=be.isoRegex.exec(e);if(null==t||15!==t.length)throw new Error((0,g.Uw)("Unexpected datetime format (value: {0}).",e));let n=parseInt(t[1],10),a=parseInt(t[2],10),i=parseInt(t[3],10),r=0,s=0,o=0,l=0,c=0;return null!=t[5]&&null!=t[6]&&null!=t[7]&&(r=parseInt(t[5],10),s=parseInt(t[6],10),o=parseInt(t[7],10),null!=t[9]&&(l=parseInt(t[9],10))),null!=t[10]&&"Z"!==t[10].toUpperCase()&&(c+=60*parseInt(t[13],10),c+=parseInt(t[14],10),"-"===t[12]&&(c=-c)),new be(n,a-1,i,r,s,o,l,c)}static generateISO8601DateTimeString(e){return be.generateISO8601DateTimeMsString(e,!1)}static generateISO8601DateTimeMsString(e,t=!0){const n="yyyy-MM-dd'T'HH:mm:ss"+(t?".l":"");return e.format(n)}static generateISO8601DateTimeMsStringWithOffset(e){return be.generateISO8601DateTimeMsString(e)+e.getUtcOffsetDisplayString()}getUtcOffsetDisplayString(){if(0===this.utcOffsetInMinutes)return"Z";const e=Math.floor(Math.abs(this.utcOffsetInMinutes)/60),t=Math.abs(this.utcOffsetInMinutes)%60,n=this.utcOffsetInMinutes<0?"-":"+";return(0,g.Uw)("{0}{1}:{2}",n,Ie(e,2),Ie(t,2))}static areDatePartsEqual(e,t){return null===e&&null===t||null!==e&&null!=t&&0===e.compareDatePart(t)}compare(e){return pe.throwOnNullOrUndefined(e,"other"),this.localTime.getTime()-e.localTime.getTime()}clone(){let e=new be(0,0,0,0,0,0,0,0);return e.localTime.setTime(this.localTime.getTime()),e.utcOffsetInMinutes=this.utcOffsetInMinutes,e}addMilliseconds(e){be.throwIfNotNumber(e);let t=this.clone();const n=t.localTime.getTime()+e;return t.localTime.setTime(n),be.throwIfDateOutOfRange(t),t}Subtract(e){return pe.throwOnNullOrUndefined(e,"value"),this.localTime.getTime()-e.localTime.getTime()}addSeconds(e){return be.throwIfNotNumber(e),this.addMilliseconds(1e3*e)}addMinutes(e){return be.throwIfNotNumber(e),this.addMilliseconds(e*ye.rP)}addHours(e){return be.throwIfNotNumber(e),this.addMilliseconds(e*ye.yo)}addDays(e){return be.throwIfNotNumber(e),this.addMilliseconds(e*ye.tL)}toUTC(){if(0===this.utcOffsetInMinutes)return this;let e=this.addMinutes(-this.utcOffsetInMinutes);return e.utcOffsetInMinutes=0,e}getNativeDateTime(){return new Date(this.toUTC().getUTCMilliseconds())}getUTCMilliseconds(){return this.toUTC().localTime.getTime()}GetMilliseconds(){return this.localTime.getTime()}compareDatePart(e){return be.getDatePartHashValue(this)-be.getDatePartHashValue(e)}static throwIfNotNumber(e){if("number"!=typeof e)throw Error("Argument must be of type number, but is type "+typeof e)}static throwIfDateOutOfRange(e){if(!be.isValidDate(e))throw new Error("The resulting DateTime is less than MinValue or greater than MaxValue")}static isValidDate(e){return null!=e&&!isNaN(e.localTime.getTime())&&e.localTime.getTime()>=-864e13&&e.localTime.getTime()<=Ce}static getDatePartHashValue(e){return e.date+(e.month<<5)+(e.year<<9)}static getDateFormatMask(e){let t=!1;return e.replace(/[mMtT']/g,(e=>{if(t)return t="'"!==e,e;switch(e){case"'":return t=!0,e;case"m":return"M";case"M":return"m";case"t":return"T";case"T":return"t";default:return e}}))}}function Ie(e,t){let n=e.toString();for(;n.length<t;)n="0"+n;return n}be.isoRegex=/^(\d{4})-(\d{2})-(\d{2})(T(\d{2}):(\d{2}):(\d{2})([,\.](\d{3})\d*){0,1}){0,1}(Z|(([-\+])(\d{2}):?(\d{2}))){0,1}$/,be.MaxValue=new be(275760,8,13,0,0,0,0,0),be.MinValue=new be(-271821,3,20,0,0,0,0,0);var Te=n(42435),De=n(30534);function ve(e,t,n,i){return e?Object.assign(Object.assign({},e),{workloadData:n,workloadSettingLinksTitle:e.workloadSettingLinksTitle||i&&i.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:[...t.CurrentWorkloadSettingsSubLinks||[],...i&&i.workloadSettingsSubLinks||[]]}):Object.assign(Object.assign({},e),{themeCardState:{selectedThemeId:(0,a.q4)().getCurrentThemeId(),themeData:[],preferOfficeTheme:(0,a.q4)().getThemeState().preferOfficeTheme,fullBleedThemesEnabled:n&&n.EduThemingEnabled&&(n.ActiveExperiences||"").split(",").some((e=>"edu"===e.toLowerCase())),showMonarchColorThemes:n&&n.ShowMonarchColorThemes},languageAndRegionCardState:{selectedLanguage:"",selectedDateFormat:"",selectedTimeFormat:"",selectedTimeZone:"",languageChoices:[],timeZoneChoices:[],dateFormatChoices:[],timeFormatChoices:[],savedLanguage:"",savedDateFormat:"",savedTimeFormat:"",savedTimeZone:""},aboutCardState:{correlationID:i&&i.correlationID?i.correlationID:f.b.NotAvailable,sessionID:i&&i.sessionID?i.sessionID:f.b.NotAvailable,version:i.version?i.version:f.b.NotAvailable},workloadData:n,workloadId:n&&n.WorkloadId?n.WorkloadId:"",expandO365Settings:!1,workloadSettingLinksTitle:i&&i.workloadSettingsSubLinksTitle||t.CurrentWorkloadSettingsSubLinksTitle||n.AppHeaderLinkText,workloadSettingLinks:[...t.CurrentWorkloadSettingsSubLinks||[],...i&&i.workloadSettingsSubLinks||[]],cards:[]})}function we(e){const t=-1!==e.indexOf("HH");return new be(2018,8,1,t?21:9,5).format(e).replace("Sep",f.b.SeptemberAbbrev).replace("September",f.b.September)}const Ae={settingsFlexPaneState:function(e,t){if(!e){const n=t.shellInitData.shellInitDataState;e=ve(null,n.navBarData,n.clientData,n.renderSettings)}switch(t.type){case o.ri:const n=t;return ve(e,n.navBarData,n.shellClientData,n.renderSettings);case De.do:return function(e,t){const n=t,a=(0,o.GS)(e.workloadSettingLinks,(e=>e.Id===n.newWorkloadSettingLink.Id));if(!(0,$.l)(n.newWorkloadSettingLink))return e;const i=a>=0?Object.assign(Object.assign({},e),{workloadSettingLinks:[...e.workloadSettingLinks.slice(0,a),n.newWorkloadSettingLink,...e.workloadSettingLinks.slice(a+1)]}):Object.assign(Object.assign({},e),{workloadSettingLinks:e.workloadSettingLinks.concat(n.newWorkloadSettingLink)});return i}(e,t);case De.w0:return function(e,t){const n=t,a=(0,o.GS)(e.workloadSettingLinks,(e=>e.Id===n.settingLinkID));if(a>=0)return Object.assign(Object.assign({},e),{workloadSettingLinks:[...e.workloadSettingLinks.slice(0,a),...e.workloadSettingLinks.slice(a+1)]});return e}(e,t);case De.K4:return function(e,t){const n=t,a=n.newWorkloadSettingsLinks.filter((e=>(0,$.l)(e)));if(0===a.length)return e;return Object.assign(Object.assign({},e),{workloadSettingLinks:a})}(e,t);case De.SL:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{cards:n.cardData})}(e,t);case o.hs:return function(e,t){const n=t,i=(0,a.q4)().getUserPersonalizationAllowed(),r=(0,Te.bp)(n.themeData||[],e.themeCardState.selectedThemeId,e.themeCardState.preferOfficeTheme,i);return Object.assign(Object.assign({},e),{themeCardState:Object.assign(Object.assign({},e.themeCardState),{themeData:r})})}(e,t);case o.Ou:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{themeCardState:Object.assign(Object.assign({},e.themeCardState),{selectedThemeId:n.themeInfo.ThemeId||ee.fy,preferOfficeTheme:n.themeInfo.PreferOfficeTheme})})}(e,t);case De.Cr:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage,savedLanguage:n.selectedLanguage})})}(e,t);case De.EF:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{languageChoices:n.languageChoices.map((e=>({id:e.Locale,text:e.DisplayName,language:e.Locale})))})})}(e,t);case De.J5:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedLanguage:n.selectedLanguage})})}(e,t);case De.lj:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedTimeZone:n.timeZoneChoice,selectedDateFormat:n.dateFormatChoice,selectedTimeFormat:n.timeFormatChoice,savedTimeZone:n.timeZoneChoice,savedDateFormat:n.dateFormatChoice,savedTimeFormat:n.timeFormatChoice})})}(e,t);case De.rg:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{timeZoneChoices:n.timeZoneChoices.map((e=>({id:e.alias,text:e.displayName})))})})}(e,t);case De.$w:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedTimeZone:n.selectedTimeZone})})}(e,t);case De.$I:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{dateFormatChoices:n.dateFormatChoices.map((e=>({id:e,text:we(e)})))})})}(e,t);case De.Oy:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedDateFormat:n.selectedDateFormat})})}(e,t);case De.i1:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{timeFormatChoices:n.timeFormatChoices.map((e=>({id:e,text:we(e)})))})})}(e,t);case De.sI:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},e.languageAndRegionCardState),{selectedTimeFormat:n.selectedTimeFormat})})}(e,t);case De.NS:return function(e){const t=e.languageAndRegionCardState;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},t),{savedLanguage:t.selectedLanguage,savedTimeZone:t.selectedTimeZone,savedDateFormat:t.selectedDateFormat,savedTimeFormat:t.selectedTimeFormat})})}(e);case De.M9:return function(e){const t=e.languageAndRegionCardState;return Object.assign(Object.assign({},e),{languageAndRegionCardState:Object.assign(Object.assign({},t),{selectedLanguage:t.savedLanguage,selectedTimeZone:t.savedTimeZone,selectedDateFormat:t.savedDateFormat,selectedTimeFormat:t.savedTimeFormat})})}(e);case De.Vx:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{parentCardId:n.cardId})}(e,t);case De.nl:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{expandO365Settings:n.isExpanded})}(e,t);default:return e}}};var Oe=n(55309);class xe{AddOrUpdateWorkloadSettingLink(e){(0,o.ef)().dispatch((0,Oe.jG)(e))}RemoveWorkloadSettingLink(e){(0,o.ef)().dispatch((0,Oe.N0)(e))}SetWorkloadSettingsLinks(e){(0,o.ef)().dispatch((0,Oe.eV)(e))}}function Le(e,t){let n=(0,a.aH)().layout;const i=(0,o.ef)().getState().settingsFlexPaneState.workloadSettingLinks;if(!n){let n=t.SettingsPaneEnabled&&(0,J.F)(Object.assign(Object.assign({},t),{CurrentMainLinkElementID:e.CurrentMainLinkElementID}),null,i).length>0,a=document.getElementById(N.JT);a&&n&&(a.style.display="block")}}var ke=n(24695),Re=n(51932),Ee=n(40719);function Pe(e,t,n){return Object.assign(Object.assign({},e),{webChatSDKUrl:t.WebChatSDKUrl||null,chatWebLink:t.ChatWebLink||null,chatEnabled:!!t.ChatEnabled&&!o.Zp.isMobileClient(),isConsumerShell:t.IsConsumerShell,chatButtonRenderedCallback:n.chatButtonRenderedCallback})}const Ue={chatState:function(e,t){if(!e){const n=t.shellInitData.shellInitDataState;e=Pe(o.mI,n.clientData||{},n.renderSettings||{})}switch(t.type){case o.ri:const n=t;return Pe(e,n.shellClientData,n.renderSettings);case o.__:return function(e,t){const n=t;e.isConsumerShell&&(0,Re.yX)(n.isRecentsOpen,e.isTeamsChatActivated);return Object.assign(Object.assign({},e),{isChatRecentsPaneOpen:n.isRecentsOpen})}(e,t);case Ee.q:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatRecentsPaneInitialized:n.isRecentsInitialized})}(e,t);case Ee.D:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatAPIInitialized:n.isChatAPIInitialized})}(e,t);case Ee.nZ:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{unreadBadgeValue:n.unreadBadgeValue})}(e,t);case Ee.YI:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isTeamsChatActivated:n.isTeamsChatActivated})}(e,t);case Ee.Ak:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{initChatOnFirstClick:n.initChatOnFirstClick})}(e,t);case Ee.M3:return function(e,t){return Object.assign(Object.assign({},e),{isTeamsChatAuthFailed:!0})}(e);case Ee.P7:return function(e,t){const n=t;return Object.assign(Object.assign({},e),{isChatAPIPreAuthCompleted:n.isChatAPIPreAuthCompleted})}(e,t);default:return e}}};let Fe=!1;function Ne(e,t){if(t.ChatEnabled&&!Fe){Fe=!0;let e=(0,o.ef)(),t=(0,a.aH)()&&(0,a.aH)().layout;if(t)t.centerCustomizationRegion&&(0,o.Y5)("ChatIcon",t.centerCustomizationRegion.children)&&n.e("chat").then(n.bind(n,51907)).then((e=>{const t=e.ChatHeaderButtonConnector;(0,a.Lo)().invoke("LazyComponentLoaded",ke.U,t),e.initializeChatComponent()}));else{let t=document.getElementById(N.en);t&&n.e("chat").then(n.bind(n,51907)).then((n=>{n.initializeChatComponent();const a=n.ChatIconConnector;r.render(i.createElement(s.Provider,{store:e},i.createElement(a,null)),t)}))}}}var Me=n(31047),qe=n(18341);class He extends F.yJ{constructor(e){super(e),this.preventEscPropagation=e=>{27===e.keyCode&&e.stopPropagation()},this.state={isShyHeaderActive:!1},(0,a.Lo)().subscribe("ShyHeaderActivated",(e=>{this.setState({isShyHeaderActive:e})}),!0)}onComponentVisible(){super.onComponentVisible(),(0,a.jl)().impression("CustomFlexPane","FlexPane",0,void 0,"Loaded"),this.props.onFlexPaneOpen&&this.props.onFlexPaneOpen(),this.customRenderContainer&&this.props.render&&this.props.render(this.customRenderContainer)}onComponentHide(){super.onComponentHide(),this.props.onFlexPaneClose&&this.props.onFlexPaneClose()}componentWillUnmount(){this.customRenderContainer&&r.unmountComponentAtNode(this.customRenderContainer),super.componentWillUnmount()}render(){return i.createElement(F.Ou,{isActive:this.props.isActive,title:this.props.flexPaneTitle(),customTitle:this.props.customTitle,flexPaneProviderID:this.props.flexPaneProviderID,className:this.props.className},i.createElement("div",{id:`CustomFlexPane_${this.props.flexPaneProviderID}`,role:"region",className:(0,o.iv)(qe.flexPaneContentContainer,qe.flexPaneContentContainerForThinHeader,{[qe.flexPaneContentContainerForShyHeader]:this.state.isShyHeaderActive}),onKeyDown:this.props.customEscapeKeyHandling&&this.preventEscPropagation,ref:e=>this.customRenderContainer=e}))}}const je=(0,s.connect)(((e,t)=>{let n=e.extensibilityState.customFlexPanes[t.flexPaneProviderID];return n?Object.assign(Object.assign({},t),{className:n.containerClassName,flexPaneTitle:()=>"function"==typeof n.flexPaneTitle?n.flexPaneTitle():n.flexPaneTitle,customTitle:n.customTitle,render:n.render,customEscapeKeyHandling:n.customEscapeKeyHandling,onFlexPaneOpen:n.onFlexPaneOpen,onFlexPaneClose:n.onFlexPaneClose,triggerControlID:n.triggerControlID}):((0,a.jl)().tag("UnrecognizedCustomFlexPane",6,t.flexPaneProviderID),null)}))(He);var Be=n(33294),We=n(99182);function _e(e){return!!e&&"iconFontName"in e}const Ge="ShellFabricMDL2IconsLite,ShellFabricMDL2Icons";class Ke extends i.Component{constructor(e){super(e),this.setClickableElement=e=>{this.headerButtonElement=e},this.onClick=e=>{this.props.isStateless&&this.props.onShow&&this.props.onShow(e.currentTarget.getBoundingClientRect()),this.props.onClick&&this.props.onClick(e)},this.state={isHovered:!1}}componentDidUpdate(e,t){this.props.isActive&&!e.isActive&&null!=this.headerButtonElement?this.props.onShow&&this.props.onShow(this.headerButtonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide&&this.props.onHide()}getArialLabel(){var e,t;const n="function"==typeof this.props.ariaLabel?this.props.ariaLabel():this.props.ariaLabel;if(void 0!==this.props.badgeValue&&0!==this.props.badgeValue){if(!this.props.badgeLabel||this.props.badgeLabel.includes("{1}"))return(0,o.Uw)(null!==(e=this.props.badgeLabel)&&void 0!==e?e:f.b.UnreadBadge_Count,`${n}`,`${this.props.badgeValue}`);if(null===(t=this.props.badgeLabel)||void 0===t?void 0:t.includes("{0}"))return(0,o.Uw)(this.props.badgeLabel,`${this.props.badgeValue}`)}return n}render(){const e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:this.getArialLabel(),affordanceMenuItemText:"function"==typeof this.props.affordanceMenuItemText?this.props.affordanceMenuItemText():this.props.affordanceMenuItemText,iconData:this.props.iconData?_e(this.props.iconData)?{iconFontName:this.props.iconData.iconFontName,iconFontFamily:this.props.iconData.iconFontFamily||Ge,iconFontSize:H.GX.toString()}:this.props.iconData:{iconFontName:this.props.iconFontName,iconFontFamily:this.props.iconFontFamily||Ge,iconFontSize:H.GX.toString()},isActive:this.props.isActive,isDarkModeEnabled:!!this.props.isDarkMode,onClick:this.onClick,onHoverStateChanged:e=>{this.setState({isHovered:e})},onDimensionsChanged:this.props.controlDimensionsChanged,setClickableElement:this.setClickableElement,buttonText:this.props.buttonText,responsiveStep:this.props.responsiveStep,hideButton:this.props.hideButton,isNoninteractive:this.props.isNoninteractive,badgeLabel:this.props.badgeLabel};return 0===this.props.renderContext?i.createElement(q.sO,Object.assign({},e),i.createElement(o.Eb,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:We.headerButtonBadgePosition,badgeColors:this.props.badgeColors,badgeCharacter:this.props.badgeCharacter,isDarkMode:!!this.props.isDarkMode})):i.createElement(q.b,Object.assign({},e),i.createElement(o.Eb,{unseenItemCount:this.props.badgeValue,isParentHovered:this.state.isHovered,badgeStyles:Be.affordanceContextMenuItemBadgePosition,badgeColors:this.props.badgeColors,badgeCharacter:this.props.badgeCharacter,isDarkMode:!!this.props.isDarkMode}))}}const ze=(0,s.connect)(((e,t)=>Object.assign(Object.assign({},t),{badgeValue:e.extensibilityState.badgeValues[t.id],badgeColors:e.extensibilityState.badgeColors[t.id],isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId,flexPaneProviderID:e.extensibilityState.customHeaderButtonFlexPaneTriggers[t.id],badgeLabel:e.extensibilityState.badgeLabels[t.id],isDarkMode:e.themeState.IsDarkMode,badgeCharacter:e.extensibilityState.badgeCharacters[t.id]})),((e,t)=>({onClickDispatch:(n,a)=>{a.stopPropagation(),t.onClick&&t.onClick(a),t.isStateless||e((0,o.uS)(a.currentTarget&&a.currentTarget.id)),n&&e((0,F.yG)(n))}})),((e,t)=>Object.assign(Object.assign(Object.assign({},e),t),{onClick:n=>{t.onClickDispatch(e.flexPaneProviderID,n)}})))(Ke),Ve="suiteux-extensibility.SET_BADGE_VALUE",Ze="suiteux-extensibility.SET_BADGE_COLOR",Qe="suiteux-extensibility.SET_BADGE_LABEL",Xe="suiteux-extensibility.SET_BADGE_CHARACTER";var Je=n(44066),Ye=n(36198);function $e(e,t,n,a){let i=Object.assign({},e);t&&t.flexPaneCollection&&t.flexPaneCollection.forEach((e=>{let t=e;t.render&&(i.customFlexPanes[t.flexPaneID]=t)})),n&&(i.customFlexPanes[n.flexPaneID]=n),a&&(i.customFlexpaneWidth=a);let r=Object.keys(i.customFlexPanes).sort();return i.customFlexPaneHash=(0,o.Wu)(JSON.stringify(r)),i}let et={extensibilityState:function(e,t){if(!e){let n=t.shellInitData.shellInitDataState;e=$e(o.M1,n.layout)}switch(t.type){case o.C1:return function(e,t){let n=t.buttonId;e.activeButtonId===n&&(n="");return Object.assign(Object.assign({},e),{activeButtonId:n})}(e,t);case o.Q:return $e(e,t.shellLayout);case"suiteux-extensibility.UPDATE_CUSTOMHEADERBUTTON":return function(e,t){let n=Object.assign({},e);for(let a=0;a<t.buttonData.length;a++){const i=t.buttonData[a];let r=(0,o.GS)(e.customHeaderButtons,(e=>e.id===i.id));r>=0?n.customHeaderButtons=[...e.customHeaderButtons.slice(0,r),i,...e.customHeaderButtons.slice(r+1)]:(n.customHeaderButtons=[...e.customHeaderButtons],n.customHeaderButtons.unshift(i))}return n}(e,t);case Ye.yk:let n=t;return $e(e,null,n.customFlexpane,n.customFlexpaneWidth);case Ye.FK:return function(e,t){let n=Object.assign({},e);delete n.customFlexPanes[t];let a=Object.keys(n.customFlexPanes).sort();return n.customFlexPaneHash=(0,o.Wu)(JSON.stringify(a)),n}(e,t.customFlexpaneID);case Je.Ve:return function(e,t){let n=e;t.newProvider.shellControlID&&e.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]!==t.newProvider.key&&(n=Object.assign(Object.assign({},e),{customHeaderButtonFlexPaneTriggers:Object.assign({},e.customHeaderButtonFlexPaneTriggers)}),n.customHeaderButtonFlexPaneTriggers[t.newProvider.shellControlID]=t.newProvider.key);return n}(e,t);case Ve:return function(e,t){let n=e;e.badgeValues[t.buttonID]!==t.badgeValue&&(n=Object.assign(Object.assign({},e),{badgeValues:Object.assign({},e.badgeValues)}),n.badgeValues[t.buttonID]=t.badgeValue);return n}(e,t);case Qe:return function(e,t){let n=Object.assign({},e);e.badgeLabels[t.buttonID]!==t.badgeLabel&&(n.badgeLabels[t.buttonID]=t.badgeLabel);return n}(e,t);case Ze:return function(e,t){let n=e;e.badgeColors[t.buttonID]!==t.badgeColors&&(n=Object.assign(Object.assign({},e),{badgeColors:Object.assign({},e.badgeColors)}),n.badgeColors[t.buttonID]=t.badgeColors);return n}(e,t);case Xe:return function(e,t){let n=e;e.badgeCharacters[t.buttonID]!==t.badgeCharacter&&(n=Object.assign(Object.assign({},e),{badgeCharacters:Object.assign({},e.badgeCharacters)}),n.badgeCharacters[t.buttonID]=t.badgeCharacter);return n}(e,t);default:return e}}};var tt=n(31089),nt=n(71253),at=n(58930);class it extends i.Component{constructor(e){super(e),this.onEntryPointClick=()=>{this.props.isStateless?this.props.onShow(this.buttonElement.getBoundingClientRect()):this.props.onToggleButtonState(this.props.id)}}componentDidUpdate(e,t){this.props.isActive&&!e.isActive&&this.buttonElement?this.props.onShow(this.buttonElement.getBoundingClientRect()):!this.props.isActive&&e.isActive&&this.props.onHide()}render(){let e=(0,at.j)(),t=(0,o.iv)(this.props.isNoninteractive?We.nonInteractiveButton:We.button,nt.customHeaderButton,this.props.isNoninteractive?e.nonInteractiveButton:e.headerButton,{[e.activeHeaderButton]:this.props.isActive});const{iconData:n}=this.props;return this.props.isNoninteractive?i.createElement(tt.u,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},i.createElement("div",{className:nt.customHeaderButtonWrapper},i.createElement("span",{className:(0,o.iv)(t),role:"presentation",id:`CustomHeader_${this.props.id}`,ref:e=>this.buttonElement=e,onClick:null,"aria-label":this.props.ariaLabel,style:_e(n)?{fontFamily:n.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},_e(n)?i.createElement(o.BH,{fontSize:"16",fontValue:n.iconFontName}):n.element))):i.createElement(tt.u,{controlID:this.props.id,isActive:this.props.isActive,controlElement:this.buttonElement},i.createElement("div",{className:nt.customHeaderButtonWrapper},i.createElement("button",{className:(0,o.iv)(t),type:"button",role:"button",id:`CustomHeader_${this.props.id}`,ref:e=>this.buttonElement=e,onClick:this.onEntryPointClick,"aria-label":this.props.ariaLabel,style:_e(n)?{fontFamily:n.iconFontFamily}:void 0,title:this.props.ariaLabel,"aria-expanded":this.props.isActive},_e(n)?i.createElement(o.BH,{fontSize:"16",fontValue:n.iconFontName}):n.element)))}}const rt=(0,s.connect)(((e,t)=>Object.assign(Object.assign({},t),{isActive:!!e.extensibilityState&&t.id===e.extensibilityState.activeButtonId})),(e=>({onToggleButtonState:t=>{e((0,o.uS)(t))}})))(it);let st=[];var ot=n(58866);let lt=(0,o.ef)();class ct{AddOrUpdateCustomHeaderButton(...e){for(let t=0;t<e.length;t++){const n=e[t];(0,a.jl)().tag("AddOrUpdateCustomHeaderButton",1,n.id,n.iconData?_e(n.iconData)?n.iconData.iconFontName:"SVG element":n.iconFontName)}!function(...e){const t=(0,o.ef)();for(let t=0;t<e.length;t++){const n=e[t];if("object"!=typeof n||Array.isArray(n))continue;const a=(0,o.GS)(st,(e=>e.id===n.id));a>=0?st=[...st.slice(0,a),n,...st.slice(a+1)]:st.push(n)}if(t.getState().shellInitDataState.layout){let e=(0,a.bf)();e.DefaultLayoutState.CustomHeaderButtons=st,(0,a.Lo)().invoke("ShellLayoutUpdated",e.GetDefaultLayout())}else{const e=[...st].reverse().map((e=>{var t;return i.createElement(rt,{key:e.id,id:e.id,iconData:null!==(t=e.iconData)&&void 0!==t?t:{iconFontName:e.iconFontName,iconFontFamily:e.iconFontFamily},onHide:e.onHide,onShow:e.onShow,isStateless:e.isStateless,ariaLabel:"function"==typeof e.ariaLabel?e.ariaLabel():e.ariaLabel})})),n=document.getElementById("O365_CustomHeaderButtonsContainer");n.style.height="48px",r.render(i.createElement(s.Provider,{store:t},i.createElement("div",{className:nt.customHeaderButtonsContainer},e)),n)}}(...e)}AddOrUpdateCustomFlexpane(e,t){let n=(0,o.ef)();n.dispatch((0,ot.xG)(e.flexPaneID)),null!=n.getState().extensibilityState.customFlexPanes[e.flexPaneID]&&n.dispatch((0,c.sp)(e.flexPaneID)),n.dispatch((0,c.p8)(e,t))}UpdateButtonState(e,t){const n=(0,o.ef)(),a=n.getState().extensibilityState;a.activeButtonId!==e||t?a.activeButtonId!==e&&t&&n.dispatch((0,o.uS)(e)):n.dispatch((0,o.uS)(""))}SetCustomHeaderButtonBadgeValue(e,t){lt.dispatch(function(e,t){return{type:Ve,buttonID:e,badgeValue:t}}(e,t))}SetCustomHeaderButtonBadgeColor(e,t){lt.dispatch(function(e,t){return{type:Ze,buttonID:e,badgeColors:t}}(e,t))}SetCustomHeaderButtonBadgeLabel(e,t){lt.dispatch({type:Qe,buttonID:e,badgeLabel:t})}SetCustomHeaderButtonBadgeCharacter(e,t){lt.dispatch(function(e,t){return{type:Xe,buttonID:e,badgeCharacter:t}}(e,t))}}let ut=!1;class dt{Init(e,t,n,i,r){ut||(ut=!0,this.Timeout=e,this.SigninState=t,this.Controls=n,this.SessionId=i,this.DisableTrackEvents=r,(0,a.Lo)().subscribe("ShellDataUpdated",pt,!0))}}function pt(e,t){t.PUID?(t.AuthAbtEnabled&&(ut=!0,window.LoadAbtPromptJs={Download:ht},n.e("abt").then(n.bind(n,5168)).then((n=>{let a=null==n?void 0:n.Environment.WorldWide;(0,g.pn)(t.Environment.toLowerCase(),"tbprod")?a=null==n?void 0:n.Environment.Trailblazer:(0,g.pn)(t.Environment.toLowerCase(),"pfprod")&&(a=null==n?void 0:n.Environment.Pathfinder),null==n||n.AbtMainOperations.initializeAbt({market:e.CultureName||"en-US",workloadName:(0,u.Dd)(t.WorkloadId,e.CurrentMainLinkElementID,document.URL),environment:a,userId:t.PUID,authType:t.IsConsumerShell?null==n?void 0:n.AuthType.Msa:null==n?void 0:n.AuthType.Aad,timeout:window.O365Shell.Abt.Timeout,trackEvents:!window.O365Shell.Abt.DisableTrackEvents,enableLogging:!0,sessionId:window.O365Shell.Abt.SessionId,tenantId:t.TID,signInState:window.O365Shell.Abt.SigninState,controls:window.O365Shell.Abt.Controls,allowedCookieFailureTimes:2})}))),(0,a.Lo)().unsubscribe("ShellDataUpdated",pt)):(0,a.jl)().tag("ABT_NoPUIDFound",4,null,null)}function ht(e){n.e("abtprompt").then(n.t.bind(n,67549,23)).then((t=>{e&&e()}))}var gt=n(16358);class mt extends i.Component{render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:f.b.FeatureFlags_Title,affordanceMenuItemText:f.b.FeatureFlags_Title,iconID:"FeatureFlagsLogo",iconFontSize:H.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(q.sO,Object.assign({},e)):i.createElement(q.b,Object.assign({},e))}}const ft=(0,s.connect)(((e,t)=>({id:t&&t.id,isAvailable:!0,isActive:e.flexPaneState&&"FeatureFlags"===e.flexPaneState.activeProviderKey,controlDimensionsChanged:t.controlDimensionsChanged})),(e=>({onClick:(t,n)=>{t.stopPropagation(),n.onClick&&n.onClick(t),e((0,o.uS)(t.currentTarget&&t.currentTarget.id)),e((0,F.yG)("FeatureFlags"))}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(mt),St="suiteux-mecontrol.UPDATE_WORKLOAD_FEATURE_FLAG_LIST";class yt{AddFeatureFlags(e){e?(0,o.ef)().dispatch(function(e){return{type:St,workloadFeatureFlagList:e}}(e)):(0,a.jl)().tag("FeatureFlags_Shim_FeatureFlags_Param_Invalid",6)}SubscribeToFeatureFlagStatusChange(e){return(0,a.Lo)().subscribe("FeatureFlagChanged",e,!1)}}let Ct={featureFlagsState:function(e,t){return e||(e={enabled:!1,workloadFeatureFlagList:{}}),t.type===St?function(e,t){let n=t;return Object.assign(Object.assign({},e),{workloadFeatureFlagList:n.workloadFeatureFlagList})}(e,t):e}};function bt(e,t){if(t.FeatureFlagsEnabled){const e=(0,U.k)((()=>n.e("featureflags").then(n.bind(n,4318)).then((e=>e.FeatureFlagsFlexPanePanelConnector))));let t=(0,a.aH)().layout,i={component:e,key:"FeatureFlags",width:F.yh};if(t){(0,a.Lo)().invoke("LazyComponentLoaded",gt.$,ft),i.nativeControlID="FeatureFlags"}else i.btnId=N.F_;(0,o.ef)().dispatch((0,F.wd)(i))}}var It=n(33836),Tt=n(4223),Dt=n(44482);const vt="O365_ShyHeader",wt=2e3;let At,Ot,xt,Lt,kt,Rt,Et,Pt,Ut,Ft,Nt,Mt,qt,Ht;function jt(e,t,n){At=(0,a.Lo)(),Ot=window.matchMedia(`(max-height: ${t}px)`),Pt=0,Ut=0,qt=n,Ft=e,window.addEventListener(It.t.RESIZE,Bt),Ft.addEventListener(It.t.MOUSEENTER,Kt),Ft.addEventListener(It.t.MOUSELEAVE,zt),Ft.addEventListener(It.t.FOCUS,Vt,!0),Ft.addEventListener(It.t.BLUR,Zt,!0),At.subscribe("ContextMenuPopup",Qt),At.subscribe("ShyHeaderActivated",Xt,!0),Bt()}function Bt(){Jt()?(0!==Pt&&window.clearTimeout(Pt),Pt=window.setTimeout((()=>{Jt()&&null!=Ft&&null!=qt&&(Ht||function(){if(null!=qt&&null!=Ft){let e=(0,at.j)();Nt=(0,H.nV)(`${Tt.shyHeader} o365cs-base ${e.navbar}`,vt),Nt.setAttribute("tabindex","0"),Mt=(0,H.nV)(Tt.shyHeaderOverlay);let t=(0,H.nV)(`${Tt.shyHeaderGripper} ${e.shyHeader}`);Nt.appendChild(Mt),Nt.appendChild(t),qt.appendChild(Nt),Nt.addEventListener(It.t.MOUSEDOWN,_t),Nt.addEventListener(It.t.FOCUS,Gt),(0,H.nj)(Ft,Tt.headerAnimations),(0,H.nj)(qt,Tt.workloadDivAnimations),Ht=!0}}(),(0,H.bO)(Ft,Tt.headerSlideIn),(0,H.bO)(qt,Tt.workloadDivSlideIn),(0,H.nj)(Ft,Tt.headerSlideOut),(0,H.nj)(qt,Tt.workloadDivSlideOut),Ft.onanimationend=e=>{"headerSlideOutFrames"===e.animationName&&(At.invoke("ShyHeaderActivated",!0),xt=!0)})}),wt)):Ot.matches&&!Et||Wt()}function Wt(e){xt&&null!=Nt&&null!=Ft&&null!=qt&&(Nt.style.visibility="hidden",Nt.style.display="none",Mt.style.visibility="hidden",Mt.style.display="none",Ft.style.display="flex",(0,H.bO)(Ft,Tt.headerSlideOut),(0,H.bO)(qt,Tt.workloadDivSlideOut),(0,H.nj)(Ft,Tt.headerSlideIn),(0,H.nj)(qt,Tt.workloadDivSlideIn),Ft.onanimationend=t=>{"headerSlideInFrames"===t.animationName&&(At.invoke("ShyHeaderActivated",!1),xt=!1,e&&document.getElementById(Dt.pG).focus())})}function _t(e){kt=!0}function Gt(e){Wt(!kt),kt=!1}function Kt(e){Lt=!0}function zt(e){Lt=!1,Bt()}function Vt(e){Rt=!0}function Zt(e){Rt=!1,0!==Ut&&window.clearTimeout(Ut),Ut=window.setTimeout((()=>{Rt||Bt()}),50)}function Qt(e){Et=e,e||Bt()}function Xt(e){e&&null!=Nt&&null!=Ft&&(Nt.style.visibility="visible",Nt.style.display="flex",Mt.style.visibility="visible",Mt.style.display="flex",Ft.style.display="none")}function Jt(){return Ot.matches&&!xt&&!Lt&&!Rt&&!Et}var Yt=n(35439);function $t(){(0,a.Lo)().invoke("FlexPane400ZoomActivated",(0,Yt.E)())}let en=!1,tn=!1;function nn(e,t){if(!en){let e=(0,a.aH)();if(e&&e.supportShyHeaderMode){let t=document.getElementById(e.top);jt(document.getElementById(N.WZ),e.shyHeaderActivationHeight?e.shyHeaderActivationHeight:Yt.J,t),en=!0}}tn||(window.addEventListener(It.t.RESIZE,$t),tn=!0)}var an=n(53090),rn=n(30884),sn=n(94425),on=n(40607),ln=n(40255);class cn extends i.Component{componentDidMount(){this.props.isAvailable&&(0,a.jl)().perfMarker("MyDayTimeToInteractive")}render(){let e={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:f.b.MyDay,affordanceMenuItemText:f.b.MyDay,iconID:"EventToDoLogo",iconFontSize:H.GX.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(on.s,Object.assign({},e)):i.createElement(ln.b,Object.assign({},e))}}const un=(0,s.connect)(((e,t)=>{var n;return{isAvailable:e.shellInitDataState.clientData.OpxEnabled&&e.shellInitDataState.clientData.MyDayOpxEnabled,id:null==t?void 0:t.id,isActive:"MyDay"===(null===(n=e.flexPaneState)||void 0===n?void 0:n.activeProviderKey),controlDimensionsChanged:t.controlDimensionsChanged}}),(e=>({onClick:(t,n)=>{var i;t.stopPropagation(),(0,a.jl)().click("MyDay","NavBar",null,null,`Active state: ${n.isActive}, Render context: ${n.renderContext}`),e((0,o.uS)(null===(i=t.currentTarget)||void 0===i?void 0:i.id)),e((0,ot.yG)("MyDay")),n.onClick&&n.onClick(t)}})),((e,t,n)=>{let a=Object.assign(Object.assign({},n),e);return Object.assign(Object.assign(Object.assign({},a),t),{onClick:e=>t.onClick(e,a),onDimensionsChanged:()=>t.onDimensionsChanged(a)})}))(cn);function dn(e,t){if(t.OpxEnabled&&t.MyDayOpxEnabled&&!(0,u.So)(t.WorkloadId,e.CurrentMainLinkElementID)){(0,a.Lo)().unsubscribe("ShellDataUpdated",dn);const e=()=>n.e("myday").then(n.bind(n,14075));let t={component:(0,U.k)((()=>e().then((e=>e.MyDayFlexPaneConnector)))),key:"MyDay",width:an.y};(0,a.Lo)().invoke("LazyComponentLoaded",sn.q,un),t.nativeControlID="MyDay",(0,rn.e)().dispatch((0,ot.wd)(t))}}var pn=n(97260),hn=n(96917);const gn="LazyDocumentTitleComponentName";(0,hn.Q)(gn);let mn=!1;class fn{SetProps(e){(mn?Promise.resolve():n.e("dtt").then(n.bind(n,57617)).then((e=>{mn=!0,(0,a.Lo)().invoke("LazyComponentLoaded",gn,e.DocumentTitleConnector)}))).then((()=>(0,o.ef)().dispatch((0,pn.L)(e))))}}var Sn=n(31833);let yn,Cn;class bn{UpdateAccount(e,t,n){if(window.MastInteraction)try{window.MastInteraction.UpdateAccount(e,t,n)}catch(e){(0,a.jl)().exception("MAST_UpdateAccount_Failed",6,e)}}SetActiveAccount(e){if(window.MastInteraction)try{window.MastInteraction.SetActiveAccount(e)}catch(e){(0,a.jl)().exception("MAST_SetActiveAccount_Failed",6,e)}}UpdateMastConfiguration(e){if(window.MastInteraction)try{window.MastInteraction.UpdateConfiguration(e)}catch(e){(0,a.jl)().exception("MAST_UpdateConfiguration_Failed",6,e)}}Init(){(0,a.Lo)().subscribe("ShellDataUpdated",In,!0)}}function In(e,t){var i;let r=(0,a.aH)();if(!t.DisableAccountSwitchingGlobally&&t.AccountSwitchingEnabled&&r.shellAuthProviderConfig){yn=null===(i=null==e?void 0:e.SignOutLink)||void 0===i?void 0:i.Url;let s,o=r.shellAuthProviderConfig.login_Hint,l={authenticatedState:1,upn:o||t.UPN,idp:t.IsConsumerShell?"msa":"aad"},c={isMSAAccount:t.IsConsumerShell,puid:t.PUID,upn:t.UPN},u=On(t.AppHeaderLinkText);void 0===u.postAccountSwitchRedirectUri&&(s={modifySwitchAccountRedirectUriFunction:vn}),void 0===u.postLogoutRedirectUri&&(s=Object.assign(Object.assign({},s),{modifySignoutRedirectUriFunction:wn})),s=Object.assign(Object.assign({},s),{afterSwitchAccountPromptCallbackFunction:Tn,afterSignOutPromptCallbackFunction:Dn}),window.LoadMastPromptJs={Download:An},n.e("mast").then(n.bind(n,19774)).then((n=>{new n.MultiAccountSessionTracker(u,s),Cn.UpdateAccount(t.PUID,l,!0),window.addEventListener("message",xn.bind(self,c,e.SignOutLink),!1),(0,a.Lo)().subscribe("AppNameChanged",Ln,!0)})).catch((e=>(0,a.jl)().exception("MASTPackage_DownLoad_Failed",6,e))),(0,a.Lo)().unsubscribe("ShellDataUpdated",In)}}function Tn(){(0,a.jl)().click("SwitchPopup","Mast"),(0,Sn.x)().catch((e=>{(0,a.jl)().exception("MAST_Switch_ClearSessionStorage_Failed",6,e)}))}function Dn(){(0,a.jl)().click("SignOutPopup","Mast"),(0,Sn.x)().catch((e=>{(0,a.jl)().exception("MAST_Signout_ClearSessionStorage_Failed",6,e)}))}function vn(e,t,n){let i=(0,a.aH)().shellAuthProviderConfig;if(i&&i.appSwitchToUrl&&"function"==typeof i.appSwitchToUrl){let n={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0},nextAccount:{type:"msa"===t.idp?"msa":"aad",login_hint:t.upn,memberName:t.upn,authenticatedState:"signedIn",cid:void 0}};return i.appSwitchToUrl(n)}return n||void 0}function wn(e,t){let n=(0,a.aH)().shellAuthProviderConfig;if(n&&"function"==typeof n.appSignOutUrl){let t={currentAccount:{type:"msa"===e.idp?"msa":"aad",login_hint:e.upn,memberName:e.upn,authenticatedState:"signedIn",cid:void 0}};return n.appSignOutUrl(t)}}function An(e){n.e("mastprompt").then(n.t.bind(n,13437,23)).then((()=>{e&&e()})).catch((e=>(0,a.jl)().exception("MASTPromptPackage_DownLoad_Failed",6,e)))}function On(e){let t,n=(0,a.aH)(),i=!0,r=n.shellAuthProviderConfig,s=r.appSwitchToUrl||r.appSignInUrl;s&&"string"==typeof s?t=s:i=!1;let o=r.appSignOutUrl;return{appFriendlyName:e,enablePageRedirect:!0,postLogoutRedirectUri:o&&"string"==typeof o?o:yn,postAccountSwitchRedirectUri:t,mastPromptLocalizedStrings:{appFriendlyName:e,switchAccountTitle:f.b.SwitchAccountTitle,switchAccountDescriptionWithUpn:f.b.SwitchAccountDescriptionWithUpn,switchAccountDescriptionWithoutUpn:f.b.SwitchAccountDescriptionWithoutUpn,switchAccountSubDescription:"",switchAccountButtonText:f.b.SwitchAccountButtonText,signOutTitle:f.b.SignOutTitle,signOutDescriptionWithUpn:f.b.SignOutDescriptionWithUpn,signOutDescriptionWithoutUpn:f.b.SignOutDescriptionWithoutUpn,signOutSubDescription:"",signOutButtonText:f.b.SignOutButtonText},appendLoginHint:i,enableConsoleLogging:!1,enableAutomaticPopup:!n.shellDataOverrides.DisableMASTPopup}}function xn(e,t,n){var i,r,s,o;if("SwitchAccountRedirect"===(null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.request))(null===(r=null==n?void 0:n.data)||void 0===r?void 0:r.url)?((0,a.jl)().click("Switch","Mast"),window.removeEventListener("message",xn.bind(n,e,t),!1),(0,a.Lo)().invoke("AccountSwitchInitiated",e)):(0,a.jl)().tag("MAST_MissingSwitchUrl",4);else if("SignOutBackToLanding"===(null===(s=null==n?void 0:n.data)||void 0===s?void 0:s.request))if(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.url){(0,a.jl)().click("SignOut","Mast"),window.removeEventListener("message",xn.bind(n,e,t),!1),null!=t.Action&&t.Action();let i={triggerEvent:n};(0,a.Lo)().invoke("SignOut",i)}else(0,a.jl)().tag("MAST_MissingSignOutUrl",4)}function Ln(e){let t=On(e);Cn.UpdateMastConfiguration(t)}!function(){let e=(0,o.ef)().getState();e.userState.isConsumer||o.YA.register(A),function(){let e=new k,t=window.O365Shell.Apps;window.O365Shell.Apps=e,t.applyCalls(e)}(),e.userState.isConsumer||(0,a.Lo)().subscribe("ShellDataUpdated",R,!0)}(),P=(0,a.Lo)().subscribe("ShellDataUpdated",((e,t)=>{if(t.NotificationsEnabled){(0,a.Lo)().unsubscribe("ShellDataUpdated",P);const e=()=>n.e("notifications").then(n.bind(n,55168)).catch((e=>(0,a.jl)().exception("NotificationsPackage_LoadFail",6,e)));let t=(0,a.aH)();t&&t.layout?t.layout.centerCustomizationRegion&&(0,E.Y5)("NotificationBellIcon",t.layout.centerCustomizationRegion.children)&&e():e()}}),!0),function(){W=()=>n.e("extraflexpane").then(n.bind(n,39075));let e=window.O365Shell.NFD;e.registerShimCallback&&e.registerShimCallback((()=>{W()}),["OpenHelp","OpenFeedback"]);const t=(0,U.k)((()=>W().then((e=>e.HelpFlexPanePanelConnector))));let i=(0,a.aH)(),r={component:t,key:"Help",width:F.yh,overrideOnClick:i.OnHelpButtonClick};if(i.layout){(0,a.Lo)().invoke("LazyComponentLoaded",M.d,B),r.nativeControlID="HelpIcon"}else r.btnId=N.rm;(0,o.ef)().dispatch((0,F.wd)(r)),(0,a.Lo)().subscribe("ShellDataUpdated",_,!0)}(),(0,a.Lo)().subscribe("ShellDataUpdated",K,!0),(0,a.Lo)().subscribe("ShellDataUpdated",Z,!0),function(){o.YA.register(Ae),function(){let e=new xe,t=window.O365Shell.Settings;window.O365Shell.Settings=e,t.applyCalls(e)}();const e=(0,U.k)((()=>n.e("extraflexpane").then(n.bind(n,80424)).then((e=>e.SettingsFlexPanePanelConnector))));(0,a.Lo)().subscribe("ShellDataUpdated",Le,!0);let t=(0,a.aH)().layout,i={component:e,key:"Settings",width:F.yh};if(t){(0,a.Lo)().invoke("LazyComponentLoaded",Q.F,Y),i.nativeControlID="SettingsIcon"}else i.btnId=N.JT;(0,o.ef)().dispatch((0,F.wd)(i))}(),o.YA.register(Ue),(0,a.Lo)().subscribe("ShellDataUpdated",Ne,!0),function(){o.YA.register(et),function(){let e=new ct,t=window.O365Shell.Extensibility;window.O365Shell.Extensibility=e,t.applyCalls(e)}();let e,t=(0,o.ef)();function n(){let n=t.getState();if(e!==n.extensibilityState.customFlexPaneHash){Object.keys(n.extensibilityState.customFlexPanes).forEach((e=>{if(!n.flexPaneState.registeredProviders.some((t=>t.key===e))){const a=n.extensibilityState.customFlexPanes[e],i=n.extensibilityState.customFlexpaneWidth?n.extensibilityState.customFlexpaneWidth:F.yh;t.dispatch((0,F.wd)({component:je,btnId:a.triggerControlID,shellControlID:a.triggerControlID,key:e,width:i}))}}))}e=n.extensibilityState.customFlexPaneHash}n(),(0,a.Lo)().invoke("LazyComponentLoaded",Me.B,ze),t.subscribe(n)}(),(0,C.$_)(),function(){const e=()=>n.e("diagnostics").then(n.bind(n,44721));let t=window.O365Shell.Diagnostics;t.registerShimCallback&&t.registerShimCallback((()=>{e()}),["GetServiceDiagnostics","GetClientDiagnostics"]),window.O365ShellContext.DiagnosticsEnabled&&e()}(),function(){const e=new dt,t=window.O365Shell.Abt;window.O365Shell.Abt=e,t.applyCalls(e);const n=(0,a.aH)();n.abtTimeout&&window.O365Shell.Abt.Init(n.abtTimeout,n.abtSigninState,n.abtControls,n.abtSessionId,n.abtDisableTrackEvents)}(),o.YA.register(Ct),function(){let e=new yt,t=window.O365Shell.FeatureFlags;window.O365Shell.FeatureFlags=e,t.applyCalls(e)}(),(0,a.Lo)().subscribe("ShellDataUpdated",bt,!0),(0,a.Lo)().subscribe("ShellDataUpdated",nn,!0),function(){let e=(0,a.aH)();e&&e.layout&&e.layout.centerCustomizationRegion&&(0,E.Y5)("MyDay",e.layout.centerCustomizationRegion.children)&&(0,a.Lo)().subscribe("ShellDataUpdated",dn,!0)}(),function(){let e=new fn,t=window.O365Shell.DTT;window.O365Shell.DTT=e,t&&t.applyCalls(e)}(),(0,a.aH)().shellAuthProviderConfig&&(Cn=new bn,Cn.Init()),(0,a.Lo)().invoke("PlusLoaded"),(0,a.jl)().perfMarker("shell_plus_executioncomplete")},40647:function(e,t,n){"use strict";var a;n.d(t,{K:function(){return a}}),function(e){e.Theme="theme",e.LanguageAndRegion="languageandregion",e.NavBarDataLinks="navbardatalinks",e.ChangePassword="changepassword",e.ContactPreferences="contactpreferences",e.AboutBase="aboutbase",e.About="about",e.DarkMode="darkmode",e.CPNIPin="cpnipin"}(a||(a={}))},55309:function(e,t,n){"use strict";n.d(t,{$y:function(){return S},AF:function(){return l},CR:function(){return u},FF:function(){return m},Jf:function(){return g},N0:function(){return r},Q5:function(){return o},R6:function(){return p},eV:function(){return s},gR:function(){return h},i7:function(){return y},iM:function(){return f},jG:function(){return i},nf:function(){return d},qe:function(){return C},rw:function(){return c},zS:function(){return b},zt:function(){return I}});var a=n(30534);function i(e){return{type:a.do,newWorkloadSettingLink:e}}function r(e){return{type:a.w0,settingLinkID:e}}function s(e){return{type:a.K4,newWorkloadSettingsLinks:e}}function o(e){return{type:a.SL,cardData:e}}function l(e){return{type:a.Cr,selectedLanguage:e}}function c(e){return{type:a.EF,languageChoices:e}}function u(e){return{type:a.$w,selectedTimeZone:e}}function d(e,t,n){return{type:a.lj,timeZoneChoice:e,dateFormatChoice:t,timeFormatChoice:n}}function p(e){return{type:a.rg,timeZoneChoices:e}}function h(e){return{type:a.J5,selectedLanguage:e}}function g(e){return{type:a.Oy,selectedDateFormat:e}}function m(e){return{type:a.$I,dateFormatChoices:e}}function f(e){return{type:a.sI,selectedTimeFormat:e}}function S(e){return{type:a.i1,timeFormatChoices:e}}function y(){return{type:a.NS}}function C(){return{type:a.M9}}function b(e){return{type:a.Vx,cardId:e}}function I(e){return{type:a.nl,isExpanded:e}}},30534:function(e,t,n){"use strict";n.d(t,{$I:function(){return f},$w:function(){return d},Cr:function(){return c},EF:function(){return u},J5:function(){return g},K4:function(){return o},M9:function(){return i},NS:function(){return a},Oy:function(){return m},SL:function(){return l},Vx:function(){return C},do:function(){return r},i1:function(){return y},lj:function(){return p},nl:function(){return b},rg:function(){return h},sI:function(){return S},w0:function(){return s}});const a="suiteux-settings.SAVE_SELECTIONS",i="suiteux-settings.CANCEL_SELECTIONS",r="suiteux-settings.ADDORUPDATE_WORKLOADSETTINGLINK",s="suiteux-settings.REMOVE_WORKLOADSETTINGLINK",o="suiteux-settings.SET_WORKLOADSETTINGSLINKS",l="suiteux-settings.INITIALCARDS_AVAILABLE",c="suiteux-settings.LANGUAGECHOICE_AVAILABLE",u="suiteux-settings.LANGUAGECHOICES_AVAILABLE",d="suiteux-settings.SELECTEDTIMEZONE_CHANGED",p="suiteux-settings.TIMEZONEANDFORMATSCHOICE_AVAILABLE",h="suiteux-settings.TIMEZONECHOICES_AVAILABLE",g="suiteux-settings.SELECTEDLANGUAGE_CHANGED",m="suiteux-settings.SELECTEDDATEFORMAT_CHANGED",f="suiteux-settings.DATEFORMATCHOICES_AVAILABLE",S="suiteux-settings.SELECTEDTIMEFORMAT_CHANGED",y="suiteux-settings.TIMEFORMATCHOICES_AVAILABLE",C="suiteux-settings.NAVIGATE_TO_CARD",b="suiteux-settings.O365_SETTINGS_EXPANDED"},14643:function(e,t,n){"use strict";n.d(t,{F:function(){return S}});var a=n(59633),i=n(84735),r=n(91011);function s(e){return!e.UseSimplifiedLanguageCard&&(1==(1&e.UserType)&&!(0,a.o5)(e.WorkloadId))}function o(e){return!e.ShowContactPreferencesCard}function l(e){return!(0,i.q)(e)}function c(e){const t=(0,r.q4)().getThemeState().disableTheming;return e.IsConsumerShell?!(e.CSSExperiencesEnabled&&e.ConsumerThemingEnabled):!!t}var u=n(40647);const d=[u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences,u.K.NavBarDataLinks],p=[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences],h={default:[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],iwapp:[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],exchange:[],exchangeadmin:p,officepwa:[u.K.Theme,u.K.DarkMode,u.K.AboutBase,u.K.NavBarDataLinks],botdesigner:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365:p,dynamics365ci:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365fraudprotection:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365powerplatform:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],dynamics365productinsights:[u.K.NavBarDataLinks,u.K.ChangePassword,u.K.ContactPreferences],adminportal:[u.K.NavBarDataLinks,u.K.Theme,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences,u.K.CPNIPin],flow:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],teamsappstudio:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences],microsoftstream:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],todo:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.DarkMode,u.K.ChangePassword,u.K.ContactPreferences],microsoftclipchamp:[u.K.NavBarDataLinks,u.K.LanguageAndRegion,u.K.ChangePassword,u.K.ContactPreferences],powerappsportal:[u.K.NavBarDataLinks,u.K.Theme,u.K.ChangePassword,u.K.ContactPreferences],vivagoals:[],promptlibbie:[],vivalearning:[u.K.NavBarDataLinks,u.K.Theme,u.K.DarkMode],protectioncenter:p,wordonline:d,powerpointonline:d,excelonline:d,visioonline:d,onenoteonline:d,wac:d};var g=n(27676);let m={[u.K.NavBarDataLinks]:{EnableConsumer:!0},[u.K.Theme]:{Title:g.b.Themes,EnableConsumer:!0},[u.K.ChangePassword]:{Title:g.b.Password,Description:g.b.PasswordDescription,EnableConsumer:!1,ChangePasswordCardData:[{WorkloadId:"dynamics365businesscentral",QueryStringData:[{Key:"ru",Value:"https://businesscentral.dynamics.com?redirectedfromsignup=1"}]}]},[u.K.ContactPreferences]:{Title:g.b.ContactPreferences,Description:g.b.ContactPreferencesDescription,EnableConsumer:!1},[u.K.LanguageAndRegion]:{Title:g.b.LanguageAndTimeZone,Description:g.b.LanguageAndTimeZoneDescription,EnableConsumer:!1},[u.K.AboutBase]:{Title:g.b.About,EnableConsumer:!0,ChildCardIds:[u.K.About]},[u.K.About]:{Title:g.b.About,EnableConsumer:!0},[u.K.DarkMode]:{Title:g.b.DarkThemeTitle,EnableConsumer:!1},[u.K.CPNIPin]:{Title:g.b.CPNIPinCardTitle,EnableConsumer:!1}};const f="default";function S(e,t,n){const a={[u.K.LanguageAndRegion]:s(e),[u.K.NavBarDataLinks]:l(n),[u.K.Theme]:c(e),[u.K.ContactPreferences]:o(e)};let i;i=e.CurrentMainLinkElementID&&"shellofficedotcom"===e.CurrentMainLinkElementID.toLowerCase()?"iwapp":e.CurrentMainLinkElementID&&"shellofficepwa"===e.CurrentMainLinkElementID.toLowerCase()?"officepwa":e.CurrentMainLinkElementID&&"shellstream"===e.CurrentMainLinkElementID.toLowerCase()?"microsoftstream":e.CurrentMainLinkElementID&&"clipchamp"===e.CurrentMainLinkElementID.toLowerCase()?"microsoftclipchamp":e.WorkloadId.toLowerCase();let r=null!=t?m[t].ChildCardIds:h[i]?h[i]:h[f],d=e.IsConsumerShell;return r?r.filter((t=>!e.IsGuestMode||t===u.K.NavBarDataLinks)).filter((e=>!d||m[e].EnableConsumer)).filter((e=>!a[e])).map((e=>Object.assign({Id:e},m[e]))):[]}},41198:function(e,t,n){"use strict";n.d(t,{n:function(){return M}});var a=n(20851),i=n(91011),r=n(9028),s=n(93643),o=n(28949);class l extends o.V{initializeComponent(){}getMruDocuments(e,t){return new Promise(((n,r)=>{let o=(0,s.Uw)("{0}?rs={1}&show={2}&sort=date",this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.CultureName,e.toString());null!=t&&(o+="&apps="+t);const l={method:a.FH.GET,resource:this.SuiteApi.Configuration.MruOauthResourceUrl,url:o};this.SuiteApi.Service.callEndpointWithOauthToken(l).then((e=>{(0,i.jl)().perfMarker("shell_mru_fetch_complete"),n(e)})).catch((e=>{a.LU.genericServiceRejection("Documents_GetMRUDocuments_Failed",6,e,r)}))}))}prefetchMruAccessToken(){null!=this.SuiteApi.Configuration.MruOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.MruOauthEndpointUrl,this.SuiteApi.Configuration.MruOauthResourceUrl)}initializeGraphApi(){null!=this.SuiteApi.Configuration.GraphOauthResourceUrl&&this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthEndpointUrl,this.SuiteApi.Configuration.GraphOauthResourceUrl)}createNewDocument(e){const t={name:e,file:{},"@microsoft.graph.conflictBehavior":"rename"},n={method:a.FH.POST,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthEndpointUrl,headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(n).then(e).catch((e=>{a.LU.genericServiceRejection("Documents_CreateNewDocument_Failed",4,e,t)}))}))}getDocumentUrl(e,t){let n;return new Promise(((a,i)=>{null!=e?this.createNewDocument(e).then((e=>{null!=e&&null!=e.webUrl?(n=e.webUrl.replace(new RegExp("([?&])action[^&]*"),"$1action=editnew"),-1===n.lastIndexOf("action=editnew")&&(n=(0,s.aM)(n,"action","editnew"))):n=t,a(n)})).catch((e=>i(e))):(n=t,a(n))}))}}var c,u=n(81235),d=n(62452),p=n(9264);!function(e){e.UpdateConfig="UpdateConfig",e.UpdateToken="UpdateToken",e.ChangeTheme="ChangeTheme",e.UpdateData="UpdateData"}(c||(c={}));var h=n(56003);class g extends o.V{constructor(){super(),this.opxFrameToComponentMap={},this.opxComponentData={},this.opxTimers={},this.opxOutstandingOpxQueries={},this.currentOpxQueryID=0,this.OpxInitializationTimeout=15e3,this.handleIncomingOpxMessage=e=>{var t;let n=!1;const a=this.opxFrameToComponentMap[e.instanceId];if(null!=a)switch(e.notificationType){case d.C.LifeCycle:switch(e.asyncContext){case d.A.GetConfig:const i=null===(t=this.opxComponentData[a])||void 0===t?void 0:t.opxComponentConfiguration;null!=i&&(n=this.onGetConfigRequest(e.instanceId,i));break;case d.A.RefreshToken:n=this.onRefreshTokenRequest(e.instanceId);break;case d.A.Closed:n=this.onOpxClosedRequest(a);break;case d.A.PageReady:case d.A.FatalError:n=this.onReadyOrError(a,e)}break;case d.C.ChallengeToken:n=this.onRefreshTokenRequest(e.instanceId);break;case d.C.DataProviderResponseNotification:const i=e.asyncContext;if(i.success){const t=this.opxOutstandingOpxQueries[e.instanceId];if(t){Object.keys(t).filter((e=>t[e].queryType===i.type)).forEach((e=>{t[e].onQueryComplete(i.response)}))}}}return n},this.validateIncomingOpxMessage=e=>e.apiName===h.r2,this.validateIncomingOpxMessageOrigin=e=>e.toLowerCase()===this.SuiteApi.Configuration.TokenFactoryIframeOrigin,this.onGetConfigRequest=(e,t)=>(this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:e,message:{eventType:c.UpdateConfig,asyncResult:t}}),!0),this.onRefreshTokenRequest=e=>(this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:e,message:{eventType:c.UpdateToken,asyncResult:null}}),!0),this.onOpxClosedRequest=e=>{let t=null;if(e===u.x.MyDay)t="MyDay";return null!=t&&window.O365Shell.FlexPane.CloseFlexPaneForProvider(t),!0},this.onReadyOrError=(e,t)=>{const n=this.opxComponentData[e];if(!n)throw new Error("Message received for an OPX component that no longer exists.");if(n.initCompleteCallback&&!n.initializationResult){const e=t.asyncContext===d.A.PageReady?0:5;n.initCompleteCallback(e)}else n.messageListener&&n.messageListener(t);return!0}}initializeComponent(){this.opxHostUrl=this.SuiteApi.Configuration.OpxHostUrl,this.opxResourceUrl=this.SuiteApi.Configuration.OpxResourceUrl,this.upn=this.SuiteApi.Configuration.CurrentUserUpn,this.opxSystemConfigurationPromise=this.initializeOpxOrchestrator()}prefetchOpxAccessToken(e){this.opxSystemConfigurationPromise.then((t=>{null==this.opxSystemConfiguration&&(this.opxSystemConfiguration=t);const n=this.opxSystemConfiguration.OpxEndpoints[e];void 0!==n&&this.SuiteApi.Service.prefetchAccessToken(n.OpxOAuthResourceUrl,n.OpxOAuthResourceUrl)})).catch((e=>{(0,i.jl)().tag("OwaPoweredExperiences_PrefetchAccessTokenFailed",1,e)}))}initializeOpx(e,t,n,a){let r=document.getElementById(t);if(!r)return Promise.resolve(2);this.prefetchOpxAccessToken(u.x.MyDay);const s=new Promise((s=>{this.opxSystemConfigurationPromise.then((o=>{null==this.opxSystemConfiguration&&(this.opxSystemConfiguration=o),this.opxFrameToComponentMap[t]=e,this.opxComponentData[e]={frameID:t,opxComponentConfiguration:n,initCompleteCallback:t=>{switch(t){case 0:case 5:this.opxComponentData[e].initializationResult=t}s(t)},messageListener:a},r.onerror=(e,t,n,a,r)=>{const o=JSON.stringify(null!=e?e:"Script error");(0,i.jl)().exception(o,6,r,t,n,a),s(3)},r.src=this.createOpxFrameUrl(e,t)})).catch((()=>{s(1)}))}));return Promise.race([new Promise((t=>{s.then((n=>{clearTimeout(this.opxTimers[e]),t(n)}))})),new Promise((t=>{clearTimeout(this.opxTimers[e]),this.opxTimers[e]=window.setTimeout((()=>{clearTimeout(this.opxTimers[e]),t(4)}),this.OpxInitializationTimeout)}))])}changeTheme(e,t,n){const a=this.opxComponentData[e];if(0!==a.initializationResult)throw new Error("Theme cannot be changed before OPX is in the operational state.");const i=a.frameID,r={UseDarkMode:n};n?r.DarkPalette=t:r.LightPalette=t,this.SuiteApi.Service.callOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:i,message:{eventType:c.ChangeTheme,asyncResult:r}})}updateData(e,t,n){const a=this.opxComponentData[e];if(!a||0!==a.initializationResult)return Promise.reject(new Error("UpdateData cannot be called before OPX is in the operational state."));const i={type:t,request:n};return this.queryOpxIframe({opxHostUrl:this.opxHostUrl,targetOpxInstance:a.frameID,message:{eventType:c.UpdateData,asyncResult:i}})}createOpxFrameUrl(e,t){if(null==this.opxSystemConfiguration||null==this.opxSystemConfiguration.OpxRootUrlLowerCase||null==this.opxSystemConfiguration.OpxEndpoints[e]||null==this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl)throw new Error("OPX system configuration incomplete.");return`${this.opxSystemConfiguration.OpxRootUrlLowerCase}${this.opxSystemConfiguration.OpxEndpoints[e].OpxEndpointUrl}?hostApp=o365shell&frameName=${p.TokenFactoryIFrameID}&opxInstanceId=${t}&OpxHostOrigin=${this.SuiteApi.Configuration.TokenFactoryIframeOrigin}`}initializeOpxOrchestrator(){return new Promise(((e,t)=>{this.fetchSystemConfiguration().then((n=>{this.SuiteApi.Service.registerOpxHost(this.opxResourceUrl,this.opxHostUrl,this.OpxInitializationTimeout).then((()=>{this.registerOpxMessageListener(),e(n)})).catch((e=>{(0,i.jl)().exception("OPX_RegisterOpxHost_Failure",6,e),t(e)}))})).catch((e=>{(0,i.jl)().exception("OPX_FetchSystemConfiguration_Failure",6,e),t(e)}))}))}fetchSystemConfiguration(){return Promise.resolve({OpxEndpoints:{MyDay:{OpxEndpointUrl:this.upn?`/opx/${this.upn}/myday`:"/opx/myday",OpxOAuthResourceUrl:this.opxResourceUrl},ExchangeData:{OpxEndpointUrl:this.upn?`/opx/${this.upn}/dataprovider`:"/opx/dataprovider",OpxOAuthResourceUrl:this.opxResourceUrl}},OpxRootUrlLowerCase:this.opxHostUrl.toLowerCase(),OpxSupported:!0})}registerOpxMessageListener(){this.SuiteApi.Service.registerPostMessageHandler({handleMessage:this.handleIncomingOpxMessage,validateMessage:this.validateIncomingOpxMessage,validateOrigin:this.validateIncomingOpxMessageOrigin})}queryOpxIframe(e,t=5e3){const n=e.message.asyncResult;return new Promise(((a,i)=>{this.SuiteApi.Service.callOpxIframe(e),null==this.opxOutstandingOpxQueries[e.targetOpxInstance]&&(this.opxOutstandingOpxQueries[e.targetOpxInstance]={});const r=this.currentOpxQueryID++,s=this.opxOutstandingOpxQueries[e.targetOpxInstance],o=setTimeout((()=>{delete s[r],i(new Error("Query timeout."))}),t);s[r]={id:r,opxFrameID:e.targetOpxInstance,queryType:n.type,onQueryComplete:e=>{clearTimeout(o),delete s[r],a(e)}}}))}}var m=n(77224);var f=n(47487),S=n(62244),y=n(63481),C=n(43474);class b{constructor(e){this.userTheme=e}GetUserThemeId(){return(0,i.q4)().getCurrentThemeId()}ChangeTheme(e){}SaveTheme(e,t){return new Promise(((n,a)=>{this.userTheme.setUserTheme(e,t).then((e=>{e.O365Success||e.OwaSuccess?n():a(new Error("SaveThemeFailure"))})).catch(a)}))}SaveDarkTheme(e){return new Promise(((t,n)=>{this.userTheme.setUserThemeSettingsInWCSS(e).then((e=>{e.O365Success||e.OwaSuccess?t():n(new Error("SaveThemeFailure"))})).catch(n)}))}GetModeLogo(e){return new Promise(((t,n)=>{this.userTheme.getModeLogo(e).then((e=>{if(e){let n="";e.HasTenantLogo&&(e.LogoUrl?n=e.LogoUrl:e.LogoData&&(n=e.LogoData));const a={isLogoVisible:!0,logoUrl:n,logoNavigationUrl:e.HomePageUrl?e.HomePageUrl:""};return t(a)}return n(new Error("GetModeLogoFailure"))})).catch(n)}))}SetUserThemesData(e){(0,s.ef)().dispatch((0,s.gJ)(e))}}class I extends o.V{initializeComponent(){(0,i.q4)().setUserThemesHandler(new b(this))}loadUserThemeChoices(){return this.checkInitialized(),(0,i.q4)().loadAllThemeJson()}setUserTheme(e,t){this.checkInitialized(),this.clearUserThemeCache();let n,a=e=e.replace(/^\w/,(e=>e.toUpperCase()));return e.toLowerCase()===y.fy&&t&&(a=y.wn),n=f.X((()=>this.setUserThemeInWCSS(e,e.toLowerCase()===y.fy&&t)),2),this.SuiteApi.Configuration.IsPwa?n:n.then((()=>f.X((()=>this.setUserThemeInExchange(a,!0)),2)))}setUserThemeInWCSS(e,t){return new Promise(((n,r)=>{const s={url:(0,S.Uw)("{0}/api/settings/theme",this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.FH.PUT,headers:C.A,body:JSON.stringify({ThemeID:e,PreferOfficeTheme:t})};(0,i.jl)().tag("SetUserThemeStart",1,"WCSS",e),this.SuiteApi.Service.callEndpointWithOauthToken(s).then((t=>{(0,i.jl)().tag("SetUserThemeSuccess",1,"WCSS",e),n({OwaSuccess:void 0,O365Success:!0})})).catch((e=>{a.LU.genericServiceRejection("Settings_SetUserThemeInWCSS_Failed",6,e,r)}))}))}setUserThemeSettingsInWCSS(e){return new Promise(((t,n)=>{const r={url:(0,S.Uw)("{0}/api/settings/darkmode",this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.FH.PUT,headers:C.A,body:JSON.stringify({IsDarkmode:e})};this.SuiteApi.Service.callEndpointWithOauthToken(r).then((n=>{(0,i.jl)().tag("SetUserThemeSettingsSuccess",1,e.toString()),t({O365Success:!0})})).catch((e=>{a.LU.genericServiceRejection("Settings_SetUserThemeSettingsInWCSS_Failed",6,e,n)}))}))}getModeLogo(e){return new Promise(((t,n)=>{const i={url:(0,S.Uw)(`{0}/api/theme/tenant?useDarkMode=${e}`,this.SuiteApi.Configuration.TokenFactoryIframeOrigin),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.FH.GET,headers:C.A};this.SuiteApi.Service.callEndpointWithOauthToken(i).then((e=>{t(e)})).catch((e=>{a.LU.genericServiceRejection("Settings_GetModeLogoFromWCSS_Failed",6,e,n)}))}))}setUserThemeInExchange(e,t){return new Promise(((n,r)=>{(0,i.q4)().getUserThemeByID(e).then((i=>{let s;s=this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.setUserThemeViaOpx(e,t):this.setUserThemeViaSuiteServiceProxy(e,t,i),s.then((e=>{n({OwaSuccess:e.OwaSuccess,O365Success:e.O365Success||t})})).catch((e=>{a.LU.genericServiceRejection("Settings_SetUserThemeInExchange_Failed",6,e,r)}))}))}))}setUserThemeViaOpx(e,t){return n.e("exchangedata").then(n.bind(n,5172)).then((n=>n.setUserTheme(e,t)))}setUserThemeViaSuiteServiceProxy(e,t,n){const a={ThemeId:e,SkipO365Call:t};n&&e!==y.wn&&(a.UserThemeJson=JSON.stringify(n));var i;const r={request:(i=a,(0,m.__assign)({__type:"SetUserThemeRequest:#Exchange"},i))};return new Promise(((e,t)=>{this.SuiteApi.User.getOwaUserConfiguration().then((t=>{let n=this.SuiteApi.Service.callOwaIframeAction("SetUserTheme",r);e(n)})).catch((e=>{t(e)}))}))}clearUserThemeCache(){this.SuiteApi.Configuration.ClearThemeCacheData&&0!==this.SuiteApi.Configuration.ClearThemeCacheData.length&&this.SuiteApi.Configuration.ClearThemeCacheData.map((e=>{if(null!=e.WorkloadUrl&&e.WorkloadUrl.length>0&&(!e.NoRequestInSameWorkload||this.SuiteApi.Configuration.WorkloadId.toLowerCase()!==e.WorkloadId.toLowerCase())&&null!=e.RequestType&&e.RequestType.length>0&&("img"===e.RequestType.toLowerCase()||"iframe"===e.RequestType.toLowerCase())){let t=document.createElement(e.RequestType);t.setAttribute("src",e.WorkloadUrl),t.setAttribute("style","display:none"),"iframe"===e.RequestType.toLowerCase()&&(t.addEventListener("load",(()=>document.body.removeChild(t))),document.body.appendChild(t))}}))}}function T(e){return(0,m.__assign)({__type:"JsonRequestHeaders:#Exchange"},e)}function D(e){return(0,m.__assign)({__type:"TimeZoneContext:#Exchange"},e)}var v={baseUrl:"/owa",isFeatureEnabled:function(){return!1},prefetchTaskQueue:new(function(){function e(e){void 0===e&&(e={maxParallelTasks:1,taskQuanta:0}),this.config=e,this.taskList={},this.numberOfTasksRunning=0}return e.prototype.add=function(e,t){var n=this;return void 0===t&&(t=0),this.taskList[t]||(this.taskList[t]=[]),new Promise((function(a,i){n.taskList[t].unshift({func:e,resolve:a,reject:i}),n.scheduleTask()}))},e.prototype.clear=function(){this.taskList={}},e.prototype.scheduleTask=function(){var e=this;this.config.taskQuanta<0?this.tryRunTask():setTimeout((function(){e.tryRunTask()}),this.config.taskQuanta||0)},e.prototype.tryRunTask=function(){var e=this,t=Object.keys(this.taskList);if(this.numberOfTasksRunning<(this.config.maxParallelTasks||1)&&t.length>0){var n=Math.min.apply(null,t.map((function(e){return parseInt(e)}))),a=this.taskList[n].pop();this.taskList[n]&&0!=this.taskList[n].length||delete this.taskList[n],this.numberOfTasksRunning++,a.func().then((function(t){a.resolve(t),e.onTaskComplete()})).catch((function(t){a.reject(t),e.onTaskComplete()})),this.scheduleTask()}},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e}())({taskQuanta:-1}),timeoutMS:9e4,disableAllRequests:!1},w=v;function A(e){return e||(e=w.timezone),T(e?{RequestServerVersion:"V2018_01_08",TimeZoneContext:D({TimeZoneDefinition:(t={Id:e},(0,m.__assign)({__type:"TimeZoneDefinitionType:#Exchange"},t))})}:{RequestServerVersion:"V2018_01_08"});var t}let O=n(96520),x=null;const L=a.xX.SuiteServiceApiRelativePath+"LanguageTimezone";let k=null,R=null;class E extends o.V{initializeComponent(){x=this.SuiteApi.Configuration.GraphOauthResourceUrl,null!=x&&(x=(0,s.Uw)("{0}/{1}",x,"v1.0/me"),k=(0,s.Uw)("{0}/{1}",x,"outlook/supportedLanguages"),R=(0,s.Uw)("{0}/{1}",x,"outlook/supportedTimeZones"))}getLanguageAndTimeZone(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageAndTimeZone():this.getSuiteLanguage()}getLanguageChoices(){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.getOwaLanguageChoices():this.getSuiteLanguageChoices()}getTimeZoneChoices(){return new Promise(((e,t)=>{let n={url:R,method:a.FH.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{e(t.value)})).catch((e=>{a.LU.genericServiceRejection("Settings_GetTimeZoneChoices_Failed",6,e,t)}))}))}getDateTimeFormats(e){return new Promise(((t,n)=>{const i={url:(0,s.Uw)("{0}/api/settings/datetimeformats?cultureName={1}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e),resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:a.FH.GET,headers:C.A};this.SuiteApi.Service.callEndpointWithOauthToken(i).then(t).catch((e=>{a.LU.genericServiceRejection("Settings_GetDateTimeFormats_Failed",6,e,n)}))}))}setLanguageAndTimeZone(e){return this.SuiteApi.Configuration.IsOwa||this.SuiteApi.Configuration.UserHasExchangeLicense?this.setOwaLanguageAndTimeZone(e):this.setSuiteLanguage(e.CurrentCultureName)}setSuiteLanguage(e){return new Promise(((t,n)=>{let i={url:x,method:a.FH.PATCH,headers:C.D,body:JSON.stringify({preferredLanguage:e})};this.SuiteApi.Service.callEndpointWithOauthToken(i).then((e=>{t()})).catch((e=>{a.LU.genericServiceRejection("Settings_SetSuiteLanguage_Failed",6,e,n)}))}))}setOwaLanguageAndTimeZone(e){return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise(((t,n)=>{e.CurrentCultureLcid=null;let i={Language:e.CurrentCultureName,TimeZone:e.CurrentTimeZone,DateFormat:e.CurrentDateFormat,TimeFormat:e.CurrentTimeFormat},r=(s={Header:A(),Options:i},(0,m.__assign)({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},s));var s;this.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("SetMailboxRegionalConfiguration",r,null).then((n=>{this.setSuiteLanguage(e.CurrentCultureName),t()})).catch((e=>{a.LU.genericServiceRejection("Settings_SetOwsOwaLanguageAndTimeZone_Failed",6,e,n)}))})):new Promise(((t,n)=>{e.CurrentCultureLcid=null,this.SuiteApi.Service.callOwaIframeResourceUrl(L,e,a.FH.PUT).then(t).catch((e=>{a.LU.genericServiceRejection("Settings_SetLanguageAndTimeZoneViaOwa_Failed",6,e,n)}))}))}getSuiteLanguageChoices(){return new Promise(((e,t)=>{O?e(O):t(new Error("Supported languages not found"))}))}getOwaLanguageChoices(){return new Promise(((e,t)=>{let n={url:k,method:a.FH.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{let n=t.value.map((e=>({Locale:e.locale,DisplayName:e.displayName})));e(n)})).catch((e=>{a.LU.genericServiceRejection("Settings_GetOwaLanguageChoices_Failed",6,e,t)}))}))}getSuiteLanguage(){return new Promise(((e,t)=>{let n={url:x,method:a.FH.GET};this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{let n={CurrentCultureName:t.preferredLanguage};e(n)})).catch((e=>{a.LU.genericServiceRejection("Settings_GetSuiteLanguage_Failed",6,e,t)}))}))}getOwaLanguageAndTimeZone(){return this.SuiteApi.Configuration.IsOwsLanguageTimezoneCallEnabled?new Promise(((e,t)=>{let n=(i={Header:A(),VerifyDefaultFolderNameLanguage:!1},(0,m.__assign)({__type:"GetMailboxRegionalConfigurationRequest:#Exchange"},i));var i;this.SuiteApi.Service.callOwaIframeActionWithAdditionalHeaders("GetMailboxRegionalConfiguration",n,null).then((t=>{let n=t.Options,a={CurrentCultureLcid:0,CurrentCultureName:n.Language,CurrentTimeZone:n.TimeZone,CurrentDateFormat:n.DateFormat,CurrentTimeFormat:n.TimeFormat};e(a)})).catch((e=>{a.LU.genericServiceRejection("Settings_GetOwsOwaLanguageAndTimeZone_Failed",6,e,t)}))})):new Promise(((e,t)=>{this.SuiteApi.Service.callOwaIframeResourceUrl(L,null,a.FH.GET).then((t=>{let n=t.Body.Configuration;e(n)})).catch((e=>{a.LU.genericServiceRejection("Settings_GetOwaLanguageAndTimeZone_Failed",6,e,t)}))}))}}class P extends o.V{initializeComponent(){this.userTheme=null==this.SuiteApi.Configuration.IUserThemeOverride?new I:this.SuiteApi.Configuration.IUserThemeOverride,this.languageAndTimeZone=null==this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride?new E:this.SuiteApi.Configuration.ILanguageAndTimeZoneOverride,this.userTheme.initialize(this.SuiteApi),this.languageAndTimeZone.initialize(this.SuiteApi)}loadUserThemeChoices(){return this.userTheme.loadUserThemeChoices()}setUserTheme(e,t){return this.userTheme.setUserTheme(e,t)}getLanguageAndTimeZone(){return this.languageAndTimeZone.getLanguageAndTimeZone()}getLanguageChoices(){return this.languageAndTimeZone.getLanguageChoices()}getTimeZoneChoices(){return this.languageAndTimeZone.getTimeZoneChoices()}getDateTimeFormats(e){return this.languageAndTimeZone.getDateTimeFormats(e)}setLanguageAndTimeZone(e){return this.languageAndTimeZone.setLanguageAndTimeZone(e)}}var U=n(60331);const F="/v1.0/me/photo/$value";class N extends o.V{initializeComponent(){}get OwaUserConfig(){return this.userConfig}getOwaUserConfiguration(){null==this.userConfigPromise&&(this.SuiteApi.Configuration.OpxEnabled&&this.SuiteApi.Configuration.ExchangeDataOpxEnabled&&!this.SuiteApi.Configuration.IsOwa?this.userConfigPromise=this.getOwaUserConfigurationViaOpx():this.userConfigPromise=this.getOwaUserConfigurationViaSuiteServiceProxy());const e=window.setTimeout((()=>(0,i.jl)().tag("User_GetOwaUserConfiguration_MessageTimeout",6)),15e3);return this.userConfigPromise.then((()=>window.clearTimeout(e))).catch((()=>window.clearTimeout(e))),this.userConfigPromise}getOwaUserConfigurationViaOpx(){return n.e("exchangedata").then(n.bind(n,5172)).then((e=>e.getOwaUserConfig())).catch((e=>{throw(0,i.jl)().exception("User_GetOwaUserConfigurationViaOpx_Failed",4,e),e}))}getOwaUserConfigurationViaSuiteServiceProxy(){return new Promise(((e,t)=>{let n={command:a.uJ.OwaUserConfig,timeout:1e4};const r=()=>{this.SuiteApi.Service.callOwaIframeAction("GetOwaUserConfiguration",{}).then((n=>{if(this.userConfig=n,null!=this.userConfig&&""!==this.userConfig)this.onOwaUserConfigSucceeded(e);else{const e=new a.Pp("null OwaUserConfiguration received from server");(0,i.jl)().exception("User_GetOwaUserConfiguration_NullConfig",4,e),t(e)}})).catch((e=>{a.LU.genericServiceRejection("User_GetOwaUserConfiguration_Failed",4,e,t)}))};if(this.SuiteApi.Configuration.IsOwa)r();else{n.success=t=>{this.userConfig=t.responseObject,"GetOwaUserConfiguration"===a.es.Instance.configuration.StartupActionName&&this.SuiteApi.Service.setStartupActionCompleted(),this.onOwaUserConfigSucceeded(e)},n.error=(e,t,n)=>{(0,i.jl)().exception("GetOwaUserConfiguration_ContextUnavailable",4,new a.Pp(n,t)),r()};let s=a.Ou.OwaInstance;null==s?t(new a.Pp("OwaIframe",-1011)):s.getOwaUserConfiguration(n)}}))}getPhotoFromGraph(e){let t=(0,S.xH)(e)?F:(0,S.Uw)("/v1.0/users/{0}/photo/$value",e),n={method:a.FH.GET,resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+t,binaryStringResponseBody:!0};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(n).then((t=>{e(window.btoa(t))})).catch((n=>{404===n.errorInfo.HttpStatus?e(""):a.LU.genericServiceRejection("User_GetPhotoFromGraph_Failed",4,n,t)}))}))}prefetchGraphToken(){return new Promise(((e,t)=>{null!=this.SuiteApi.Configuration.GraphOauthResourceUrl?this.SuiteApi.Service.prefetchAccessToken(this.SuiteApi.Configuration.GraphOauthResourceUrl+F,this.SuiteApi.Configuration.GraphOauthResourceUrl).then(e).catch(t):t()}))}uploadPhotoToGraph(e){let t=e.split(","),n=t[0].split(":")[1].split(";")[0],i=t[1],r={method:a.FH.PUT,headers:{"Content-Type":n},timeout:7e3,body:window.atob(i),resource:this.SuiteApi.Configuration.GraphOauthResourceUrl,url:this.SuiteApi.Configuration.GraphOauthResourceUrl+F,binaryStringRequestBody:!0};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(r).then(e).catch((e=>{a.LU.genericServiceRejection("User_UploadPhotoToGraph_Failed",6,e,t)}))}))}onOwaUserConfigSucceeded(e){null!=this.userConfig.SessionSettings?a.es.Instance.MailboxGuid=this.userConfig.SessionSettings.MailboxGuid:(0,i.jl)().tag("User_GetOwaUserConfiguration_SessionSettingsNull",4),e(this.userConfig)}getOCPSUserPolicies(e,t){let n=this.SuiteApi.Configuration.OcpsOauthResourceUrl,i=e?n+"?PoliciesHash="+e:n,r={body:"",method:a.FH.GET,headers:{Accept:"application/json","x-Cid":t},resource:i,url:this.SuiteApi.Configuration.OcpsOauthEndpointUrl};return new Promise(((e,t)=>{this.SuiteApi.Service.callEndpointWithOauthToken(r,!0).then((t=>{e(t)})).catch((e=>{a.LU.genericServiceRejection("getOCPSPolicies_Failed",6,e,t)}))}))}}class M{constructor(e){this.configuration=e,this.StartupActionName="GetOwaUserConfiguration",this.validateConfiguration(e),this.owaUrlSpecialHandling(e),a.es.Initialize(Object.assign(Object.assign({},e),{StartupActionName:this.StartupActionName})),this.service=a.t6.Instance,this.storage=null==e.IStorageOverride?new U.Ke:e.IStorageOverride,this.webShellStorage=null==e.IWebShellStorageOverride?new U.RQ:e.IWebShellStorageOverride,this.user=null==e.IUserOverride?new N:e.IUserOverride,this.settings=null==e.ISettingsOverride?new P:e.ISettingsOverride,this.documentsModule=null==e.IDocumentsOverride?new l:e.IDocumentsOverride,this.owaPoweredExperiences=null==e.IOwaPoweredExperiencesOverride?new g:e.IOwaPoweredExperiencesOverride,this.service=a.t6.Instance,e.UserHasExchangeLicense?e.SuiteServiceCallsDisabled?this.service.blockSuiteServiceCalls(a.vj.Brs):e.IsPwa&&this.service.blockSuiteServiceCalls(a.vj.Pwa):this.service.blockSuiteServiceCalls(a.vj.NoExoLicense),this.storage.initialize(this),this.webShellStorage.initialize(this),this.user.initialize(this),this.documentsModule.initialize(this),this.settings.initialize(this),e.OpxEnabled&&this.owaPoweredExperiences.initialize(this)}get Configuration(){return this.configuration}get Service(){return this.service}get User(){return this.user}get Storage(){return this.storage}get WebShellStorage(){return this.webShellStorage}get DocumentsModule(){return this.documentsModule}get OwaPoweredExperiences(){return this.owaPoweredExperiences}get Settings(){return this.settings}static CreateInstance(e){if(null!=this.instance){const e=new Error("Instance already exists.");throw(0,i.jl)().exception("SuiteApi_InstanceAlreadyExists",6,e),e}return this.instance=new M(e),this.instance}static isInitialized(){return null!=this.instance}static get Instance(){if(null==M.instance)throw new Error("Instance not yet created.");return M.instance}static clearInstanceForTesting(){a.es.isUnitTestMode&&(M.instance=null,a.Ou.resetAllInstancesForTesting())}validateConfiguration(e){r.throwOnNullOrUndefined(e,"configuration"),r.throwOnNullOrUndefined(e.SuiteServiceUrl,"SuiteApiConfiguration.SuiteServiceUrl")}owaUrlSpecialHandling(e){if(e.IsOwa){const t=e.SuiteServiceUrl.toLowerCase(),n=a.xX.getUrlDomainPart(t),i=a.xX.getUrlDomainPart(window.location.href).toLowerCase();n!==i&&(e.SuiteServiceUrl=t.replace(n,i))}}}},28949:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var a=n(9028),i=n(20851);class r{constructor(){this.isInitialized=!1}get SuiteApi(){return this.suiteApi}get IsInitialized(){return this.isInitialized}initialize(e){a.throwOnNullOrUndefined(e,"suiteApi"),this.IsInitialized||(this.suiteApi=e,this.initializeComponent(),this.isInitialized=!0)}checkInitialized(){if(!this.isInitialized)throw new i.Pp("SuiteApiComponent_InvalidInitializationCheck",-2002)}}},43474:function(e,t,n){"use strict";n.d(t,{A:function(){return a},D:function(){return i}});const a={Accept:"application/json","Content-Type":"application/json; charset=utf-8"},i={Accept:"application/json","Content-Type":"application/json; charset=utf-8"}},2823:function(e,t,n){"use strict";n.d(t,{p:function(){return r},y:function(){return i}});var a=n(20851);function i(e){return new a.Pp(`Argument Exception: ${e}`,-2001)}function r(e){return new a.Pp(`Invalid Operation: ${e}`,-2002)}},79502:function(e,t,n){"use strict";n.d(t,{nR:function(){return s.n}});var a=n(91011),i=n(56003),r=n(59633),s=n(41198);n(2823);function o(e,t){var n,a;let r=null!==(n=t.OpxDefaultHostUrl)&&void 0!==n?n:i.WA;const s=null!==(a=t.OpxAlternateHostUrls)&&void 0!==a?a:i.Gj;return null!=e.opxHostUrlOverride&&s.indexOf(e.opxHostUrlOverride)>=0&&(r=e.opxHostUrlOverride),r}(0,a.Lo)().subscribe("ShellDataUpdated",(function e(t,n){var l;if(n.SuiteServiceUrl&&(n.IsConsumerShell||n.TokenFactoryIframeOrigin)&&!s.n.isInitialized()){const c=(0,a.aH)(),u={SuiteServiceUrl:n.SuiteServiceUrl,AdminServiceUrl:n.PortalUrl,CurrentUserUpn:n.UPN,CurrentUserPuid:n.PUID,UserHasExchangeLicense:n.HasEXOLicense,SuiteServiceCallsDisabled:n.SuiteServiceCallsDisabled,TokenFactoryIframeOrigin:n.TokenFactoryIframeOrigin,IsOwa:(0,r.o5)(n.WorkloadId),ShellSID:n.SHSID,HintUserName:null!=n.EnableUsernameHinting&&n.EnableUsernameHinting,CultureName:t.CultureName,MruOauthEndpointUrl:n.MruOauthEndpointUrl,MruOauthResourceUrl:n.MruOauthResourceUrl,GraphOauthEndpointUrl:n.GraphOauthEndpointUrl,GraphOauthResourceUrl:n.GraphOauthResourceUrl,OcpsOauthEndpointUrl:n.OcpsOauthEndpointUrl,OcpsOauthResourceUrl:n.OcpsOauthResourceUrl,NotificationsEnabled:n.NotificationsEnabled&&n.HasEXOLicense,WorkloadId:n.WorkloadId,ClientShellVersion:window.O365ShellVerStr,IsPwa:(0,r.So)(n.WorkloadId,t.CurrentMainLinkElementID),IsOwsLanguageTimezoneCallEnabled:n.OwsLanguageTimezoneCallEnabled,GetTokenRequestDictionary:c.GetTokenRequestDictionary,ServiceWorkerCacheId:c.serviceWorkerCacheId,ServiceWorkerFetchStrategy:c.serviceWorkerFetchStrategy,ClearThemeCacheData:null!=n.ClearUserThemeCacheUrls&&n.ClearUserThemeCacheUrls.length>0?JSON.parse(n.ClearUserThemeCacheUrls):[],EnableTokenDictionary:n.EnableTokenDictionary,IsConsumer:n.IsConsumerShell,CSSExperiencesEnabled:n.CSSExperiencesEnabled,OpxEnabled:n.OpxEnabled&&!(0,r.So)(n.WorkloadId,t.CurrentMainLinkElementID),OpxHostUrl:o(c,n),OpxResourceUrl:null!==(l=n.OpxDefaultHostUrl)&&void 0!==l?l:i.WA,ExchangeDataOpxEnabled:n.ExchangeDataOpxEnabled};s.n.CreateInstance(u);const d=(0,a.Lo)();d.invoke("SuiteAPILoaded",s.n.Instance),d.unsubscribe("ShellDataUpdated",e)}}),!0)},81235:function(e,t,n){"use strict";var a;n.d(t,{x:function(){return a}}),function(e){e.MyDay="MyDay",e.ExchangeData="ExchangeData"}(a||(a={}))},35653:function(e,t,n){"use strict";var a,i;n.d(t,{g:function(){return i},r:function(){return a}}),function(e){e.SystemMetadata="SystemMetadata",e.CustomerContent="CustomerContent"}(a||(a={})),function(e){e.User="User",e.Tenant="Tenant"}(i||(i={}))},60331:function(e,t,n){"use strict";n.d(t,{Ke:function(){return S},rq:function(){return y.r},Qt:function(){return c},RQ:function(){return v},gD:function(){return y.g}});var a=n(20851),i=n(28949),r=n(2823);const s=a.xX.SuiteServiceApiRelativePath+"NotificationsSettings/User";class o{constructor(e){this.suiteApi=e}readNotificationSettings(){return new Promise(((e,t)=>{this.suiteApi.Service.callOwaIframeResourceUrl(s,null,a.FH.GET).then((t=>{e(t)})).catch((e=>{a.LU.genericServiceRejection("ReadNotificationSettings",6,e,t)}))}))}writeNotificationSettings(e){return new Promise(((t,n)=>{if(null==e)throw(0,r.y)("settingValue");this.suiteApi.Service.callOwaIframeResourceUrl(s,e,a.FH.PUT).then((()=>{t()})).catch((e=>{a.LU.genericServiceRejection("WriteNotificationSettings",6,e,n)}))}))}}var l=n(9028);class c{constructor(e,t,n){this.Scope=e,this.Namespace=t,this.Name=n,(0,l.throwOnNullOrEmpty)(e,"keyScope"),(0,l.throwOnNullOrEmpty)(t,"keyNamespace"),(0,l.throwOnNullOrEmpty)(n,"keyName")}toString(){return this.Scope+a.fO.DictionaryStringPartsSeparator+this.Namespace+a.fO.DictionaryStringPartsSeparator+this.Name}static fromDictionaryKey(e){(0,l.throwOnNullOrEmpty)(e,"keyString");const t=e.split(a.fO.DictionaryStringPartsSeparator);if(t.length<3)throw(0,r.p)("Malformed keyString: Expected format <Scope>//<Namespace>//<Name>");return new c(t[0],t[1],t[2])}}class u{constructor(e,t){this.Key=e,this.Value=t,(0,l.throwOnNull)(e,"key"),(0,l.throwOnNull)(t,"value")}}class d{constructor(e){this.Header=e}}class p extends d{constructor(e,t){super(e),this.Header=e,this.Body=t}}const h="Cannot remove a key needed for read or write.";class g{constructor(e=!1,t=[],n={},a=[]){this.clearAll=e,this.writes=n,this.reads={},this.removes={},t.forEach((e=>this.reads[e.toString()]=e)),a.forEach((e=>this.removes[e.toString()]=e))}getReadStorageKeys(){return Object.keys(this.reads).map((e=>this.reads[e]))}getWriteStorageKeyValues(){return Object.keys(this.writes).map((e=>this.writes[e]))}getRemoveStorageKeys(){return Object.keys(this.removes).map((e=>this.removes[e]))}requestRead(...e){(0,l.throwOnNullOrEmptyArray)(e,"keys");for(let t of e){if((0,l.throwOnNull)(t,"key"),this.isRemoveRequested(t))throw new a.Pp(h,-2002);this.reads[t.toString()]=t}}requestWrite(e,...t){(0,l.throwOnUndefined)(e,"value"),(0,l.throwOnNullOrEmptyArray)(t,"keys");for(let n of t){if((0,l.throwOnNull)(n,"key"),this.isRemoveRequested(n))throw new a.Pp(h,-2002);this.writes[n.toString()]=new u(n,e)}}requestRemove(...e){(0,l.throwOnNullOrEmptyArray)(e,"keys");for(let t of e){if((0,l.throwOnNull)(t,"key"),t.toString()in this.reads||t.toString()in this.writes)throw new a.Pp(h,-2002);this.removes[t.toString()]=t}}requestClearAll(){this.clearAll=!0}combine(...e){(0,l.throwOnNullOrEmptyArray)(e,"requests");let t=new g(this.clearAll);for(let n of e.concat(this)){n.getReadStorageKeys().length&&t.requestRead(...n.getReadStorageKeys());for(let e of Object.keys(n.writes))t.requestWrite(n.writes[e].Value,n.writes[e].Key);n.getRemoveStorageKeys().length&&t.requestRemove(...n.getRemoveStorageKeys())}return t}valueToBeWritten(e){(0,l.throwOnNullOrUndefined)(e,"key");const t=this.writes[e.toString()];if(null==t)throw new a.Pp("Cannot read key without value.",-2002);return t.Value}isRemoveRequested(e){return(0,l.throwOnNullOrUndefined)(e,"key"),e.toString()in this.removes}isClearAllRequested(){return this.clearAll}toStorageServerJsonRequest(){const e={ReadSettings:this.getReadStorageKeys().slice(),WriteSettings:this.getWriteStorageKeyValues().map((e=>new u(e.Key,JSON.stringify(e.Value))))};return new p({},e)}toStorageDataRequest(e){return{UserId:e,ClearAll:this.clearAll,Reads:this.getReadStorageKeys().map((e=>e.toString())),Writes:this.getWriteStorageKeyValues().map((e=>({Key:e.Key.toString(),Value:JSON.stringify(e.Value)}))),Deletes:this.getRemoveStorageKeys().map((e=>e.toString())),RequestType:0}}}class m{constructor(e={}){this.values=e}static fromStorageSessionResponseData(e){l.throwOnNullOrUndefined(e,"data");let t=new m({});for(let n of Object.keys(e.Reads)){const a=new u(c.fromDictionaryKey(n),JSON.parse(e.Reads[n]));t.values[a.Key.toString()]=a.Value}return t}static fromStorageServerResponseData(e){l.throwOnNullOrUndefined(e,"data");let t=new m({});for(let n of e.Settings){const e=new u(n.Key,JSON.parse(n.Value));t.values[e.Key.toString()]=e.Value}return t}hasKey(e){return l.throwOnNullOrUndefined(e,"key"),e.toString()in this.values}value(e){if(l.throwOnNullOrUndefined(e,"key"),!(e.toString()in this.values))throw new a.Pp("Key value missing.",-2002);return this.values[e.toString()]}getStorageKeyValues(){return Object.keys(this.values).map((e=>this.values[e]))}}var f=n(91011);class S extends i.V{initializeComponent(){this.NotificationsStorage=new o(this.SuiteApi)}createStorageRequest(){return this.checkInitialized(),new g}submitStorageRequestToOwaSessionStorage(e,t){return this.checkInitialized(),new Promise(((n,i)=>{if(null==e)return i(r.y("request"));this.SuiteApi.Service.owaSessionStorageRequest(e.toStorageDataRequest(this.SuiteApi.Configuration.CurrentUserUpn)).then((e=>{this.checkStorageResponseErrors(e,i)||n(m.fromStorageSessionResponseData(e))})).catch((e=>{a.LU.isCallsBlockedException(e)||(0,f.jl)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,e.errorCode),i(e)})),null!=t&&window.setTimeout((()=>{const e=new Error("Session Storage Request Timeout");(0,f.jl)().exception("SubmitStorageRequestToSessionStorage_Failed",4,e,-1001),i(e)}),t)}))}isServerStorageEnabled(e){return a.es.Instance.configuration.UserHasExchangeLicense||e}readNotificationSettings(){return this.checkInitialized(),this.NotificationsStorage.readNotificationSettings()}writeNotificationSettings(e){return this.checkInitialized(),this.NotificationsStorage.writeNotificationSettings(e)}checkStorageResponseErrors(e,t){let n=e;return n.ClearError,n.WriteError,n.ReadError,null!=n.ResetError&&(t(n.ResetError),!0)}}var y=n(35653),C=n(93643),b=n(37005),I=n(43474);class T{constructor(e=new g){this.storageRequest=e}requestRead(...e){this.storageRequest.requestRead(...e)}requestWrite(e,...t){this.storageRequest.requestWrite(e,...t)}toStorageDataRequest(e){return this.storageRequest.toStorageDataRequest(e)}requestClearAll(){this.storageRequest.requestClearAll()}}class D{constructor(e=void 0){this.value=e}fromStorageSessionResponseData(e){this.storageResponse=m.fromStorageSessionResponseData(e)}hasValue(e){return C.vo.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.hasKey(e)&&null!=this.storageResponse.value(e)}getValue(e){return C.vo.throwOnNullOrUndefined(this.storageResponse,"storageResponse"),this.storageResponse.value(e)}}class v extends i.V{initializeComponent(){}createWebShellStorageRequest(){return this.checkInitialized(),new T}readStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryRequest(t,e,n,a.FH.GET);return this.useStorage(i)}batchReadStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryBatchRequest(t,e,n,a.FH.GET);return this.useStorage(i)}writeStorage(e,t,n,i){this.checkInitialized();const r=this.createTokenFactoryRequest(t,e,n,a.FH.PUT);return r.body=JSON.stringify(i),this.useStorage(r)}removeStorage(e,t,n){this.checkInitialized();const i=this.createTokenFactoryRequest(t,e,n,a.FH.DELETE);return this.useStorage(i)}readSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}writeSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}removeSessionStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}readLocalStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}writeLocalStorage(e){return this.checkInitialized(),this.useBrowserStorage(e)}removeLocalStorage(e){return Promise.reject(new Error("not implemented"))}createTokenFactoryRequest(e,t,n,a){C.vo.throwOnNullOrEmpty(n,"keyName");const i=(0,C.Uw)("{0}/api/storage/{1}/{2}/{3}?api-version={4}&shellType=OneShell",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,t,encodeURIComponent(n),v.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)}createTokenFactoryBatchRequest(e,t,n,a){C.vo.throwOnNullOrEmptyArray(n,"keyNames");const i=(0,C.Uw)("{0}/api/storage/{1}/{2}/{3}?api-version={4}",this.SuiteApi.Configuration.TokenFactoryIframeOrigin,e,t,encodeURIComponent(n.join(",")),v.ApiVersion);return this.createTokenFactoryRequestHelper(i,a)}createTokenFactoryRequestHelper(e,t){return{url:e,resource:this.SuiteApi.Configuration.TokenFactoryIframeOrigin,method:t,headers:I.A}}useStorage(e){return new Promise(((t,n)=>{this.SuiteApi.Service.callEndpointWithOauthToken(e).then((e=>{t(new D(e))})).catch(n)}))}useBrowserStorage(e){return new Promise(((t,n)=>{C.vo.throwOnNull(e,"StorageRequest");let i=!1,s=e.toStorageDataRequest(this.SuiteApi.Configuration.CurrentUserUpn),o={url:a.es.Instance.configuration.TokenFactoryIframeOrigin,requestObject:s,timeout:3e4,success:e=>{i=!0;let a=e.responseObject;if(!this.checkStorageResponseErrors(a,n)){let e=new D;e.fromStorageSessionResponseData(a),t(e)}},error:(e,t,a)=>{i=!0;let s=b.Eu(a);(0,f.jl)().tag("StorageApi_RequestError",6,t,s),n((0,r.p)(s))}},l=null;this.SuiteApi.Service.AreSuiteServiceCallsBlocked||(l=a.Ou.OauthTokenFactoryInstance),null!=l?(setTimeout((()=>{if(!i){i=!0;const e=new Error("StorageTimeout");(0,f.jl)().exception("StorageApi_TimeoutError",6,e),n(e)}}),o.timeout),l.executeStorageRequest(o)):n(new a.Pp("OauthTokenFactoryIframe",-1011))}))}checkStorageResponseErrors(e,t){let n=e;if(!n){let e=new Error("Empty response received.");(0,f.jl)().exception("StorageApi_NoResponse",6,e),t(e)}if(null!=n.ClearError)t(n.ClearError);else if(null!=n.WriteError)t(n.WriteError);else if(null!=n.ReadError)t(n.ReadError);else{if(null==n.ResetError)return!1;t(n.ResetError)}return!0}}v.ApiVersion="1"},96520:function(e){"use strict";e.exports=JSON.parse('[{"Locale":"af-NA","DisplayName":"Afrikaans (Namibië)‎"},{"Locale":"af-ZA","DisplayName":"Afrikaans (Suid-Afrika)‎"},{"Locale":"am-ET","DisplayName":"አማርኛ (ኢትዮጵያ)‎"},{"Locale":"ar-AE","DisplayName":"العربية (الإمارات العربية المتحدة)‏"},{"Locale":"ar-BH","DisplayName":"العربية (البحرين)‏"},{"Locale":"ar-DJ","DisplayName":"العربية (جيبوتي)‏"},{"Locale":"ar-DZ","DisplayName":"العربية (الجزائر)‏"},{"Locale":"ar-EG","DisplayName":"العربية (مصر)‏"},{"Locale":"ar-ER","DisplayName":"العربية (إريتريا)‏"},{"Locale":"ar-IL","DisplayName":"العربية (إسرائيل)‏"},{"Locale":"ar-IQ","DisplayName":"العربية (العراق)‏"},{"Locale":"ar-JO","DisplayName":"العربية (الأردن)‏"},{"Locale":"ar-KM","DisplayName":"العربية (جزر القمر)‏"},{"Locale":"ar-KW","DisplayName":"العربية (الكويت)‏"},{"Locale":"ar-LB","DisplayName":"العربية (لبنان)‏"},{"Locale":"ar-LY","DisplayName":"العربية (ليبيا)‏"},{"Locale":"ar-MA","DisplayName":"العربية (المملكة المغربية)‏"},{"Locale":"ar-MR","DisplayName":"العربية (موريتانيا)‏"},{"Locale":"ar-OM","DisplayName":"العربية (عمان)‏"},{"Locale":"ar-PS","DisplayName":"العربية (السلطة الفلسطينية)‏"},{"Locale":"ar-QA","DisplayName":"العربية (قطر)‏"},{"Locale":"ar-SA","DisplayName":"العربية (المملكة العربية السعودية)‏"},{"Locale":"ar-SO","DisplayName":"العربية (الصومال)‏"},{"Locale":"ar-SS","DisplayName":"العربية (جنوب السودان)‏"},{"Locale":"ar-TD","DisplayName":"العربية (تشاد)‏"},{"Locale":"ar-TN","DisplayName":"العربية (تونس)‏"},{"Locale":"as-IN","DisplayName":"অসমীয়া (ভাৰত)‎"},{"Locale":"az-Latn-AZ","DisplayName":"azərbaycan (Azərbaycan)‎"},{"Locale":"be-BY","DisplayName":"Беларуская (Беларусь)‎"},{"Locale":"bg-BG","DisplayName":"български (България)‎"},{"Locale":"bn-BD","DisplayName":"বাংলা (বাংলাদেশ)‎"},{"Locale":"bn-IN","DisplayName":"বাংলা (ভারত)‎"},{"Locale":"bs-Latn-BA","DisplayName":"bosanski (Bosna i Hercegovina)‎"},{"Locale":"ca-AD","DisplayName":"català (Andorra)‎"},{"Locale":"ca-ES","DisplayName":"català (català)‎"},{"Locale":"ca-FR","DisplayName":"català (França)‎"},{"Locale":"ca-IT","DisplayName":"català (Itàlia)‎"},{"Locale":"cs-CZ","DisplayName":"čeština (Česko)‎"},{"Locale":"cy-GB","DisplayName":"Cymraeg (Y Deyrnas Unedig)‎"},{"Locale":"da-DK","DisplayName":"dansk (Danmark)‎"},{"Locale":"da-GL","DisplayName":"dansk (Grønland)‎"},{"Locale":"de-AT","DisplayName":"Deutsch (Österreich)‎"},{"Locale":"de-BE","DisplayName":"Deutsch (Belgien)‎"},{"Locale":"de-CH","DisplayName":"Deutsch (Schweiz)‎"},{"Locale":"de-DE","DisplayName":"Deutsch (Deutschland)‎"},{"Locale":"de-IT","DisplayName":"Deutsch (Italien)‎"},{"Locale":"de-LI","DisplayName":"Deutsch (Liechtenstein)‎"},{"Locale":"de-LU","DisplayName":"Deutsch (Luxemburg)‎"},{"Locale":"el-CY","DisplayName":"Ελληνικά (Κύπρος)‎"},{"Locale":"el-GR","DisplayName":"Ελληνικά (Ελλάδα)‎"},{"Locale":"en-GB","DisplayName":"English (United Kingdom)‎"},{"Locale":"es-AR","DisplayName":"español (Argentina)‎"},{"Locale":"es-BO","DisplayName":"español (Bolivia)‎"},{"Locale":"es-BR","DisplayName":"español (Brasil)‎"},{"Locale":"es-BZ","DisplayName":"español (Belice)‎"},{"Locale":"es-CL","DisplayName":"español (Chile)‎"},{"Locale":"es-CO","DisplayName":"español (Colombia)‎"},{"Locale":"es-CR","DisplayName":"español (Costa Rica)‎"},{"Locale":"es-CU","DisplayName":"español (Cuba)‎"},{"Locale":"es-DO","DisplayName":"español (República Dominicana)‎"},{"Locale":"es-EC","DisplayName":"español (Ecuador)‎"},{"Locale":"es-ES","DisplayName":"español (España, alfabetización internacional)‎"},{"Locale":"es-GQ","DisplayName":"español (Guinea Ecuatorial)‎"},{"Locale":"es-GT","DisplayName":"español (Guatemala)‎"},{"Locale":"es-HN","DisplayName":"español (Honduras)‎"},{"Locale":"es-MX","DisplayName":"español (México)‎"},{"Locale":"es-NI","DisplayName":"español (Nicaragua)‎"},{"Locale":"es-PA","DisplayName":"español (Panamá)‎"},{"Locale":"es-PE","DisplayName":"español (Perú)‎"},{"Locale":"es-PH","DisplayName":"español (Filipinas)‎"},{"Locale":"es-PR","DisplayName":"español (Puerto Rico)‎"},{"Locale":"es-PY","DisplayName":"español (Paraguay)‎"},{"Locale":"es-SV","DisplayName":"español (El Salvador)‎"},{"Locale":"es-US","DisplayName":"español (Estados Unidos)‎"},{"Locale":"es-UY","DisplayName":"español (Uruguay)‎"},{"Locale":"es-VE","DisplayName":"español (Venezuela)‎"},{"Locale":"et-EE","DisplayName":"eesti (Eesti)‎"},{"Locale":"eu-ES","DisplayName":"euskara (euskara)‎"},{"Locale":"fa-IR","DisplayName":"فارسی (ایران)‏"},{"Locale":"fi-FI","DisplayName":"suomi (Suomi)‎"},{"Locale":"fil-PH","DisplayName":"Filipino (Pilipinas)‎"},{"Locale":"fr-BE","DisplayName":"français (Belgique)‎"},{"Locale":"fr-BF","DisplayName":"français (Burkina Faso)‎"},{"Locale":"fr-BI","DisplayName":"français (Burundi)‎"},{"Locale":"fr-BJ","DisplayName":"français (Bénin)‎"},{"Locale":"fr-BL","DisplayName":"français (Saint-Barthélemy)‎"},{"Locale":"fr-CA","DisplayName":"français (Canada)‎"},{"Locale":"fr-CF","DisplayName":"français (République centrafricaine)‎"},{"Locale":"fr-CG","DisplayName":"français (Congo)‎"},{"Locale":"fr-CH","DisplayName":"français (Suisse)‎"},{"Locale":"fr-CI","DisplayName":"français (Côte d’Ivoire)‎"},{"Locale":"fr-CM","DisplayName":"français (Cameroun)‎"},{"Locale":"fr-DJ","DisplayName":"français (Djibouti)‎"},{"Locale":"fr-DZ","DisplayName":"français (Algérie)‎"},{"Locale":"fr-FR","DisplayName":"français (France)‎"},{"Locale":"fr-GA","DisplayName":"français (Gabon)‎"},{"Locale":"fr-GF","DisplayName":"français (Guyane française)‎"},{"Locale":"fr-GN","DisplayName":"français (Guinée)‎"},{"Locale":"fr-GP","DisplayName":"français (Guadeloupe)‎"},{"Locale":"fr-GQ","DisplayName":"français (Guinée équatoriale)‎"},{"Locale":"fr-HT","DisplayName":"français (Haïti)‎"},{"Locale":"fr-KM","DisplayName":"français (Comores)‎"},{"Locale":"fr-LU","DisplayName":"français (Luxembourg)‎"},{"Locale":"fr-MA","DisplayName":"français (Maroc)‎"},{"Locale":"fr-MC","DisplayName":"français (Monaco)‎"},{"Locale":"fr-MF","DisplayName":"français (Saint-Martin)‎"},{"Locale":"fr-MG","DisplayName":"français (Madagascar)‎"},{"Locale":"fr-ML","DisplayName":"français (Mali)‎"},{"Locale":"fr-MQ","DisplayName":"français (Martinique)‎"},{"Locale":"fr-MR","DisplayName":"français (Mauritanie)‎"},{"Locale":"fr-MU","DisplayName":"français (Maurice)‎"},{"Locale":"fr-NC","DisplayName":"français (Nouvelle-Calédonie)‎"},{"Locale":"fr-NE","DisplayName":"français (Niger)‎"},{"Locale":"fr-PF","DisplayName":"français (Polynésie française)‎"},{"Locale":"fr-PM","DisplayName":"français (Saint-Pierre-et-Miquelon)‎"},{"Locale":"fr-RE","DisplayName":"français (La Réunion)‎"},{"Locale":"fr-RW","DisplayName":"français (Rwanda)‎"},{"Locale":"fr-SC","DisplayName":"français (Seychelles)‎"},{"Locale":"fr-SN","DisplayName":"français (Sénégal)‎"},{"Locale":"fr-TD","DisplayName":"français (Tchad)‎"},{"Locale":"fr-TG","DisplayName":"français (Togo)‎"},{"Locale":"fr-TN","DisplayName":"français (Tunisie)‎"},{"Locale":"fr-VU","DisplayName":"français (Vanuatu)‎"},{"Locale":"fr-WF","DisplayName":"français (Wallis-et-Futuna)‎"},{"Locale":"fr-YT","DisplayName":"français (Mayotte)‎"},{"Locale":"ga-IE","DisplayName":"Gaeilge (Éire)‎"},{"Locale":"gd-GB","DisplayName":"Gàidhlig (An Rìoghachd Aonaichte)‎"},{"Locale":"gl-ES","DisplayName":"galego (galego)‎"},{"Locale":"gu-IN","DisplayName":"ગુજરાતી (ભારત)‎"},{"Locale":"ha-Latn-NG","DisplayName":"Hausa (Najeriya)‎"},{"Locale":"he-IL","DisplayName":"עברית (ישראל)‏"},{"Locale":"hi-IN","DisplayName":"हिन्दी (भारत)‎"},{"Locale":"hr-BA","DisplayName":"hrvatski (Bosna i Hercegovina)‎"},{"Locale":"hr-HR","DisplayName":"hrvatski (Hrvatska)‎"},{"Locale":"hu-HU","DisplayName":"magyar (Magyarország)‎"},{"Locale":"hy-AM","DisplayName":"Հայերեն (Հայաստան)‎"},{"Locale":"id-ID","DisplayName":"Indonesia (Indonesia)‎"},{"Locale":"is-IS","DisplayName":"íslenska (Ísland)‎"},{"Locale":"it-CH","DisplayName":"italiano (Svizzera)‎"},{"Locale":"it-IT","DisplayName":"italiano (Italia)‎"},{"Locale":"it-SM","DisplayName":"italiano (San Marino)‎"},{"Locale":"it-VA","DisplayName":"italiano (Città del Vaticano)‎"},{"Locale":"ja-JP","DisplayName":"日本語 (日本)‎"},{"Locale":"ka-GE","DisplayName":"ქართული (საქართველო)‎"},{"Locale":"kk-KZ","DisplayName":"қазақ тілі (Қазақстан)‎"},{"Locale":"km-KH","DisplayName":"ភាសាខ្មែរ (កម្ពុជា)‎"},{"Locale":"kn-IN","DisplayName":"ಕನ್ನಡ (ಭಾರತ)‎"},{"Locale":"ko-KR","DisplayName":"한국어(대한민국)‎"},{"Locale":"kok-IN","DisplayName":"कोंकणी (भारत)‎"},{"Locale":"ky-KG","DisplayName":"Кыргыз (Кыргызстан)‎"},{"Locale":"lb-LU","DisplayName":"Lëtzebuergesch (Lëtzebuerg)‎"},{"Locale":"lo-LA","DisplayName":"ລາວ (ລາວ)‎"},{"Locale":"lt-LT","DisplayName":"lietuvių (Lietuva)‎"},{"Locale":"lv-LV","DisplayName":"latviešu (Latvija)‎"},{"Locale":"mi-NZ","DisplayName":"te reo Māori (Aotearoa)‎"},{"Locale":"mk-MK","DisplayName":"македонски (Северна Македонија)‎"},{"Locale":"ml-IN","DisplayName":"മലയാളം (ഇന്ത്യ)‎"},{"Locale":"mn-MN","DisplayName":"монгол (Монгол)‎"},{"Locale":"mr-IN","DisplayName":"मराठी (भारत)‎"},{"Locale":"ms-BN","DisplayName":"Melayu (Brunei)‎"},{"Locale":"ms-MY","DisplayName":"Melayu (Malaysia)‎"},{"Locale":"ms-SG","DisplayName":"Melayu (Singapura)‎"},{"Locale":"mt-MT","DisplayName":"Malti (Malta)‎"},{"Locale":"nb-NO","DisplayName":"norsk bokmål (Norge)‎"},{"Locale":"nb-SJ","DisplayName":"norsk bokmål (Svalbard og Jan Mayen)‎"},{"Locale":"ne-NP","DisplayName":"नेपाली (नेपाल)‎"},{"Locale":"nl-AW","DisplayName":"Nederlands (Aruba)‎"},{"Locale":"nl-BE","DisplayName":"Nederlands (België)‎"},{"Locale":"nl-BQ","DisplayName":"Nederlands (Bonaire, Sint Eustatius en Saba)‎"},{"Locale":"nl-CW","DisplayName":"Nederlands (Curaçao)‎"},{"Locale":"nl-NL","DisplayName":"Nederlands (Nederland)‎"},{"Locale":"nl-SR","DisplayName":"Nederlands (Suriname)‎"},{"Locale":"nl-SX","DisplayName":"Nederlands (Sint-Maarten)‎"},{"Locale":"or-IN","DisplayName":"ଓଡ଼ିଆ (ଭାରତ)‎"},{"Locale":"pa-IN","DisplayName":"ਪੰਜਾਬੀ (ਭਾਰਤ)‎"},{"Locale":"pl-PL","DisplayName":"polski (Polska)‎"},{"Locale":"prs-AF","DisplayName":"درى (افغانستان)‏"},{"Locale":"pt-AO","DisplayName":"português (Angola)‎"},{"Locale":"pt-BR","DisplayName":"português (Brasil)‎"},{"Locale":"pt-CH","DisplayName":"português (Suíça)‎"},{"Locale":"pt-CV","DisplayName":"português (Cabo Verde)‎"},{"Locale":"pt-GQ","DisplayName":"português (Guiné Equatorial)‎"},{"Locale":"pt-GW","DisplayName":"português (Guiné-Bissau)‎"},{"Locale":"pt-LU","DisplayName":"português (Luxemburgo)‎"},{"Locale":"pt-MO","DisplayName":"português (RAE de Macau)‎"},{"Locale":"pt-MZ","DisplayName":"português (Moçambique)‎"},{"Locale":"pt-PT","DisplayName":"português (Portugal)‎"},{"Locale":"pt-ST","DisplayName":"português (São Tomé e Príncipe)‎"},{"Locale":"pt-TL","DisplayName":"português (Timor-Leste)‎"},{"Locale":"quz-PE","DisplayName":"Runasimi (Perú)‎"},{"Locale":"ro-MD","DisplayName":"română (Republica Moldova)‎"},{"Locale":"ro-RO","DisplayName":"română (România)‎"},{"Locale":"ru-BY","DisplayName":"русский (Беларусь)‎"},{"Locale":"ru-KG","DisplayName":"русский (Киргизия)‎"},{"Locale":"ru-KZ","DisplayName":"русский (Казахстан)‎"},{"Locale":"ru-MD","DisplayName":"русский (Молдова)‎"},{"Locale":"ru-RU","DisplayName":"русский (Россия)‎"},{"Locale":"ru-UA","DisplayName":"русский (Украина)‎"},{"Locale":"sd-Arab-PK","DisplayName":"سنڌي (پاکستان)‏"},{"Locale":"si-LK","DisplayName":"සිංහල (ශ්‍රී ලංකාව)‎"},{"Locale":"sk-SK","DisplayName":"slovenčina (Slovensko)‎"},{"Locale":"sl-SI","DisplayName":"slovenščina (Slovenija)‎"},{"Locale":"sq-AL","DisplayName":"shqip (Shqipëri)‎"},{"Locale":"sq-MK","DisplayName":"shqip (Maqedonia e Veriut)‎"},{"Locale":"sq-XK","DisplayName":"shqip (Kosovë)‎"},{"Locale":"sr-Cyrl-BA","DisplayName":"српски (Босна и Херцеговина)‎"},{"Locale":"sr-Cyrl-ME","DisplayName":"српски (Црна Гора)‎"},{"Locale":"sr-Cyrl-RS","DisplayName":"српски (Србија)‎"},{"Locale":"sr-Cyrl-XK","DisplayName":"српски (Косово)‎"},{"Locale":"sr-Latn-BA","DisplayName":"srpski (Bosna i Hercegovina)‎"},{"Locale":"sr-Latn-ME","DisplayName":"srpski (Crna Gora)‎"},{"Locale":"sr-Latn-RS","DisplayName":"srpski (Srbija)‎"},{"Locale":"sr-Latn-XK","DisplayName":"srpski (Kosovo)‎"},{"Locale":"sv-AX","DisplayName":"svenska (Åland)‎"},{"Locale":"sv-FI","DisplayName":"svenska (Finland)‎"},{"Locale":"sv-SE","DisplayName":"svenska (Sverige)‎"},{"Locale":"sw-KE","DisplayName":"Kiswahili (Kenya)‎"},{"Locale":"sw-TZ","DisplayName":"Kiswahili (Tanzania)‎"},{"Locale":"sw-UG","DisplayName":"Kiswahili (Uganda)‎"},{"Locale":"ta-IN","DisplayName":"தமிழ் (இந்தியா)‎"},{"Locale":"ta-LK","DisplayName":"தமிழ் (இலங்கை)‎"},{"Locale":"ta-MY","DisplayName":"தமிழ் (மலேசியா)‎"},{"Locale":"ta-SG","DisplayName":"தமிழ் (சிங்கப்பூர்)‎"},{"Locale":"te-IN","DisplayName":"తెలుగు (భారత దేశం)‎"},{"Locale":"th-TH","DisplayName":"ไทย (ไทย)‎"},{"Locale":"tk-TM","DisplayName":"Türkmen dili (Türkmenistan)‎"},{"Locale":"tr-CY","DisplayName":"Türkçe (Kıbrıs)‎"},{"Locale":"tr-TR","DisplayName":"Türkçe (Türkiye)‎"},{"Locale":"tt-RU","DisplayName":"Татар (Россия)‎"},{"Locale":"ug-CN","DisplayName":"ئۇيغۇرچە (جۇڭخۇا خەلق جۇمھۇرىيىتى)‏"},{"Locale":"uk-UA","DisplayName":"українська (Україна)‎"},{"Locale":"ur-IN","DisplayName":"اردو (بھارت)‏"},{"Locale":"ur-PK","DisplayName":"اُردو (پاکستان)‏"},{"Locale":"uz-Arab-AF","DisplayName":"اوزبیک (افغانستان)‎"},{"Locale":"uz-Cyrl-UZ","DisplayName":"ўзбекча (Ўзбекистон)‎"},{"Locale":"uz-Latn-UZ","DisplayName":"o‘zbek (Oʻzbekiston)‎"},{"Locale":"vi-VN","DisplayName":"Tiếng Việt (Việt Nam)‎"},{"Locale":"zh-CN","DisplayName":"中文(中国)‎"},{"Locale":"zh-Hans-HK","DisplayName":"中文 (香港特别行政区)‎"},{"Locale":"zh-Hans-MO","DisplayName":"中文 (澳门特别行政区)‎"},{"Locale":"zh-HK","DisplayName":"中文(香港特別行政區)‎"},{"Locale":"zh-MO","DisplayName":"中文(澳門特別行政區)‎"},{"Locale":"zh-SG","DisplayName":"中文(新加坡)‎"},{"Locale":"zh-TW","DisplayName":"中文(台灣)‎"}]')}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_plus_end"),shellPerformance.measure("shell_plus","shell_plus_start","shell_plus_end"));